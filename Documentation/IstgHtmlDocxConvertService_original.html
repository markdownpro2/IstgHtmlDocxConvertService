<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/569ce4b8f30dc480-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/93f479601ee12b01-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/f30152c0704fba31.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/3bb537d759a88006.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-acbbbb548492d4a6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW"/><script src="/_next/static/chunks/4bd1b696-cebf68b71ed1e85d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/1684-7441f6182747d56c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/main-app-8ab5af3d6b81086e.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/9853-ba5965ca136d44c2.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/app/layout-d0b9af9c0a55f7f8.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/c16f53c3-c80d3b6d0c4af7a0.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/168-d8e567d7acd9a9f8.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/2633-f99bb2e714e9ea02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/8335-ffeda651fe4c8445.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/app/%5Borg%5D/%5Brepo%5D/%5B%5B...wikiRoutes%5D%5D/page-9ab64d064ff2dc46.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/7bf36345-20a79815585d2583.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/7646-a48026d39d9219b5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/3449-b65893d981d76d04.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/6405-fac8cb0868b7ff00.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/5805-44d30e670d12436d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script src="/_next/static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-fb0c43d422447c44.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><meta name="next-size-adjust" content=""/><title>markdownpro2/IstgHtmlDocxConvertService | DeepWiki</title><meta name="description" content="IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th"/><meta property="og:title" content="markdownpro2/IstgHtmlDocxConvertService | DeepWiki"/><meta property="og:description" content="IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th"/><meta property="og:url" content="https://deepwiki.com/markdownpro2/IstgHtmlDocxConvertService"/><meta property="og:site_name" content="DeepWiki"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="markdownpro2/IstgHtmlDocxConvertService | DeepWiki"/><meta name="twitter:description" content="IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><link rel="icon" href="/icon.png?66aaf51e0e68c818" type="image/png" sizes="16x16"/><link rel="apple-touch-icon" href="/apple-icon.png?a4f658907db0ab87" type="image/png" sizes="180x180"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" noModule=""></script></head><body class="__variable_5cfdac font-geist-sans relative min-h-screen __variable_9a8899 bg-background antialiased"><section aria-label="Notifications alt+T" tabindex="-1" aria-live="polite" aria-relevant="additions text" aria-atomic="false"></section><script>((e,t,r,n,a,o,i,s)=>{let u=document.documentElement,l=["light","dark"];function c(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&o?a.map(e=>o[e]||e):a;r?(u.classList.remove(...n),u.classList.add(o&&o[t]?o[t]:t)):u.setAttribute(e,t)}),r=t,s&&l.includes(r)&&(u.style.colorScheme=r)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=i&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","light",null,["light","dark"],null,true,true)</script><div class="flex min-h-screen w-full flex-col text-white" id="codebase-wiki-repo-page"><div class="bg-main border-b-border sticky top-0 z-30 border-b border-dashed"><div class="font-geist-mono relative flex h-8 items-center justify-center text-xs font-medium text-white sm:hidden"><div class="powered-by-devin-gradient absolute inset-0 z-[-1] h-8 w-full"></div><a target="_blank" rel="noopener noreferrer" class="flex items-center gap-2" href="https://devin.ai"><svg class="size-3 [&amp;_path]:stroke-0 [&amp;_path]:animate-[custom-pulse_1.8s_infinite_var(--delay,0s)]" xmlns="http://www.w3.org/2000/svg" viewBox="110 110 460 500"><path style="fill:#21c19a" class="[--delay:0.6s]" d="M418.73,332.37c9.84-5.68,22.07-5.68,31.91,0l25.49,14.71c.82.48,1.69.8,2.58,1.06.19.06.37.11.55.16.87.21,1.76.34,2.65.35.04,0,.08.02.13.02.1,0,.19-.03.29-.04.83-.02,1.64-.13,2.45-.32.14-.03.28-.05.42-.09.87-.24,1.7-.59,2.5-1.03.08-.04.17-.06.25-.1l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-.08.04-.13.11-.2.16-.78.48-1.51,1.02-2.15,1.66-.1.1-.18.21-.28.31-.57.6-1.08,1.26-1.51,1.97-.07.12-.15.22-.22.34-.44.77-.77,1.6-1.03,2.47-.05.19-.1.37-.14.56-.22.89-.37,1.81-.37,2.76v29.43c0,11.36-6.11,21.95-15.95,27.63-9.84,5.68-22.06,5.68-31.91,0l-25.49-14.71c-.82-.48-1.69-.8-2.57-1.06-.19-.06-.37-.11-.56-.16-.88-.21-1.76-.34-2.65-.34-.13,0-.26.02-.4.02-.84.02-1.66.13-2.47.32-.13.03-.27.05-.4.09-.87.24-1.71.6-2.51,1.04-.08.04-.16.06-.24.1l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22l50.97,29.43c.08.04.17.06.24.1.8.44,1.64.79,2.5,1.03.14.04.28.06.42.09.81.19,1.62.3,2.45.32.1,0,.19.04.29.04.04,0,.08-.02.13-.02.89,0,1.77-.13,2.65-.35.19-.04.37-.1.56-.16.88-.26,1.75-.59,2.58-1.06l25.49-14.71c9.84-5.68,22.06-5.68,31.91,0,9.84,5.68,15.95,16.27,15.95,27.63v29.43c0,.95.15,1.87.37,2.76.05.19.09.37.14.56.25.86.59,1.69,1.03,2.47.07.12.15.22.22.34.43.71.94,1.37,1.51,1.97.1.1.18.21.28.31.65.63,1.37,1.18,2.15,1.66.07.04.13.11.2.16l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-.08-.04-.16-.06-.24-.1-.8-.44-1.64-.8-2.51-1.04-.13-.04-.26-.05-.39-.09-.82-.2-1.65-.31-2.49-.33-.13,0-.25-.02-.38-.02-.89,0-1.78.13-2.66.35-.18.04-.36.1-.54.15-.88.26-1.75.59-2.58,1.07l-25.49,14.72c-9.84,5.68-22.07,5.68-31.9,0-9.84-5.68-15.95-16.27-15.95-27.63s6.11-21.95,15.95-27.63Z"></path><path style="fill:#3969ca" d="M141.09,317.65l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c.08-.04.13-.11.2-.16.78-.48,1.51-1.02,2.15-1.66.1-.1.18-.21.28-.31.57-.6,1.08-1.26,1.51-1.97.07-.12.15-.22.22-.34.44-.77.77-1.6,1.03-2.47.05-.19.1-.37.14-.56.22-.89.37-1.81.37-2.76v-29.43c0-11.36,6.11-21.95,15.96-27.63s22.06-5.68,31.91,0l25.49,14.71c.82.48,1.69.8,2.57,1.06.19.06.37.11.56.16.87.21,1.76.34,2.64.35.04,0,.09.02.13.02.1,0,.19-.04.29-.04.83-.02,1.65-.13,2.45-.32.14-.03.28-.05.41-.09.87-.24,1.71-.6,2.51-1.04.08-.04.16-.06.24-.1l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-.08.04-.13.11-.2.16-.78.48-1.51,1.02-2.15,1.66-.1.1-.18.21-.28.31-.57.6-1.08,1.26-1.51,1.97-.07.12-.15.22-.22.34-.44.77-.77,1.6-1.03,2.47-.05.19-.1.37-.14.56-.22.89-.37,1.81-.37,2.76v29.43c0,11.36-6.11,21.95-15.95,27.63-9.84,5.68-22.07,5.68-31.91,0l-25.49-14.71c-.82-.48-1.69-.8-2.58-1.06-.19-.06-.37-.11-.55-.16-.88-.21-1.76-.34-2.65-.35-.13,0-.26.02-.4.02-.83.02-1.66.13-2.47.32-.13.03-.27.05-.4.09-.87.24-1.71.6-2.51,1.04-.08.04-.16.06-.24.1l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22Z"></path><path style="fill:#0294de" class="[--delay:1.2s]" d="M396.88,484.35l-50.97-29.43c-.08-.04-.17-.06-.24-.1-.8-.44-1.64-.79-2.51-1.03-.14-.04-.27-.06-.41-.09-.81-.19-1.64-.3-2.47-.32-.13,0-.26-.02-.39-.02-.89,0-1.78.13-2.66.35-.18.04-.36.1-.54.15-.88.26-1.76.59-2.58,1.07l-25.49,14.72c-9.84,5.68-22.06,5.68-31.9,0-9.84-5.68-15.96-16.27-15.96-27.63v-29.43c0-.95-.15-1.87-.37-2.76-.05-.19-.09-.37-.14-.56-.25-.86-.59-1.69-1.03-2.47-.07-.12-.15-.22-.22-.34-.43-.71-.94-1.37-1.51-1.97-.1-.1-.18-.21-.28-.31-.65-.63-1.37-1.18-2.15-1.66-.07-.04-.13-.11-.2-.16l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22l50.97,29.43c.08.04.17.06.25.1.8.44,1.63.79,2.5,1.03.14.04.29.06.43.09.8.19,1.61.3,2.43.32.1,0,.2.04.3.04.04,0,.09-.02.13-.02.88,0,1.77-.13,2.64-.34.19-.04.37-.1.56-.16.88-.26,1.75-.59,2.57-1.06l25.49-14.71c9.84-5.68,22.06-5.68,31.91,0,9.84,5.68,15.95,16.27,15.95,27.63v29.43c0,.95.15,1.87.37,2.76.05.19.09.37.14.56.25.86.59,1.69,1.03,2.47.07.12.15.22.22.34.43.71.94,1.37,1.51,1.97.1.1.18.21.28.31.65.63,1.37,1.18,2.15,1.66.07.04.13.11.2.16l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22Z"></path></svg>Powered by Devin</a></div><div class="container-wrapper"><div class="container mx-auto flex w-full flex-row items-center gap-2 py-4 md:py-6"><a class="flex items-center gap-3" href="https://deepwiki.com"><span class="text-base font-medium leading-none text-white md:text-lg hidden sm:block">DeepWiki</span></a><div class="flex-1"><div class="flex flex-col gap-1"><a class="block text-xs font-medium leading-none text-white sm:hidden md:text-lg" href="/">DeepWiki</a><p class="text-text-secondary text-sm font-normal leading-none md:text-lg"><a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService" target="_blank" rel="noopener noreferrer" class="text-[#8f8f8f] transition-colors hover:text-black dark:hover:text-white">markdownpro2/IstgHtmlDocxConvertService</a></p></div></div><div class="flex items-center gap-4"><a href="https://devin.ai" target="_blank" rel="noopener noreferrer" class="group hidden items-center gap-1.5 md:flex"><div class="relative"><span class="text-xs font-light text-white/70 transition-colors group-hover:text-white">powered by</span><div class="absolute bottom-0 left-0 h-[1px] w-0 bg-black/30 transition-all duration-300 group-hover:w-full dark:bg-white/30"></div></div><div class="flex items-center gap-1 transition-transform duration-300 group-hover:translate-x-0.5"><svg class="size-4 transform transition-transform duration-700 group-hover:rotate-180 [&amp;_path]:stroke-0" xmlns="http://www.w3.org/2000/svg" viewBox="110 110 460 500"><path style="fill:#21c19a" class="" d="M418.73,332.37c9.84-5.68,22.07-5.68,31.91,0l25.49,14.71c.82.48,1.69.8,2.58,1.06.19.06.37.11.55.16.87.21,1.76.34,2.65.35.04,0,.08.02.13.02.1,0,.19-.03.29-.04.83-.02,1.64-.13,2.45-.32.14-.03.28-.05.42-.09.87-.24,1.7-.59,2.5-1.03.08-.04.17-.06.25-.1l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-.08.04-.13.11-.2.16-.78.48-1.51,1.02-2.15,1.66-.1.1-.18.21-.28.31-.57.6-1.08,1.26-1.51,1.97-.07.12-.15.22-.22.34-.44.77-.77,1.6-1.03,2.47-.05.19-.1.37-.14.56-.22.89-.37,1.81-.37,2.76v29.43c0,11.36-6.11,21.95-15.95,27.63-9.84,5.68-22.06,5.68-31.91,0l-25.49-14.71c-.82-.48-1.69-.8-2.57-1.06-.19-.06-.37-.11-.56-.16-.88-.21-1.76-.34-2.65-.34-.13,0-.26.02-.4.02-.84.02-1.66.13-2.47.32-.13.03-.27.05-.4.09-.87.24-1.71.6-2.51,1.04-.08.04-.16.06-.24.1l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22l50.97,29.43c.08.04.17.06.24.1.8.44,1.64.79,2.5,1.03.14.04.28.06.42.09.81.19,1.62.3,2.45.32.1,0,.19.04.29.04.04,0,.08-.02.13-.02.89,0,1.77-.13,2.65-.35.19-.04.37-.1.56-.16.88-.26,1.75-.59,2.58-1.06l25.49-14.71c9.84-5.68,22.06-5.68,31.91,0,9.84,5.68,15.95,16.27,15.95,27.63v29.43c0,.95.15,1.87.37,2.76.05.19.09.37.14.56.25.86.59,1.69,1.03,2.47.07.12.15.22.22.34.43.71.94,1.37,1.51,1.97.1.1.18.21.28.31.65.63,1.37,1.18,2.15,1.66.07.04.13.11.2.16l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-.08-.04-.16-.06-.24-.1-.8-.44-1.64-.8-2.51-1.04-.13-.04-.26-.05-.39-.09-.82-.2-1.65-.31-2.49-.33-.13,0-.25-.02-.38-.02-.89,0-1.78.13-2.66.35-.18.04-.36.1-.54.15-.88.26-1.75.59-2.58,1.07l-25.49,14.72c-9.84,5.68-22.07,5.68-31.9,0-9.84-5.68-15.95-16.27-15.95-27.63s6.11-21.95,15.95-27.63Z"></path><path style="fill:#3969ca" d="M141.09,317.65l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c.08-.04.13-.11.2-.16.78-.48,1.51-1.02,2.15-1.66.1-.1.18-.21.28-.31.57-.6,1.08-1.26,1.51-1.97.07-.12.15-.22.22-.34.44-.77.77-1.6,1.03-2.47.05-.19.1-.37.14-.56.22-.89.37-1.81.37-2.76v-29.43c0-11.36,6.11-21.95,15.96-27.63s22.06-5.68,31.91,0l25.49,14.71c.82.48,1.69.8,2.57,1.06.19.06.37.11.56.16.87.21,1.76.34,2.64.35.04,0,.09.02.13.02.1,0,.19-.04.29-.04.83-.02,1.65-.13,2.45-.32.14-.03.28-.05.41-.09.87-.24,1.71-.6,2.51-1.04.08-.04.16-.06.24-.1l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-.08.04-.13.11-.2.16-.78.48-1.51,1.02-2.15,1.66-.1.1-.18.21-.28.31-.57.6-1.08,1.26-1.51,1.97-.07.12-.15.22-.22.34-.44.77-.77,1.6-1.03,2.47-.05.19-.1.37-.14.56-.22.89-.37,1.81-.37,2.76v29.43c0,11.36-6.11,21.95-15.95,27.63-9.84,5.68-22.07,5.68-31.91,0l-25.49-14.71c-.82-.48-1.69-.8-2.58-1.06-.19-.06-.37-.11-.55-.16-.88-.21-1.76-.34-2.65-.35-.13,0-.26.02-.4.02-.83.02-1.66.13-2.47.32-.13.03-.27.05-.4.09-.87.24-1.71.6-2.51,1.04-.08.04-.16.06-.24.1l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22Z"></path><path style="fill:#0294de" class="" d="M396.88,484.35l-50.97-29.43c-.08-.04-.17-.06-.24-.1-.8-.44-1.64-.79-2.51-1.03-.14-.04-.27-.06-.41-.09-.81-.19-1.64-.3-2.47-.32-.13,0-.26-.02-.39-.02-.89,0-1.78.13-2.66.35-.18.04-.36.1-.54.15-.88.26-1.76.59-2.58,1.07l-25.49,14.72c-9.84,5.68-22.06,5.68-31.9,0-9.84-5.68-15.96-16.27-15.96-27.63v-29.43c0-.95-.15-1.87-.37-2.76-.05-.19-.09-.37-.14-.56-.25-.86-.59-1.69-1.03-2.47-.07-.12-.15-.22-.22-.34-.43-.71-.94-1.37-1.51-1.97-.1-.1-.18-.21-.28-.31-.65-.63-1.37-1.18-2.15-1.66-.07-.04-.13-.11-.2-.16l-50.97-29.43c-3.65-2.11-8.15-2.11-11.81,0l-50.97,29.43c-3.65,2.11-5.9,6.01-5.9,10.22v58.86c0,4.22,2.25,8.11,5.9,10.22l50.97,29.43c.08.04.17.06.25.1.8.44,1.63.79,2.5,1.03.14.04.29.06.43.09.8.19,1.61.3,2.43.32.1,0,.2.04.3.04.04,0,.09-.02.13-.02.88,0,1.77-.13,2.64-.34.19-.04.37-.1.56-.16.88-.26,1.75-.59,2.57-1.06l25.49-14.71c9.84-5.68,22.06-5.68,31.91,0,9.84,5.68,15.95,16.27,15.95,27.63v29.43c0,.95.15,1.87.37,2.76.05.19.09.37.14.56.25.86.59,1.69,1.03,2.47.07.12.15.22.22.34.43.71.94,1.37,1.51,1.97.1.1.18.21.28.31.65.63,1.37,1.18,2.15,1.66.07.04.13.11.2.16l50.97,29.43c1.83,1.05,3.86,1.58,5.9,1.58s4.08-.53,5.9-1.58l50.97-29.43c3.65-2.11,5.9-6.01,5.9-10.22v-58.86c0-4.22-2.25-8.11-5.9-10.22Z"></path></svg><span class="text-sm font-medium text-white">Devin</span></div></a><button class="border-border bg-surface hover:border-border-hover hover:bg-component ml-auto flex cursor-pointer items-center gap-1.5 rounded-md border px-3 py-1.5 text-sm font-medium text-white transition-all" aria-label="Share"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg><span>Share</span></button><div class="h-8 w-8"></div></div></div></div></div><!--$--><div class="w-full flex-1"><div class="container-wrapper relative mx-auto h-full px-0"><div class="container relative mx-auto flex h-full w-full flex-col gap-0 max-md:!px-0 md:flex-row md:gap-6 lg:gap-10"><div class="border-r-border hidden max-h-screen border-r border-dashed py-7 pr-4 transition-[border-radius] md:sticky md:left-0 md:top-20 md:block md:h-[calc(100vh-82px)] md:w-64 md:flex-shrink-0 md:overflow-y-auto lg:py-9 xl:w-72"><div class="flex h-full w-full max-w-full flex-shrink-0 flex-col overflow-hidden" style="scrollbar-color:var(--color-border) transparent"><div class="flex-shrink-0 px-2"><div class="text-secondary pb-1 text-xs">Last indexed: <!-- -->27 May 2025<!-- --> (<a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/commits/c4d5f8ff" target="_blank" rel="noopener noreferrer">c4d5f8</a>)</div></div><ul class="flex-1 flex-shrink-0 space-y-1 overflow-y-auto py-1" style="scrollbar-width:none"><li style="padding-left:0"><a data-selected="true" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/1-overview">Overview</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/2-system-architecture">System Architecture</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/3-http-api-reference">HTTP API Reference</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/3.1-document-conversion-api">Document Conversion API</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/3.2-word-integration-api">Word Integration API</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/4-core-services">Core Services</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/4.1-document-conversion-services">Document Conversion Services</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/4.2-session-management">Session Management</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/4.3-authentication-service">Authentication Service</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/5-real-time-communication">Real-time Communication</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/5.1-websocket-handler">WebSocket Handler</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/5.2-websocket-protocol">WebSocket Protocol</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/6-error-handling">Error Handling</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/6.1-http-error-codes">HTTP Error Codes</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/6.2-websocket-error-codes">WebSocket Error Codes</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/7-configuration-and-deployment">Configuration and Deployment</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/7.1-application-configuration">Application Configuration</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/7.2-logging-system">Logging System</a></li><li style="padding-left:12px"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/7.3-deployment-and-publishing">Deployment and Publishing</a></li><li style="padding-left:0"><a data-selected="false" class="hover:bg-hover block w-full rounded px-2 py-1.5 text-left text-sm transition-none text-secondary data-[selected=true]:bg-hover data-[selected=true]:text-primary font-normal data-[selected=true]:font-normal" href="/markdownpro2/IstgHtmlDocxConvertService/8-development-setup">Development Setup</a></li></ul></div></div><div class="flex h-full flex-1 flex-col overflow-hidden"><div class="bg-main border-b-border sticky top-0 z-10 border-b border-dashed md:hidden"><div class="flex cursor-pointer items-center gap-2 p-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256" class="transition-transform"><path d="M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"></path></svg><span class="truncate text-base font-normal">Menu</span></div></div><div class="relative flex-1 overflow-y-auto px-3 pt-3 md:rounded-md md:px-0 md:pt-0 [&amp;_::selection]:bg-purple-500/40" style="scrollbar-color:var(--color-night) transparent"><div class="pb-30 mx-auto max-w-2xl md:pb-40 md:pt-6 lg:pt-8"><div class="prose prose-invert dark:prose-invert prose-headings:text-inherit prose-p:text-inherit max-w-none"><div><div class="prose-custom prose-custom-md prose-custom-gray !max-w-none text-neutral-300 [overflow-wrap:anywhere]"><h1 id="overview" class="group flex items-center" data-header="true">Overview<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h1>
<details>
<summary>Relevant source files</summary>
<ul>
<li><a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4] rounded-r"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span></a></li>
<li><a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/LICENSE" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4] rounded-r"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>LICENSE</span></a></li>
<li><a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/README.md" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4] rounded-r"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>README.md</span></a></li>
</ul>
</details>
<h2 id="purpose-and-scope" class="group flex items-center" data-header="true">Purpose and Scope<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>
<p>IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. The service enables users to convert HTML content (particularly from TinyMCE editor) to Word documents, edit those documents in Microsoft Word, and synchronize changes back to HTML in real-time.</p>
<p>This overview covers the high-level architecture, core capabilities, and key components of the system. For detailed API documentation, see <a href="/markdownpro2/IstgHtmlDocxConvertService/3-http-api-reference" class="text-neutral-300 hover:text-neutral-200 hover:underline">HTTP API Reference</a>. For real-time communication protocols, see <a href="/markdownpro2/IstgHtmlDocxConvertService/5-real-time-communication" class="text-neutral-300 hover:text-neutral-200 hover:underline">Real-time Communication</a>. For deployment and configuration details, see <a href="/markdownpro2/IstgHtmlDocxConvertService/7-configuration-and-deployment" class="text-neutral-300 hover:text-neutral-200 hover:underline">Configuration and Deployment</a>.</p>
<p>Sources: <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/README.md#L1-L3" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>README.md</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">1-3</span></a> <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L1-L41" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">1-41</span></a></p>
<h2 id="system-architecture" class="group flex items-center" data-header="true">System Architecture<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>
<p>The service follows a layered architecture with multiple communication protocols and external integrations:</p>
<h3 id="high-level-component-architecture" class="group flex items-center" data-header="true">High-Level Component Architecture<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<pre class="px-2 py-1.5 has-[code]:rounded-md has-[code]:!bg-[#e5e5e5] has-[div]:bg-transparent has-[div]:!p-0 has-[code]:text-stone-900 dark:has-[code]:!bg-[#242424] has-[code]:dark:text-white [&amp;_code]:block [&amp;_code]:border-none [&amp;_code]:bg-transparent [&amp;_code]:p-0"><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--></pre>
<p>Sources: <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L25-L26" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">25-26</span></a> <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L29-L31" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">29-31</span></a></p>
<h3 id="document-processing-workflow" class="group flex items-center" data-header="true">Document Processing Workflow<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<pre class="px-2 py-1.5 has-[code]:rounded-md has-[code]:!bg-[#e5e5e5] has-[div]:bg-transparent has-[div]:!p-0 has-[code]:text-stone-900 dark:has-[code]:!bg-[#242424] has-[code]:dark:text-white [&amp;_code]:block [&amp;_code]:border-none [&amp;_code]:bg-transparent [&amp;_code]:p-0"><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--></pre>
<p>Sources: Based on system architecture diagrams and component relationships</p>
<h2 id="core-capabilities" class="group flex items-center" data-header="true">Core Capabilities<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>
<h3 id="document-conversion" class="group flex items-center" data-header="true">Document Conversion<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong>HTML to DOCX</strong>: Converts HTML content to Microsoft Word documents using <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">ConversionService</code> and <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">Aspose.Words</code></li>
<li><strong>DOCX to HTML</strong>: Processes uploaded Word documents back to HTML format</li>
<li><strong>Format Preservation</strong>: Maintains styling, formatting, and document structure across conversions</li>
</ul>
<h3 id="real-time-collaboration" class="group flex items-center" data-header="true">Real-Time Collaboration<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong>WebSocket Communication</strong>: Bidirectional real-time updates via <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">WebSocketHandler</code></li>
<li><strong>Session Management</strong>: User sessions tracked through <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">SessionStorageService</code> with <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">HtmlSession</code> objects</li>
<li><strong>Live Synchronization</strong>: Changes in Microsoft Word automatically sync to web clients</li>
</ul>
<h3 id="microsoft-word-integration" class="group flex items-center" data-header="true">Microsoft Word Integration<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong>Launch URLs</strong>: Generates <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">ms-word://</code> protocol URLs via <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">EditInWordController</code></li>
<li><strong>OOXML Processing</strong>: Handles Word document updates through OOXML format</li>
<li><strong>Background Cleanup</strong>: Automatic file and session cleanup via <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">SessionCleanupService</code></li>
</ul>
<p>Sources: Based on component analysis and workflow diagrams</p>
<h2 id="technology-stack" class="group flex items-center" data-header="true">Technology Stack<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>













































<table><thead><tr><th>Component</th><th>Technology</th><th>Purpose</th></tr></thead><tbody><tr><td><strong>Framework</strong></td><td>.NET 6.0</td><td>Web service platform</td></tr><tr><td><strong>Document Engine</strong></td><td>Aspose.Words</td><td>Core document conversion</td></tr><tr><td><strong>Database</strong></td><td>SQL Server</td><td>User authentication via <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">tbrPersonnel</code></td></tr><tr><td><strong>Real-time</strong></td><td>WebSockets</td><td>Live collaboration</td></tr><tr><td><strong>Graphics</strong></td><td>SkiaSharp</td><td>Image processing support</td></tr><tr><td><strong>API Documentation</strong></td><td>Swashbuckle</td><td>OpenAPI/Swagger integration</td></tr><tr><td><strong>External Integration</strong></td><td>IstgOfficeAutomationBrl</td><td>Office automation components</td></tr></tbody></table>
<p>Sources: <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L10-L14" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">10-14</span></a> <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L16-L22" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">16-22</span></a> <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/IstgHtmlDocxConvertService.csproj#L24-L32" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>IstgHtmlDocxConvertService.csproj</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">24-32</span></a></p>
<h2 id="key-components-overview" class="group flex items-center" data-header="true">Key Components Overview<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>
<h3 id="controllers" class="group flex items-center" data-header="true">Controllers<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">ConversionController</code></strong>: HTTP REST endpoints for document conversion operations</li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">EditInWordController</code></strong>: Word integration endpoints for launching and managing Word editing sessions</li>
</ul>
<h3 id="services" class="group flex items-center" data-header="true">Services<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">ConversionService</code></strong>: Core business logic for document processing and format conversion</li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">HtmlService</code></strong>: Specialized HTML content processing and manipulation</li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">SessionStorageService</code></strong>: Session lifecycle management using <code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">ConcurrentDictionary</code></li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">TokenValidationService</code></strong>: User authentication against SQL database</li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">SessionCleanupService</code></strong>: Background service for resource cleanup</li>
</ul>
<h3 id="communication" class="group flex items-center" data-header="true">Communication<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h3>
<ul>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">WebSocketHandler</code></strong>: Real-time message processing and client/Word application coordination</li>
<li><strong><code class="rounded-sm bg-[#e5e5e5] px-[0.25rem] py-[0.20rem] text-xs font-normal leading-[15px] before:hidden after:hidden dark:bg-[#484848]/30">HtmlSession</code></strong>: Session state container linking users, HTML content, and WebSocket connections</li>
</ul>
<p>Sources: Based on architectural analysis and component relationships</p>
<h2 id="license-and-usage" class="group flex items-center" data-header="true">License and Usage<button class="relative ml-2 cursor-pointer text-gray-400 opacity-0 transition-opacity hover:text-blue-400 focus:opacity-100 group-hover:opacity-100" aria-label="Copy link to header"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 256 256" class="h-4 w-4"><path d="M117.18,188.74a12,12,0,0,1,0,17l-5.12,5.12A58.26,58.26,0,0,1,70.6,228h0A58.62,58.62,0,0,1,29.14,127.92L63.89,93.17a58.64,58.64,0,0,1,98.56,28.11,12,12,0,1,1-23.37,5.44,34.65,34.65,0,0,0-58.22-16.58L46.11,144.89A34.62,34.62,0,0,0,70.57,204h0a34.41,34.41,0,0,0,24.49-10.14l5.11-5.12A12,12,0,0,1,117.18,188.74ZM226.83,45.17a58.65,58.65,0,0,0-82.93,0l-5.11,5.11a12,12,0,0,0,17,17l5.12-5.12a34.63,34.63,0,1,1,49,49L175.1,145.86A34.39,34.39,0,0,1,150.61,156h0a34.63,34.63,0,0,1-33.69-26.72,12,12,0,0,0-23.38,5.44A58.64,58.64,0,0,0,150.56,180h.05a58.28,58.28,0,0,0,41.47-17.17l34.75-34.75a58.62,58.62,0,0,0,0-82.91Z"></path></svg></button></h2>
<p>The service is distributed under the MIT License, allowing unrestricted use, modification, and distribution for both commercial and non-commercial purposes.</p>
<p>Sources: <a href="https://github.com/markdownpro2/IstgHtmlDocxConvertService/blob/c4d5f8ff/LICENSE#L1-L22" target="_blank" rel="noopener noreferrer" class="mb-1 mr-1 inline-flex items-stretch font-mono text-xs !no-underline transition-opacity hover:opacity-75"><span class="flex items-center break-all rounded-l px-2 py-1.5 bg-[#e5e5e5] text-[#333333] dark:bg-[#252525] dark:text-[#e4e4e4]"><svg class="mr-1.5 hidden h-3.5 w-3.5 flex-shrink-0 opacity-40 md:block" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg>LICENSE</span><span class="flex flex-shrink-0 items-center rounded-r border-l px-2 py-1.5 border-[#dddddd] bg-[#d8d8d8] text-[#666666] dark:border-[#333333] dark:bg-[#2a2a2a] dark:text-[#888888]">1-22</span></a></p></div></div></div></div></div></div><div class="hidden overflow-hidden transition-[border-radius] xl:sticky xl:right-0 xl:top-20 xl:block xl:h-[calc(100vh-82px)] xl:w-64 xl:flex-shrink-0 2xl:w-72" style="scrollbar-width:none"><div class="flex max-h-full w-full flex-shrink-0 flex-col py-6 pt-0 text-sm lg:pb-4 lg:pt-8 xl:w-64 2xl:w-72" style="scrollbar-color:var(--color-night) transparent"><div><div class="mx-4 mb-3 rounded-md border border-neutral-200 bg-neutral-100 p-3 text-sm text-neutral-600 dark:border-neutral-800 dark:bg-neutral-900 dark:text-neutral-400"><p class="text-sm font-medium">Auto-refresh not enabled yet<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 256 256" class="ml-1.5 inline-block cursor-help text-neutral-400 transition-colors hover:text-neutral-600 dark:text-neutral-500 dark:hover:text-neutral-400" data-state="closed"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"></path></svg></p></div><div class="mx-4 mb-3 rounded-md border border-neutral-200 bg-neutral-100 p-3 text-sm text-neutral-600 dark:border-neutral-800 dark:bg-neutral-900 dark:text-neutral-400"><p class="text-sm font-medium">Try DeepWiki on your private codebase with<!-- --> <a href="/private-repo" class="text-pacific hover:underline">Devin</a></p></div></div><h3 class="px-4 pb-5 text-lg font-medium leading-none">On this page</h3><ul style="scrollbar-width:none" class="min-h-0 flex-1 space-y-3 overflow-y-auto p-4 pt-0"><li class=""><a href="#overview" class="hover:text-primary pr-1 transition-all text-primary font-medium">Overview</a></li><li class="ml-3"><a href="#purpose-and-scope" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Purpose and Scope</a></li><li class="ml-3"><a href="#system-architecture" class="hover:text-primary pr-1 font-normal transition-all text-secondary">System Architecture</a></li><li class="ml-6"><a href="#high-level-component-architecture" class="hover:text-primary pr-1 font-normal transition-all text-secondary">High-Level Component Architecture</a></li><li class="ml-6"><a href="#document-processing-workflow" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Document Processing Workflow</a></li><li class="ml-3"><a href="#core-capabilities" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Core Capabilities</a></li><li class="ml-6"><a href="#document-conversion" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Document Conversion</a></li><li class="ml-6"><a href="#real-time-collaboration" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Real-Time Collaboration</a></li><li class="ml-6"><a href="#microsoft-word-integration" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Microsoft Word Integration</a></li><li class="ml-3"><a href="#technology-stack" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Technology Stack</a></li><li class="ml-3"><a href="#key-components-overview" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Key Components Overview</a></li><li class="ml-6"><a href="#controllers" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Controllers</a></li><li class="ml-6"><a href="#services" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Services</a></li><li class="ml-6"><a href="#communication" class="hover:text-primary pr-1 font-normal transition-all text-secondary">Communication</a></li><li class="ml-3"><a href="#license-and-usage" class="hover:text-primary pr-1 font-normal transition-all text-secondary">License and Usage</a></li></ul></div></div><div class="pointer-events-none fixed bottom-2 left-2 right-2 mt-2 md:bottom-4 md:left-0 md:right-0"><div class="z-10 mx-auto max-w-3xl"><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--></div></div></div></div></div><!--/$--></div><script src="/_next/static/chunks/webpack-acbbbb548492d4a6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[51709,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9853\",\"static/chunks/9853-ba5965ca136d44c2.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"7177\",\"static/chunks/app/layout-d0b9af9c0a55f7f8.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"RootProvider\"]\n3:I[87555,[],\"\"]\n4:I[31295,[],\"\"]\n6:I[90894,[],\"ClientPageRoot\"]\n7:I[87667,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2545\",\"static/chunks/c16f53c3-c80d3b6d0c4af7a0.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2136\",\"static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9970\",\"static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1235\",\"static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4889\",\"static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"168\",\"static/chunks/168-d8e567d7acd9a9f8.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9853\",\"static/chunks/9853-ba5965ca136d44c2.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2633\",\"static/chunks/2"])</script><script>self.__next_f.push([1,"633-f99bb2e714e9ea02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8335\",\"static/chunks/8335-ffeda651fe4c8445.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3285\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/%5B%5B...wikiRoutes%5D%5D/page-9ab64d064ff2dc46.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"default\"]\na:I[59665,[],\"OutletBoundary\"]\nd:I[59665,[],\"ViewportBoundary\"]\nf:I[59665,[],\"MetadataBoundary\"]\n11:I[26614,[],\"\"]\n:HL[\"/_next/static/media/569ce4b8f30dc480-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/93f479601ee12b01-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/f30152c0704fba31.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"style\"]\n:HL[\"/_next/static/css/3bb537d759a88006.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"37hK0evIbV0cT8_aUwmu3\",\"p\":\"\",\"c\":[\"\",\"markdownpro2\",\"IstgHtmlDocxConvertService\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[[\"org\",\"markdownpro2\",\"d\"],{\"children\":[[\"repo\",\"IstgHtmlDocxConvertService\",\"d\"],{\"children\":[[\"wikiRoutes\",\"\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/f30152c0704fba31.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3bb537d759a88006.css?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{}],[\"$\",\"body\",null,{\"className\":\"__variable_5cfdac font-geist-sans relative min-h-screen __variable_9a8899 bg-background antialiased\",\"children\":[\"$\",\"$L2\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}]]}],{\"children\":[[\"org\",\"markdownpro2\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"repo\",\"IstgHtmlDocxConvertService\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,\"$L5\"]}],{\"children\":[[\"wikiRoutes\",\"\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"$L6\",null,{\"Component\":\"$7\",\"searchParams\":{},\"params\":{\"org\":\"markdownpro2\",\"repo\":\"IstgHtmlDocxConvertService\"},\"promises\":[\"$@8\",\"$@9\"]}],\"$undefined\",null,[\"$\",\"$La\",null,{\"children\":[\"$Lb\",\"$Lc\",null]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"cP2DdswzreKWgGrwfWL_h\",{\"children\":[[\"$\",\"$Ld\",null,{\"children\":\"$Le\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$Lf\",null,{\"children\":\"$L10\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$11\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"12:I[53508,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4129\",\"static/chunks/7bf36345-20a79815585d2583.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2136\",\"static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9970\",\"static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1235\",\"static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4889\",\"static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"7646\",\"static/chunks/7646-a48026d39d9219b5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3449\",\"static/chunks/3449-b65893d981d76d04.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6405\",\"static/chunks/6405-fac8cb0868b7ff00.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5805\",\"static/chunks/5805-44d30e670d12436d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-fb0c43d422447c44.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"CodebaseWikiHeader\"]\n13:I[6874,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4129\",\"static/chunks/7bf36345-20a79815585d2583.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7r"])</script><script>self.__next_f.push([1,"nB19BW\",\"2136\",\"static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9970\",\"static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1235\",\"static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4889\",\"static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"7646\",\"static/chunks/7646-a48026d39d9219b5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3449\",\"static/chunks/3449-b65893d981d76d04.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6405\",\"static/chunks/6405-fac8cb0868b7ff00.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5805\",\"static/chunks/5805-44d30e670d12436d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-fb0c43d422447c44.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"\"]\n14:\"$Sreact.suspense\"\n15:I[67807,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4129\",\"static/chunks/7bf36345-20a79815585d2583.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2136\",\"static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9970\",\"static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1235\",\"static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4889\",\"static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"7646"])</script><script>self.__next_f.push([1,"\",\"static/chunks/7646-a48026d39d9219b5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3449\",\"static/chunks/3449-b65893d981d76d04.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6405\",\"static/chunks/6405-fac8cb0868b7ff00.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5805\",\"static/chunks/5805-44d30e670d12436d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-fb0c43d422447c44.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"ShinyText\"]\n8:{}\n9:{\"org\":\"markdownpro2\",\"repo\":\"IstgHtmlDocxConvertService\"}\n5:[\"$\",\"div\",null,{\"className\":\"flex min-h-screen w-full flex-col text-white\",\"id\":\"codebase-wiki-repo-page\",\"children\":[[\"$\",\"$L12\",null,{\"hideOnSm\":true,\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col gap-1\",\"children\":[[\"$\",\"$L13\",null,{\"href\":\"/\",\"className\":\"block text-xs font-medium leading-none text-white sm:hidden md:text-lg\",\"children\":\"DeepWiki\"}],[\"$\",\"p\",null,{\"className\":\"text-text-secondary text-sm font-normal leading-none md:text-lg\",\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/markdownpro2/IstgHtmlDocxConvertService\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-[#8f8f8f] transition-colors hover:text-black dark:hover:text-white\",\"children\":\"markdownpro2/IstgHtmlDocxConvertService\"}]}]]}]}],[\"$\",\"$14\",null,{\"fallback\":[\"$\",\"div\",null,{\"className\":\"container-wrapper flex flex-1 items-center justify-center px-4\",\"children\":[\"$\",\"$L15\",null,{\"className\":\"text-center text-lg\",\"text\":\"Loading markdownpro2/IstgHtmlDocxConvertService...\",\"speed\":1}]}],\"children\":\"$L16\"}]]}]\n"])</script><script>self.__next_f.push([1,"e:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nb:null\n"])</script><script>self.__next_f.push([1,"17:I[60168,[\"9453\",\"static/chunks/b1298b8d-549c141f97a3b262.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"8970\",\"static/chunks/378e5a93-3b0f971d3611a8a5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1585\",\"static/chunks/f7f68e2d-40290491c524df5c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4129\",\"static/chunks/7bf36345-20a79815585d2583.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"537\",\"static/chunks/537-d9d5e9261de3e69c.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5009\",\"static/chunks/5009-cf1c1739f4eccbfa.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2136\",\"static/chunks/2136-0f8d797058c844d4.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3377\",\"static/chunks/3377-d302682beb4206f6.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6671\",\"static/chunks/6671-b0da8a89e8d16b02.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"9970\",\"static/chunks/9970-05da82a5b9af6015.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"1235\",\"static/chunks/1235-2bb070afbba964c5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"4889\",\"static/chunks/4889-88dda955466eba30.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"7646\",\"static/chunks/7646-a48026d39d9219b5.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"3449\",\"static/chunks/3449-b65893d981d76d04.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"6405\",\"static/chunks/6405-fac8cb0868b7ff00.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"5805\",\"static/chunks/5805-44d30e670d12436d.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\",\"2933\",\"static/chunks/app/%5Borg%5D/%5Brepo%5D/layout-fb0c43d422447c44.js?dpl=dpl_FDp5jorecnoDnm4UZEvJ7rnB19BW\"],\"WikiLayout\"]\n18:T1b93,"])</script><script>self.__next_f.push([1,"# Overview\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [IstgHtmlDocxConvertService.csproj](IstgHtmlDocxConvertService.csproj)\n- [LICENSE](LICENSE)\n- [README.md](README.md)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nIstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. The service enables users to convert HTML content (particularly from TinyMCE editor) to Word documents, edit those documents in Microsoft Word, and synchronize changes back to HTML in real-time.\n\nThis overview covers the high-level architecture, core capabilities, and key components of the system. For detailed API documentation, see [HTTP API Reference](#3). For real-time communication protocols, see [Real-time Communication](#5). For deployment and configuration details, see [Configuration and Deployment](#7).\n\nSources: [README.md:1-3](), [IstgHtmlDocxConvertService.csproj:1-41]()\n\n## System Architecture\n\nThe service follows a layered architecture with multiple communication protocols and external integrations:\n\n### High-Level Component Architecture\n\n```mermaid\ngraph TB\n    subgraph \"HTTP_API_Layer\"\n        ConversionController[\"ConversionController\"]\n        EditInWordController[\"EditInWordController\"]\n    end\n    \n    subgraph \"WebSocket_Layer\" \n        WebSocketHandler[\"WebSocketHandler\"]\n    end\n    \n    subgraph \"Core_Services\"\n        ConversionService[\"ConversionService\"]\n        HtmlService[\"HtmlService\"] \n        SessionStorageService[\"SessionStorageService\"]\n        TokenValidationService[\"TokenValidationService\"]\n        SessionCleanupService[\"SessionCleanupService\"]\n    end\n    \n    subgraph \"External_Dependencies\"\n        AsposeWords[\"Aspose.Words\"]\n        SqlDatabase[\"SQL Database (tbrPersonnel)\"]\n        FileSystem[\"File System\"]\n        IstgOfficeAutomationBrl[\"IstgOfficeAutomationBrl\"]\n    end\n    \n    ConversionController --\u003e ConversionService\n    ConversionController --\u003e TokenValidationService\n    EditInWordController --\u003e ConversionService  \n    EditInWordController --\u003e TokenValidationService\n    \n    WebSocketHandler --\u003e ConversionService\n    WebSocketHandler --\u003e SessionStorageService\n    WebSocketHandler --\u003e TokenValidationService\n    \n    ConversionService --\u003e AsposeWords\n    ConversionService --\u003e HtmlService\n    ConversionService --\u003e SessionStorageService\n    \n    TokenValidationService --\u003e SqlDatabase\n    SessionStorageService --\u003e FileSystem\n    SessionCleanupService --\u003e SessionStorageService\n    \n    ConversionService --\u003e IstgOfficeAutomationBrl\n```\n\nSources: [IstgHtmlDocxConvertService.csproj:25-26](), [IstgHtmlDocxConvertService.csproj:29-31]()\n\n### Document Processing Workflow\n\n```mermaid\nflowchart LR\n    subgraph \"HTML_to_DOCX_Flow\"\n        HtmlInput[\"HTML Content\"] --\u003e ConversionService1[\"ConversionService\"]\n        ConversionService1 --\u003e HtmlService1[\"HtmlService\"] \n        HtmlService1 --\u003e AsposeWords1[\"Aspose.Words\"]\n        AsposeWords1 --\u003e DocxOutput[\"DOCX File\"]\n    end\n    \n    subgraph \"Word_Integration_Flow\"\n        DocxOutput --\u003e EditInWordController1[\"EditInWordController\"]\n        EditInWordController1 --\u003e MsWordUrl[\"ms-word:// URL\"]\n        MsWordUrl --\u003e WordApp[\"Microsoft Word\"]\n    end\n    \n    subgraph \"Real_Time_Sync\"\n        WordApp --\u003e WebSocketHandler1[\"WebSocketHandler\"]\n        WebSocketHandler1 --\u003e ConversionService2[\"ConversionService\"] \n        ConversionService2 --\u003e AsposeWords2[\"Aspose.Words\"]\n        AsposeWords2 --\u003e HtmlOutput[\"Updated HTML\"]\n        HtmlOutput --\u003e WebClient[\"Web Client\"]\n    end\n    \n    subgraph \"Session_Management\"\n        SessionStorageService1[\"SessionStorageService\"] --\u003e HtmlSession[\"HtmlSession\"]\n        HtmlSession --\u003e ConcurrentDictionary[\"ConcurrentDictionary Storage\"]\n        SessionCleanupService1[\"SessionCleanupService\"] --\u003e ConcurrentDictionary\n    end\n    \n    ConversionService1 -.-\u003e SessionStorageService1\n    ConversionService2 -.-\u003e SessionStorageService1\n    WebSocketHandler1 -.-\u003e SessionStorageService1\n```\n\nSources: Based on system architecture diagrams and component relationships\n\n## Core Capabilities\n\n### Document Conversion\n- **HTML to DOCX**: Converts HTML content to Microsoft Word documents using `ConversionService` and `Aspose.Words`\n- **DOCX to HTML**: Processes uploaded Word documents back to HTML format\n- **Format Preservation**: Maintains styling, formatting, and document structure across conversions\n\n### Real-Time Collaboration  \n- **WebSocket Communication**: Bidirectional real-time updates via `WebSocketHandler`\n- **Session Management**: User sessions tracked through `SessionStorageService` with `HtmlSession` objects\n- **Live Synchronization**: Changes in Microsoft Word automatically sync to web clients\n\n### Microsoft Word Integration\n- **Launch URLs**: Generates `ms-word://` protocol URLs via `EditInWordController` \n- **OOXML Processing**: Handles Word document updates through OOXML format\n- **Background Cleanup**: Automatic file and session cleanup via `SessionCleanupService`\n\nSources: Based on component analysis and workflow diagrams\n\n## Technology Stack\n\n| Component | Technology | Purpose |\n|-----------|------------|---------|\n| **Framework** | .NET 6.0 | Web service platform |\n| **Document Engine** | Aspose.Words | Core document conversion |\n| **Database** | SQL Server | User authentication via `tbrPersonnel` |\n| **Real-time** | WebSockets | Live collaboration |\n| **Graphics** | SkiaSharp | Image processing support |\n| **API Documentation** | Swashbuckle | OpenAPI/Swagger integration |\n| **External Integration** | IstgOfficeAutomationBrl | Office automation components |\n\nSources: [IstgHtmlDocxConvertService.csproj:10-14](), [IstgHtmlDocxConvertService.csproj:16-22](), [IstgHtmlDocxConvertService.csproj:24-32]()\n\n## Key Components Overview\n\n### Controllers\n- **`ConversionController`**: HTTP REST endpoints for document conversion operations\n- **`EditInWordController`**: Word integration endpoints for launching and managing Word editing sessions\n\n### Services  \n- **`ConversionService`**: Core business logic for document processing and format conversion\n- **`HtmlService`**: Specialized HTML content processing and manipulation\n- **`SessionStorageService`**: Session lifecycle management using `ConcurrentDictionary`\n- **`TokenValidationService`**: User authentication against SQL database\n- **`SessionCleanupService`**: Background service for resource cleanup\n\n### Communication\n- **`WebSocketHandler`**: Real-time message processing and client/Word application coordination\n- **`HtmlSession`**: Session state container linking users, HTML content, and WebSocket connections\n\nSources: Based on architectural analysis and component relationships\n\n## License and Usage\n\nThe service is distributed under the MIT License, allowing unrestricted use, modification, and distribution for both commercial and non-commercial purposes.\n\nSources: [LICENSE:1-22]()"])</script><script>self.__next_f.push([1,"19:T48ff,"])</script><script>self.__next_f.push([1,"# System Architecture\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Program.cs](Program.cs)\n- [Services/ConversionService.cs](Services/ConversionService.cs)\n- [Services/SessionStorageService.cs](Services/SessionStorageService.cs)\n- [WebSockets/WebSocketHandler.cs](WebSockets/WebSocketHandler.cs)\n\n\u003c/details\u003e\n\n\n\nThis document explains the high-level architecture of the IstgHtmlDocxConvertService, including its layered design, dependency injection configuration, WebSocket communication patterns, and session management infrastructure. The system implements a multi-protocol document conversion service that supports both synchronous HTTP APIs and real-time WebSocket communication for collaborative document editing workflows.\n\nFor specific API endpoint documentation, see [HTTP API Reference](#3). For real-time communication details, see [Real-time Communication](#5). For error handling patterns, see [Error Handling](#6).\n\n## Application Startup and Dependency Injection\n\nThe application uses ASP.NET Core's built-in dependency injection container with a carefully designed service lifetime strategy. The startup configuration establishes the foundation for the entire system architecture.\n\n### Service Registration Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Program.cs Service Registration\"\n        WebApp[\"WebApplication.CreateBuilder()\"]\n        \n        subgraph \"Singleton Services\"\n            SystemEventLogger[\"SystemEventLogger\"]\n            SessionStorageService[\"SessionStorageService\"]\n        end\n        \n        subgraph \"Hosted Services\"\n            SessionCleanupService[\"SessionCleanupService\"]\n        end\n        \n        subgraph \"Scoped Services\"\n            ConversionService[\"ConversionService\"]\n            WebSocketHandler[\"WebSocketHandler\"]\n            TokenValidationService[\"TokenValidationService\"]\n        end\n        \n        subgraph \"Transient Services\"\n            HtmlService[\"HtmlService\"]\n        end\n        \n        subgraph \"Infrastructure\"\n            Controllers[\"AddControllers()\"]\n            Swagger[\"AddSwaggerGen()\"]\n            CORS[\"AddCors()\"]\n            WebSockets[\"UseWebSockets()\"]\n        end\n    end\n    \n    WebApp --\u003e SystemEventLogger\n    WebApp --\u003e SessionStorageService\n    WebApp --\u003e SessionCleanupService\n    WebApp --\u003e ConversionService\n    WebApp --\u003e WebSocketHandler\n    WebApp --\u003e TokenValidationService\n    WebApp --\u003e HtmlService\n    WebApp --\u003e Controllers\n    WebApp --\u003e Swagger\n    WebApp --\u003e CORS\n    WebApp --\u003e WebSockets\n```\n\nThe service registration follows a specific pattern where stateful services like `SessionStorageService` are registered as singletons to maintain session data across requests, while request-specific services like `ConversionService` are scoped to ensure proper resource management.\n\nSources: [Program.cs:19-25]()\n\n### Middleware Pipeline Architecture\n\n```mermaid\ngraph TB\n    Request[\"HTTP Request\"] --\u003e HttpsRedirection[\"UseHttpsRedirection()\"]\n    HttpsRedirection --\u003e CORS[\"UseCors('CorsPolicy')\"]\n    CORS --\u003e WebSocketMiddleware[\"WebSocket Middleware\"]\n    \n    subgraph \"WebSocket Processing\"\n        WebSocketMiddleware --\u003e WebSocketCheck{\"IsWebSocketRequest?\"}\n        WebSocketCheck --\u003e|Yes| CreateScope[\"CreateScope()\"]\n        CreateScope --\u003e GetHandler[\"GetRequiredService\u003cWebSocketHandler\u003e()\"]\n        GetHandler --\u003e AcceptWebSocket[\"AcceptWebSocketAsync()\"]\n        AcceptWebSocket --\u003e HandleAsync[\"handler.HandleAsync(webSocket)\"]\n    end\n    \n    WebSocketCheck --\u003e|No| Authorization[\"UseAuthorization()\"]\n    Authorization --\u003e MapControllers[\"MapControllers()\"]\n    \n    subgraph \"Aspose License\"\n        LicenseConfig[\"Configuration['Aspose:LicensePath']\"]\n        LicenseConfig --\u003e LicenseCheck{\"File.Exists(licensePath)?\"}\n        LicenseCheck --\u003e|Yes| SetLicense[\"new Aspose.Words.License().SetLicense()\"]\n        LicenseCheck --\u003e|No| LogError[\"Console.WriteLine('License path missing')\"]\n    end\n```\n\nThe middleware pipeline demonstrates the dual-protocol nature of the system, handling both traditional HTTP requests through controllers and WebSocket connections through custom middleware.\n\nSources: [Program.cs:55-69](), [Program.cs:76-88]()\n\n## Core Service Layer Architecture\n\nThe service layer implements a hierarchical dependency structure with clear separation of concerns. Each service has specific responsibilities and dependencies that create a well-defined architecture.\n\n### Service Dependency Graph\n\n```mermaid\ngraph TB\n    subgraph \"Controllers\"\n        ConversionController[\"ConversionController\"]\n        EditInWordController[\"EditInWordController\"]\n    end\n    \n    subgraph \"Core Services\"\n        ConversionService[\"ConversionService\"]\n        SessionStorageService[\"SessionStorageService\"]\n        TokenValidationService[\"TokenValidationService\"]\n        HtmlService[\"HtmlService\"]\n        WebSocketHandler[\"WebSocketHandler\"]\n    end\n    \n    subgraph \"Infrastructure Services\"\n        SystemEventLogger[\"SystemEventLogger\"]\n        IConfiguration[\"IConfiguration\"]\n    end\n    \n    subgraph \"Background Services\"\n        SessionCleanupService[\"SessionCleanupService\"]\n    end\n    \n    subgraph \"External Dependencies\"\n        AsposeWords[\"Aspose.Words.Document\"]\n        FileSystem[\"File System\"]\n        Database[\"SQL Database\"]\n    end\n    \n    ConversionController --\u003e ConversionService\n    ConversionController --\u003e TokenValidationService\n    EditInWordController --\u003e ConversionService\n    EditInWordController --\u003e TokenValidationService\n    \n    WebSocketHandler --\u003e ConversionService\n    WebSocketHandler --\u003e SessionStorageService\n    WebSocketHandler --\u003e TokenValidationService\n    WebSocketHandler --\u003e SystemEventLogger\n    \n    ConversionService --\u003e HtmlService\n    ConversionService --\u003e SessionStorageService\n    ConversionService --\u003e TokenValidationService\n    ConversionService --\u003e SystemEventLogger\n    ConversionService --\u003e IConfiguration\n    ConversionService --\u003e AsposeWords\n    ConversionService --\u003e FileSystem\n    \n    SessionStorageService --\u003e SystemEventLogger\n    SessionStorageService --\u003e IConfiguration\n    SessionStorageService --\u003e FileSystem\n    \n    SessionCleanupService --\u003e SessionStorageService\n    \n    TokenValidationService --\u003e Database\n```\n\nSources: [Services/ConversionService.cs:24-36](), [Services/SessionStorageService.cs:18-26](), [WebSockets/WebSocketHandler.cs:20-26]()\n\n### Service Lifetime and Resource Management\n\n| Service | Lifetime | Purpose | Key Dependencies |\n|---------|----------|---------|------------------|\n| `SystemEventLogger` | Singleton | Windows Event Log integration | None |\n| `SessionStorageService` | Singleton | In-memory session storage using `ConcurrentDictionary` | `IConfiguration`, `SystemEventLogger` |\n| `SessionCleanupService` | Hosted | Background cleanup of expired sessions | `SessionStorageService` |\n| `ConversionService` | Scoped | Document conversion using Aspose.Words | `HtmlService`, `SessionStorageService`, `TokenValidationService` |\n| `WebSocketHandler` | Scoped | WebSocket message processing | `ConversionService`, `SessionStorageService`, `TokenValidationService` |\n| `TokenValidationService` | Scoped | Database-based token validation | SQL Database |\n| `HtmlService` | Transient | HTML processing utilities | None |\n\nSources: [Program.cs:19-25]()\n\n## Session Management Architecture\n\nThe session management system uses a `ConcurrentDictionary\u003cstring, HtmlSession\u003e` as the core storage mechanism, providing thread-safe operations for multiple concurrent WebSocket connections.\n\n### Session Storage Implementation\n\n```mermaid\ngraph TB\n    subgraph \"SessionStorageService Internal Architecture\"\n        ConcurrentDict[\"ConcurrentDictionary\u003cstring, HtmlSession\u003e\"]\n        \n        subgraph \"HtmlSession Properties\"\n            UserId[\"UserId: string\"]\n            SessionId[\"SessionId: string\"]\n            Html[\"Html: string\"]\n            CreatedAt[\"CreatedAt: DateTime\"]\n            LastUpdated[\"LastUpdated: DateTime\"]\n            LastUserInteraction[\"LastUserInteraction: DateTime\"]\n            ClientSocket[\"ClientSocket: WebSocket?\"]\n            WordSocket[\"WordSocket: WebSocket?\"]\n            WordFilePath[\"WordFilePath: string?\"]\n        end\n        \n        subgraph \"Core Methods\"\n            CreateSession[\"CreateSession(userId, initialHtml)\"]\n            Get[\"Get(sessionId)\"]\n            SaveOrUpdate[\"SaveOrUpdate(sessionId, html)\"]\n            RemoveSession[\"RemoveSession(sessionId)\"]\n            TryRegisterSocket[\"TryRegisterSocket(sessionId, socket, origin)\"]\n            UnregisterSocket[\"UnregisterSocket(sessionId, socket)\"]\n        end\n        \n        subgraph \"Configuration\"\n            SessionTTL[\"SessionTTLMinutes: 30\"]\n            MaxSessionLifetime[\"MaxSessionLifetimeMinutes: 120\"]\n            MaxSessions[\"MaxSessions: 2\"]\n        end\n    end\n    \n    ConcurrentDict --\u003e HtmlSession\n    CreateSession --\u003e ConcurrentDict\n    Get --\u003e ConcurrentDict\n    SaveOrUpdate --\u003e ConcurrentDict\n    RemoveSession --\u003e ConcurrentDict\n    TryRegisterSocket --\u003e ConcurrentDict\n    UnregisterSocket --\u003e ConcurrentDict\n```\n\nThe session lifecycle management includes automatic cleanup based on both inactivity timeout (`SessionTTLMinutes`) and absolute lifetime limits (`MaxSessionLifetimeMinutes`).\n\nSources: [Services/SessionStorageService.cs:12-26](), [Services/SessionStorageService.cs:27-45](), [Services/SessionStorageService.cs:181-208]()\n\n### WebSocket Registration and Authentication\n\n```mermaid\ngraph LR\n    subgraph \"Socket Registration Flow\"\n        SocketConnect[\"WebSocket Connection\"] --\u003e InitMessage[\"Initial SocketMessageRequest\"]\n        InitMessage --\u003e ValidateSession{\"Session Exists?\"}\n        ValidateSession --\u003e|No| SessionNotFound[\"Send SessionNotFound Error\"]\n        ValidateSession --\u003e|Yes| ValidateToken{\"Valid Token?\"}\n        ValidateToken --\u003e|No| InvalidToken[\"Send InvalidToken Error\"]\n        ValidateToken --\u003e|Yes| RegisterSocket[\"TryRegisterSocket(sessionId, socket, origin)\"]\n        \n        subgraph \"Origin-based Registration\"\n            RegisterSocket --\u003e CheckOrigin{\"Origin Type?\"}\n            CheckOrigin --\u003e|\"Origins.Client\"| RegisterClient[\"session.ClientSocket = socket\"]\n            CheckOrigin --\u003e|\"Origins.Word\"| RegisterWord[\"session.WordSocket = socket\"]\n        end\n        \n        RegisterClient --\u003e SocketReady[\"Socket Ready for Messages\"]\n        RegisterWord --\u003e SocketReady\n    end\n```\n\nSources: [WebSockets/WebSocketHandler.cs:54-91](), [Services/SessionStorageService.cs:117-146]()\n\n## WebSocket Communication Architecture\n\nThe WebSocket communication system implements a message-based protocol with specific action handlers and error management. The system supports bidirectional communication between web clients and Microsoft Word applications.\n\n### WebSocket Message Processing Flow\n\n```mermaid\ngraph TB\n    subgraph \"WebSocketHandler.HandleAsync() Flow\"\n        ReceiveMessage[\"ReceiveMessageAsync()\"] --\u003e ParseMessage[\"JsonSerializer.Deserialize\u003cSocketMessageRequest\u003e()\"]\n        ParseMessage --\u003e ValidateSession[\"_storage.Get(message.SessionId)\"]\n        ValidateSession --\u003e ValidateToken[\"_tokenValidationService.IsTokenValid()\"]\n        ValidateToken --\u003e RegisterSocket[\"_storage.TryRegisterSocket()\"]\n        \n        RegisterSocket --\u003e MessageLoop[\"Message Processing Loop\"]\n        \n        subgraph \"Message Loop\"\n            ReceiveNext[\"Receive Next Message\"] --\u003e CheckSession{\"Session Exists?\"}\n            CheckSession --\u003e|No| SendSessionExpired[\"Send SessionExpiredOrRemoved Error\"]\n            CheckSession --\u003e|Yes| CheckAuth{\"Socket Authenticated?\"}\n            CheckAuth --\u003e|No| SendAuthError[\"Send SocketNotAuthenticated Error\"]\n            CheckAuth --\u003e|Yes| RouteAction[\"Route to Action Handler\"]\n            \n            subgraph \"Action Handlers\"\n                RouteAction --\u003e HandleUpdate[\"HandleUpdate(WebSocketActions.UpdateOoxml)\"]\n                RouteAction --\u003e HandleGet[\"HandleGet(WebSocketActions.GetHtml)\"]\n                RouteAction --\u003e HandleEnd[\"HandleEnd(WebSocketActions.EndSession)\"]\n            end\n        end\n    end\n    \n    HandleUpdate --\u003e ConvertOOXML[\"_conversionService.ConvertOoxmlToHtml()\"]\n    ConvertOOXML --\u003e SaveHtml[\"_storage.SaveOrUpdate(sessionId, html)\"]\n    SaveHtml --\u003e BroadcastUpdate[\"Broadcast to GetActiveSockets()\"]\n    \n    HandleGet --\u003e RetrieveHtml[\"session.Html\"]\n    RetrieveHtml --\u003e SendResponse[\"Send SocketMessageResponse\"]\n    \n    HandleEnd --\u003e CleanupSession[\"_storage.RemoveSession()\"]\n    CleanupSession --\u003e NotifyClients[\"Broadcast EndSession to all sockets\"]\n```\n\nSources: [WebSockets/WebSocketHandler.cs:54-152](), [WebSockets/WebSocketHandler.cs:154-192](), [WebSockets/WebSocketHandler.cs:194-218](), [WebSockets/WebSocketHandler.cs:220-241]()\n\n### WebSocket Protocol Message Types\n\n| Message Type | Action | Direction | Purpose |\n|--------------|--------|-----------|---------|\n| `SocketMessageRequest` | `WebSocketActions.UpdateOoxml` | Word → Server | Send OOXML content for conversion |\n| `SocketMessageRequest` | `WebSocketActions.GetHtml` | Client → Server | Request current HTML content |\n| `SocketMessageRequest` | `WebSocketActions.EndSession` | Any → Server | Terminate session |\n| `SocketMessageResponse` | `WebSocketActions.GetHtml` | Server → Client | Broadcast HTML updates |\n| `SocketMessageError` | Various | Server → Client | Error notifications with error codes |\n\nSources: [WebSockets/WebSocketHandler.cs:27-32]()\n\n## Document Conversion Architecture\n\nThe document conversion system leverages Aspose.Words as the core engine with custom HTML processing and session integration. The system supports multiple conversion workflows including synchronous HTTP conversion and asynchronous WebSocket-based conversion.\n\n### Conversion Service Implementation\n\n```mermaid\ngraph TB\n    subgraph \"ConversionService Core Methods\"\n        ConvertHtmlToDocx[\"ConvertHtmlToDocx(htmlContent)\"]\n        ConvertDocxToHtml[\"ConvertDocxToHtml(docxFile)\"]\n        GenerateWordLaunchLink[\"GenerateWordLaunchLink(token, htmlContent)\"]\n        ConvertOoxmlToHtml[\"ConvertOoxmlToHtml(ooxmlContent)\"]\n    end\n    \n    subgraph \"Aspose.Words Integration\"\n        Document[\"new Document(stream, loadOptions)\"]\n        LoadOptions[\"LoadOptions { LoadFormat, Encoding }\"]\n        SaveOptions[\"HtmlSaveOptions { ExportImagesAsBase64, PrettyFormat }\"]\n        SaveFormat[\"SaveFormat.Docx / SaveFormat.Html\"]\n    end\n    \n    subgraph \"Session Integration\"\n        CreateSession[\"_storage.CreateSession(userId, htmlContent)\"]\n        EmbedProperties[\"document.CustomDocumentProperties.Add()\"]\n        SetWordFilePath[\"_storage.SetWordFilePath(sessionId, filePath)\"]\n    end\n    \n    subgraph \"File Management\"\n        TempFilesFolderPath[\"_configuration['TempFilesFolderPath']\"]\n        PublicHostingFolderUrl[\"_configuration['PublicHostingFolderUrl']\"]\n        WordLaunchUrl[\"ms-word:ofe|u|{publicUrl}\"]\n    end\n    \n    ConvertHtmlToDocx --\u003e Document\n    ConvertHtmlToDocx --\u003e LoadOptions\n    ConvertHtmlToDocx --\u003e SaveFormat\n    \n    ConvertDocxToHtml --\u003e Document\n    ConvertDocxToHtml --\u003e SaveOptions\n    ConvertDocxToHtml --\u003e HtmlService[\"_htmlService.ExtractBodyInnerHtml()\"]\n    \n    GenerateWordLaunchLink --\u003e CreateSession\n    GenerateWordLaunchLink --\u003e Document\n    GenerateWordLaunchLink --\u003e EmbedProperties\n    GenerateWordLaunchLink --\u003e SetWordFilePath\n    GenerateWordLaunchLink --\u003e WordLaunchUrl\n    \n    ConvertOoxmlToHtml --\u003e Document\n    ConvertOoxmlToHtml --\u003e SaveOptions\n    ConvertOoxmlToHtml --\u003e HtmlService\n```\n\nSources: [Services/ConversionService.cs:41-74](), [Services/ConversionService.cs:79-132](), [Services/ConversionService.cs:138-181](), [Services/ConversionService.cs:183-222]()\n\n### Aspose.Words Configuration and Licensing\n\nThe system requires proper Aspose.Words licensing configuration during application startup. The license path is configured through `appsettings.json` and validated at startup.\n\n```mermaid\ngraph LR\n    AppStartup[\"Application Startup\"] --\u003e ReadConfig[\"Configuration['Aspose:LicensePath']\"]\n    ReadConfig --\u003e CheckFile{\"File.Exists(licensePath)?\"}\n    CheckFile --\u003e|Yes| SetLicense[\"new Aspose.Words.License().SetLicense(licensePath)\"]\n    CheckFile --\u003e|No| LogError[\"Console.WriteLine('License path missing')\"]\n    SetLicense --\u003e EnabledConversion[\"Full Aspose.Words Features\"]\n    LogError --\u003e LimitedConversion[\"Limited/Trial Mode\"]\n```\n\nSources: [Program.cs:76-88]()\n\n## Background Services Architecture\n\nThe system includes background services for maintenance tasks, specifically session cleanup to prevent resource leaks and manage expired sessions.\n\n### Session Cleanup Service\n\n```mermaid\ngraph TB\n    subgraph \"SessionCleanupService\"\n        HostedService[\"IHostedService Implementation\"]\n        ExecuteAsync[\"ExecuteAsync(CancellationToken)\"]\n        Timer[\"Periodic Timer (configurable interval)\"]\n    end\n    \n    subgraph \"Cleanup Logic\"\n        CleanupCall[\"CleanupExpiredSessionsAndReturnSocketsToClose()\"]\n        CheckExpiration[\"Check LastUserInteraction vs SessionTTLMinutes\"]\n        CheckMaxLifetime[\"Check CreatedAt vs MaxSessionLifetimeMinutes\"]\n        CollectSockets[\"Collect WebSockets to Close\"]\n        RemoveSessions[\"RemoveSession() for expired sessions\"]\n        DeleteFiles[\"Delete WordFilePath files\"]\n    end\n    \n    Timer --\u003e CleanupCall\n    CleanupCall --\u003e CheckExpiration\n    CleanupCall --\u003e CheckMaxLifetime\n    CheckExpiration --\u003e CollectSockets\n    CheckMaxLifetime --\u003e CollectSockets\n    CollectSockets --\u003e RemoveSessions\n    RemoveSessions --\u003e DeleteFiles\n```\n\nSources: [Services/SessionStorageService.cs:181-208](), [Program.cs:21]()\n\n## External Dependencies and Configuration\n\nThe system integrates with several external dependencies that require specific configuration and initialization patterns.\n\n### Configuration Architecture\n\n| Configuration Section | Purpose | Used By |\n|----------------------|---------|---------|\n| `AllowedOrigins` | CORS policy configuration | Startup pipeline |\n| `Aspose:LicensePath` | Aspose.Words license file path | License initialization |\n| `TempFilesFolderPath` | Temporary file storage location | ConversionService |\n| `PublicHostingFolderUrl` | Public URL for Word launch links | ConversionService |\n| `SessionTTLMinutes` | Session inactivity timeout | SessionStorageService |\n| `MaxSessionLifetimeMinutes` | Maximum session duration | SessionStorageService |\n| `MaxSessions` | Per-user session limit | SessionStorageService |\n\nSources: [Program.cs:28](), [Program.cs:77](), [Services/ConversionService.cs:31-32](), [Services/SessionStorageService.cs:22-24]()"])</script><script>self.__next_f.push([1,"1a:T210e,"])</script><script>self.__next_f.push([1,"# HTTP API Reference\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Controllers/ConversionController.cs](Controllers/ConversionController.cs)\n- [Controllers/EditInWordController.cs](Controllers/EditInWordController.cs)\n\n\u003c/details\u003e\n\n\n\nThis document provides comprehensive reference documentation for the HTTP REST API endpoints exposed by the IstgHtmlDocxConvertService. The service provides two main API categories: document conversion between HTML and DOCX formats, and Word integration for editing HTML content in Microsoft Word.\n\nFor real-time communication features and WebSocket protocols, see [Real-time Communication](#5). For detailed service implementation details, see [Core Services](#4).\n\n## API Architecture Overview\n\nThe HTTP API consists of two primary controllers that handle different aspects of document processing and Word integration.\n\n### API Controller Structure\n\n```mermaid\ngraph TB\n    subgraph \"HTTP API Endpoints\"\n        ConversionAPI[ConversionController\u003cbr/\u003e\"/api/convert\"]\n        EditInWordAPI[EditInWordController\u003cbr/\u003e\"/edit-in-word\"]\n    end\n    \n    subgraph \"ConversionController Endpoints\"\n        HtmlToDocx[\"POST /api/convert/html-docx\u003cbr/\u003eConvert HTML to DOCX\"]\n        DocxToHtml[\"POST /api/convert/docx-html\u003cbr/\u003eConvert DOCX to HTML\"]\n    end\n    \n    subgraph \"EditInWordController Endpoints\"\n        GenerateLink[\"POST /edit-in-word/generate-word-launch-link\u003cbr/\u003eGenerate Word Launch Link\"]\n    end\n    \n    subgraph \"Core Services\"\n        ConversionService[\"ConversionService\u003cbr/\u003eDocument Processing Logic\"]\n        TokenValidationService[\"TokenValidationService\u003cbr/\u003eAuthentication\"]\n        SessionStorageService[\"SessionStorageService\u003cbr/\u003eSession Management\"]\n    end\n    \n    ConversionAPI --\u003e HtmlToDocx\n    ConversionAPI --\u003e DocxToHtml\n    EditInWordAPI --\u003e GenerateLink\n    \n    HtmlToDocx --\u003e ConversionService\n    DocxToHtml --\u003e ConversionService\n    GenerateLink --\u003e ConversionService\n    GenerateLink --\u003e TokenValidationService\n    GenerateLink --\u003e SessionStorageService\n```\n\n**Sources:** [Controllers/ConversionController.cs:1-80](), [Controllers/EditInWordController.cs:1-56]()\n\n### Request/Response Flow Architecture\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant ConversionController\n    participant EditInWordController\n    participant ConversionService\n    participant TokenValidationService\n    \n    Note over Client,TokenValidationService: Document Conversion Flow\n    Client-\u003e\u003eConversionController: POST /api/convert/html-docx\n    ConversionController-\u003e\u003eConversionService: ConvertHtmlToDocx()\n    ConversionService--\u003e\u003eConversionController: DOCX file or error\n    ConversionController--\u003e\u003eClient: File download or ConversionResponse\n    \n    Client-\u003e\u003eConversionController: POST /api/convert/docx-html\n    ConversionController-\u003e\u003eConversionService: ConvertDocxToHtml()\n    ConversionService--\u003e\u003eConversionController: HTML content or error\n    ConversionController--\u003e\u003eClient: HTML or ConversionResponse\n    \n    Note over Client,TokenValidationService: Word Integration Flow\n    Client-\u003e\u003eEditInWordController: POST /edit-in-word/generate-word-launch-link\n    EditInWordController-\u003e\u003eTokenValidationService: IsTokenValid()\n    TokenValidationService--\u003e\u003eEditInWordController: Validation result\n    EditInWordController-\u003e\u003eConversionService: GenerateWordLaunchLink()\n    ConversionService--\u003e\u003eEditInWordController: Word URL and session ID\n    EditInWordController--\u003e\u003eClient: EditInWordConversionResponse\n```\n\n**Sources:** [Controllers/ConversionController.cs:30-77](), [Controllers/EditInWordController.cs:31-53]()\n\n## Document Conversion API\n\nThe ConversionController provides endpoints for bidirectional conversion between HTML and DOCX formats. All endpoints are located under the `/api/convert` route.\n\n### HTML to DOCX Conversion\n\nConverts HTML content to a downloadable DOCX file.\n\n| Attribute | Value |\n|-----------|-------|\n| **Endpoint** | `POST /api/convert/html-docx` |\n| **Controller** | ConversionController |\n| **Method** | HtmlToDocx |\n| **Authentication** | None required |\n\n#### Request Format\n\n```json\n{\n  \"html\": \"string (required)\"\n}\n```\n\nThe request must contain valid HTML content in the `html` field. Empty or null HTML content will result in a validation error.\n\n#### Response Formats\n\n**Success Response:** Returns a DOCX file for download with appropriate content headers.\n\n**Error Response:**\n```json\n{\n  \"Success\": false,\n  \"Message\": \"string\"\n}\n```\n\n#### Implementation Details\n\nThe endpoint validates that HTML content is not null or empty before processing. The conversion is handled asynchronously by the `ConversionService.ConvertHtmlToDocx()` method.\n\n**Sources:** [Controllers/ConversionController.cs:24-43]()\n\n### DOCX to HTML Conversion\n\nConverts an uploaded DOCX file to HTML content.\n\n| Attribute | Value |\n|-----------|-------|\n| **Endpoint** | `POST /api/convert/docx-html` |\n| **Controller** | ConversionController |\n| **Method** | DocxToHtml |\n| **Content Type** | `multipart/form-data` |\n| **Authentication** | None required |\n\n#### Request Format\n\nThe request must be sent as `multipart/form-data` with a file field containing the DOCX document.\n\n**Form Fields:**\n- `file`: DOCX file (required)\n\n#### Response Formats\n\n**Success Response:** Returns HTML content as text.\n\n**Error Response:**\n```json\n{\n  \"Success\": false,\n  \"Message\": \"string\"\n}\n```\n\n#### Implementation Details\n\nThe endpoint validates that a file is provided and has content before processing. The file is read into a byte array and passed to `ConversionService.ConvertDocxToHtml()` for processing.\n\n**Sources:** [Controllers/ConversionController.cs:50-77]()\n\n## Word Integration API\n\nThe EditInWordController provides functionality for editing HTML content in Microsoft Word through generated launch links. All endpoints require authentication via token headers.\n\n### Generate Word Launch Link\n\nCreates a Microsoft Word launch link for editing HTML content, with session management for real-time collaboration.\n\n| Attribute | Value |\n|-----------|-------|\n| **Endpoint** | `POST /edit-in-word/generate-word-launch-link` |\n| **Controller** | EditInWordController |\n| **Method** | OpenInWordHtmlDocx |\n| **Authentication** | Required (token header) |\n\n#### Request Format\n\n**Headers:**\n- `token`: Authentication token (required)\n\n**Body:**\n```json\n{\n  \"Html\": \"string (required)\"\n}\n```\n\n#### Response Formats\n\n**Success Response:**\n```json\n{\n  \"Success\": true,\n  \"Message\": \"Word link generated successfully.\",\n  \"sessionId\": \"string\",\n  \"WordUrl\": \"string\"\n}\n```\n\n**Error Responses:**\n\n*Authentication Error:* HTTP 401 Unauthorized\n\n*Validation Error:*\n```json\n{\n  \"ErrorCode\": \"string\",\n  \"Success\": false,\n  \"Message\": \"string\"\n}\n```\n\n#### Implementation Details\n\nThe endpoint performs several validation steps:\n\n1. **Token Validation:** Uses `TokenValidationService.IsTokenValid()` to authenticate the request\n2. **HTML Processing:** Converts HTML to DOCX and generates a Word launch URL\n3. **Session Management:** Creates or manages session for real-time collaboration\n4. **Error Handling:** Returns specific error codes for different failure scenarios\n\nThe Word launch URL follows the `ms-word://` protocol scheme to open Microsoft Word directly with the converted document.\n\n**Sources:** [Controllers/EditInWordController.cs:24-53]()\n\n## Authentication and Error Handling\n\n### Authentication Requirements\n\n| Endpoint | Authentication Required |\n|----------|------------------------|\n| `/api/convert/*` | No |\n| `/edit-in-word/*` | Yes (token header) |\n\n### Common Error Codes\n\nThe API uses structured error responses with specific error codes defined in the `HttpErrorCodes` system. Common error scenarios include:\n\n- **Authentication failures:** HTTP 401 for invalid tokens\n- **Validation errors:** HTTP 400 for missing or invalid request data  \n- **Processing errors:** Specific error codes for conversion failures\n\nFor detailed error code documentation, see [HTTP Error Codes](#6.1).\n\n### Response Models\n\nThe API uses consistent response models for different endpoint types:\n\n- **ConversionResponse:** Used for conversion endpoints\n- **EditInWordConversionResponse:** Used for Word integration endpoints\n- **EditInWordConversionError:** Used for Word integration error responses\n\n**Sources:** [Controllers/ConversionController.cs:34-38](), [Controllers/EditInWordController.cs:41-52]()"])</script><script>self.__next_f.push([1,"1b:T1e4b,"])</script><script>self.__next_f.push([1,"# Document Conversion API\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Controllers/ConversionController.cs](Controllers/ConversionController.cs)\n- [Models/ConversionResponse.cs](Models/ConversionResponse.cs)\n- [Models/DocxHtmlRequest.cs](Models/DocxHtmlRequest.cs)\n- [Models/DocxHtmlResponse.cs](Models/DocxHtmlResponse.cs)\n- [Models/HtmlDocxRequest.cs](Models/HtmlDocxRequest.cs)\n\n\u003c/details\u003e\n\n\n\nThis page documents the REST API endpoints provided by the `ConversionController` for converting documents between HTML and DOCX formats. These endpoints enable bidirectional conversion workflows for document processing.\n\nFor Word integration features that allow launching Microsoft Word with converted documents, see [Word Integration API](#3.2). For details about the underlying conversion services and business logic, see [Document Conversion Services](#4.1).\n\n## API Endpoints Overview\n\nThe `ConversionController` exposes two primary conversion endpoints under the `/api/convert` route prefix. Both endpoints are POST operations that handle different conversion directions and input formats.\n\n### ConversionController Endpoint Structure\n\n```mermaid\ngraph TB\n    subgraph \"ConversionController [/api/convert]\"\n        HtmlToDocxEndpoint[\"POST /html-docx\u003cbr/\u003eHtmlToDocx()\"]\n        DocxToHtmlEndpoint[\"POST /docx-html\u003cbr/\u003eDocxToHtml()\"]\n    end\n    \n    subgraph \"Request Models\"\n        HtmlDocxRequest[\"HtmlDocxRequest\u003cbr/\u003e{html: string}\"]\n        DocxHtmlRequest[\"DocxHtmlRequest\u003cbr/\u003e{file: IFormFile}\"]\n    end\n    \n    subgraph \"Response Models\"\n        ConversionResponse[\"ConversionResponse\u003cbr/\u003e{Success, Message, FileName, FileContent}\"]\n        DocxHtmlResponse[\"DocxHtmlResponse\u003cbr/\u003e{document_language, html}\"]\n    end\n    \n    subgraph \"Core Service\"\n        ConversionService[\"ConversionService\u003cbr/\u003eConvertHtmlToDocx()\u003cbr/\u003eConvertDocxToHtml()\"]\n    end\n    \n    HtmlDocxRequest --\u003e HtmlToDocxEndpoint\n    DocxHtmlRequest --\u003e DocxToHtmlEndpoint\n    \n    HtmlToDocxEndpoint --\u003e ConversionService\n    DocxToHtmlEndpoint --\u003e ConversionService\n    \n    HtmlToDocxEndpoint --\u003e ConversionResponse\n    DocxToHtmlEndpoint --\u003e DocxHtmlResponse\n```\n\n**Sources:** [Controllers/ConversionController.cs:1-80](), [Models/HtmlDocxRequest.cs:1-7](), [Models/DocxHtmlRequest.cs:1-13](), [Models/ConversionResponse.cs:1-10](), [Models/DocxHtmlResponse.cs:1-8]()\n\n## HTML to DOCX Conversion\n\nThe `/api/convert/html-docx` endpoint converts HTML content to a DOCX file format.\n\n### Endpoint Details\n\n| Property | Value |\n|----------|-------|\n| **Route** | `POST /api/convert/html-docx` |\n| **Method** | `HtmlToDocx()` |\n| **Content Type** | `application/json` |\n| **Request Model** | `HtmlDocxRequest` |\n| **Response Model** | `ConversionResponse` |\n\n### Request Format\n\nThe endpoint accepts a JSON payload containing the HTML content to convert:\n\n```json\n{\n  \"html\": \"\u003chtml\u003e\u003cbody\u003e\u003ch1\u003eDocument Title\u003c/h1\u003e\u003cp\u003eContent...\u003c/p\u003e\u003c/body\u003e\u003c/html\u003e\"\n}\n```\n\n### Validation Rules\n\n- The `html` field cannot be null or empty [Controllers/ConversionController.cs:32-39]()\n- Invalid HTML content returns a `BadRequest` response with error details\n\n### Response Behavior\n\nThe endpoint returns an `IActionResult` containing either:\n- **Success**: A file download response with the generated DOCX file\n- **Error**: A `ConversionResponse` object with error details\n\n**Sources:** [Controllers/ConversionController.cs:19-43](), [Models/HtmlDocxRequest.cs:1-7](), [Models/ConversionResponse.cs:1-10]()\n\n## DOCX to HTML Conversion\n\nThe `/api/convert/docx-html` endpoint converts uploaded DOCX files to HTML format.\n\n### Endpoint Details\n\n| Property | Value |\n|----------|-------|\n| **Route** | `POST /api/convert/docx-html` |\n| **Method** | `DocxToHtml()` |\n| **Content Type** | `multipart/form-data` |\n| **Request Model** | `DocxHtmlRequest` |\n| **Response Model** | `DocxHtmlResponse` |\n\n### File Upload Process\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant ConversionController\n    participant MemoryStream\n    participant ConversionService\n    \n    Client-\u003e\u003eConversionController: \"POST /docx-html + DOCX file\"\n    ConversionController-\u003e\u003eConversionController: \"Validate file exists\"\n    ConversionController-\u003e\u003eMemoryStream: \"CopyToAsync(file)\"\n    MemoryStream-\u003e\u003eConversionController: \"byte[] fileContent\"\n    ConversionController-\u003e\u003eConversionService: \"ConvertDocxToHtml(fileContent)\"\n    ConversionService-\u003e\u003eConversionController: \"IActionResult response\"\n    ConversionController-\u003e\u003eClient: \"DocxHtmlResponse or error\"\n```\n\n### Validation Rules\n\n- The `file` field is required and cannot be null [Models/DocxHtmlRequest.cs:11-12]()\n- File length must be greater than 0 [Controllers/ConversionController.cs:59-66]()\n- Invalid file uploads return a `BadRequest` response with error details\n\n### File Processing\n\nThe endpoint processes the uploaded file by:\n1. Reading the file content into a `MemoryStream` [Controllers/ConversionController.cs:69-72]()\n2. Converting the stream to a byte array\n3. Passing the byte array to `ConversionService.ConvertDocxToHtml()` [Controllers/ConversionController.cs:75]()\n\n**Sources:** [Controllers/ConversionController.cs:45-77](), [Models/DocxHtmlRequest.cs:1-13](), [Models/DocxHtmlResponse.cs:1-8]()\n\n## Request and Response Models\n\nThe API uses strongly-typed models for request validation and response formatting.\n\n### Model Relationships\n\n```mermaid\nclassDiagram\n    class HtmlDocxRequest {\n        +string html\n    }\n    \n    class DocxHtmlRequest {\n        +IFormFile file\n        +Required annotation\n    }\n    \n    class ConversionResponse {\n        +bool Success\n        +string Message\n        +string FileName\n        +string FileContent\n    }\n    \n    class DocxHtmlResponse {\n        +string document_language\n        +string html\n    }\n    \n    class ConversionController {\n        +ConversionService _conversionService\n        +HtmlToDocx(HtmlDocxRequest) IActionResult\n        +DocxToHtml(DocxHtmlRequest) IActionResult\n    }\n    \n    HtmlDocxRequest --\u003e ConversionController\n    DocxHtmlRequest --\u003e ConversionController\n    ConversionController --\u003e ConversionResponse\n    ConversionController --\u003e DocxHtmlResponse\n```\n\n### Model Specifications\n\n| Model | Purpose | Key Fields |\n|-------|---------|------------|\n| `HtmlDocxRequest` | HTML to DOCX input | `html` (string) |\n| `DocxHtmlRequest` | DOCX file upload | `file` (IFormFile, Required) |\n| `ConversionResponse` | General API response | `Success`, `Message`, `FileName`, `FileContent` |\n| `DocxHtmlResponse` | DOCX to HTML output | `document_language`, `html` |\n\n**Sources:** [Models/HtmlDocxRequest.cs:1-7](), [Models/DocxHtmlRequest.cs:1-13](), [Models/ConversionResponse.cs:1-10](), [Models/DocxHtmlResponse.cs:1-8]()\n\n## Error Handling\n\nBoth endpoints implement input validation and return structured error responses when validation fails.\n\n### Common Error Scenarios\n\n| Scenario | HTTP Status | Response Format |\n|----------|-------------|-----------------|\n| Empty HTML content | `400 Bad Request` | `ConversionResponse` with error message |\n| Missing DOCX file | `400 Bad Request` | `ConversionResponse` with error message |\n| Zero-length file | `400 Bad Request` | `ConversionResponse` with error message |\n| Conversion failure | Varies | Service-specific error response |\n\n### Error Response Format\n\n```json\n{\n  \"Success\": false,\n  \"Message\": \"HTML content cannot be empty.\",\n  \"FileName\": null,\n  \"FileContent\": null\n}\n```\n\nFor detailed error code specifications and localized error messages, see [HTTP Error Codes](#6.1).\n\n**Sources:** [Controllers/ConversionController.cs:32-39](), [Controllers/ConversionController.cs:59-66](), [Models/ConversionResponse.cs:1-10]()"])</script><script>self.__next_f.push([1,"1c:T2007,"])</script><script>self.__next_f.push([1,"# Word Integration API\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Controllers/EditInWordController.cs](Controllers/EditInWordController.cs)\n- [Models/EditInWordConversionResponse.cs](Models/EditInWordConversionResponse.cs)\n- [Models/OpenInWordHtmlDocxRequest.cs](Models/OpenInWordHtmlDocxRequest.cs)\n\n\u003c/details\u003e\n\n\n\nThis section documents the REST API endpoints provided by `EditInWordController` for integrating HTML content with Microsoft Word. The Word Integration API enables clients to convert HTML content into DOCX files and generate launch links that open the documents directly in Microsoft Word for editing.\n\nThe Word Integration API is part of the broader HTTP API Reference. For document conversion endpoints, see [Document Conversion API](#3.1). For real-time collaboration features during Word editing, see [Real-time Communication](#5).\n\n## Purpose and Scope\n\nThe Word Integration API serves as the entry point for workflows where users need to edit HTML content in Microsoft Word. It handles:\n\n- Converting HTML to DOCX format\n- Generating `ms-word://` protocol launch URLs\n- Creating and managing editing sessions\n- Token-based authentication for secure access\n\nThe API works in conjunction with the WebSocket communication system to enable real-time synchronization between Word and web clients during editing sessions.\n\n## API Endpoint Overview\n\nThe `EditInWordController` provides a single REST endpoint for Word integration workflows:\n\n| Method | Endpoint | Purpose |\n|--------|----------|---------|\n| POST | `/edit-in-word/generate-word-launch-link` | Convert HTML to DOCX and generate Word launch link |\n\nSources: [Controllers/EditInWordController.cs:10-11](), [Controllers/EditInWordController.cs:25]()\n\n## Generate Word Launch Link\n\n### Endpoint Details\n\n**POST** `/edit-in-word/generate-word-launch-link`\n\nConverts provided HTML content into a DOCX file and returns a launch link to open it in Microsoft Word.\n\n### Authentication\n\nRequires a valid authentication token passed in the request header:\n\n```\nHeader: token: \u003cauthentication-token\u003e\n```\n\nToken validation is performed using `TokenValidationService` before processing the request.\n\nSources: [Controllers/EditInWordController.cs:31](), [Controllers/EditInWordController.cs:35-36]()\n\n### Request Model\n\nThe endpoint expects a JSON request body conforming to `OpenInWordHtmlDocxRequest`:\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| `Html` | string | Yes | HTML content to convert to DOCX |\n\n```json\n{\n  \"Html\": \"\u003chtml\u003e\u003cbody\u003e\u003ch1\u003eSample Content\u003c/h1\u003e\u003c/body\u003e\u003c/html\u003e\"\n}\n```\n\nSources: [Models/OpenInWordHtmlDocxRequest.cs:3-7]()\n\n### Response Models\n\n#### Success Response\n\nOn successful conversion, returns `EditInWordConversionResponse`:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `Success` | boolean | Always `true` for success responses |\n| `Message` | string | Human-readable success message |\n| `sessionId` | string | Unique session identifier for tracking |\n| `WordUrl` | string | `ms-word://` protocol URL to launch Word |\n\n```json\n{\n  \"Success\": true,\n  \"Message\": \"Word link generated successfully.\",\n  \"sessionId\": \"unique-session-id\",\n  \"WordUrl\": \"ms-word:ofe|u|file://path/to/document.docx\"\n}\n```\n\nSources: [Models/EditInWordConversionResponse.cs:3-9](), [Controllers/EditInWordController.cs:46-52]()\n\n#### Error Response\n\nOn failure, returns `EditInWordConversionError`:\n\n| Field | Type | Description |\n|-------|------|-------------|\n| `Success` | boolean | Always `false` for error responses |\n| `ErrorCode` | string | Error code from `HttpErrorCodes.Codes` |\n| `Message` | string | Human-readable error description |\n| `sessionId` | string | Session ID if available |\n| `WordUrl` | string | Null for error responses |\n\nSources: [Models/EditInWordConversionResponse.cs:11-18](), [Controllers/EditInWordController.cs:41]()\n\n## API Flow Diagram\n\n### Word Integration Request Flow\n\n```mermaid\nsequenceDiagram\n    participant Client as \"Client Application\"\n    participant Controller as \"EditInWordController\"\n    participant TokenService as \"TokenValidationService\"\n    participant ConversionService as \"ConversionService\"\n    participant SessionStorage as \"SessionStorageService\"\n    participant FileSystem as \"File System\"\n\n    Client-\u003e\u003eController: \"POST /edit-in-word/generate-word-launch-link\"\n    Note over Client,Controller: \"Headers: token, Body: {Html}\"\n    \n    Controller-\u003e\u003eTokenService: \"IsTokenValid(token)\"\n    TokenService--\u003e\u003eController: \"boolean result\"\n    \n    alt Token Invalid\n        Controller--\u003e\u003eClient: \"401 Unauthorized\"\n    else Token Valid\n        Controller-\u003e\u003eConversionService: \"GenerateWordLaunchLink(token, html)\"\n        ConversionService-\u003e\u003eFileSystem: \"Create DOCX file\"\n        ConversionService-\u003e\u003eSessionStorage: \"Create/update session\"\n        ConversionService--\u003e\u003eController: \"(wordUrl, sessionId, error)\"\n        \n        alt Conversion Success\n            Controller--\u003e\u003eClient: \"EditInWordConversionResponse\"\n        else Conversion Error\n            Controller--\u003e\u003eClient: \"EditInWordConversionError\"\n        end\n    end\n```\n\nSources: [Controllers/EditInWordController.cs:31-53]()\n\n## Component Integration Diagram\n\n### EditInWordController Dependencies\n\n```mermaid\ngraph TB\n    subgraph \"HTTP Layer\"\n        Client[\"Client Request\"]\n        EditInWordController[\"EditInWordController\"]\n    end\n    \n    subgraph \"Service Layer\"\n        ConversionService[\"ConversionService\"]\n        TokenValidationService[\"TokenValidationService\"]\n        SessionStorageService[\"SessionStorageService\"]\n    end\n    \n    subgraph \"Models\"\n        OpenInWordRequest[\"OpenInWordHtmlDocxRequest\"]\n        EditInWordResponse[\"EditInWordConversionResponse\"]\n        EditInWordError[\"EditInWordConversionError\"]\n    end\n    \n    subgraph \"External Systems\"\n        AsposeWords[\"Aspose.Words\"]\n        Database[(\"SQL Database\")]\n        FileSystem[(\"File System\")]\n        WordApp[\"Microsoft Word\"]\n    end\n    \n    Client --\u003e EditInWordController\n    EditInWordController --\u003e OpenInWordRequest\n    EditInWordController --\u003e TokenValidationService\n    EditInWordController --\u003e ConversionService\n    \n    ConversionService --\u003e SessionStorageService\n    ConversionService --\u003e AsposeWords\n    ConversionService --\u003e FileSystem\n    \n    TokenValidationService --\u003e Database\n    \n    EditInWordController --\u003e EditInWordResponse\n    EditInWordController --\u003e EditInWordError\n    \n    EditInWordResponse --\u003e WordApp\n```\n\nSources: [Controllers/EditInWordController.cs:13-21](), [Controllers/EditInWordController.cs:17]()\n\n## Error Handling\n\nThe Word Integration API uses structured error responses with specific error codes:\n\n### Common Error Scenarios\n\n| Scenario | HTTP Status | Error Code | Description |\n|----------|-------------|------------|-------------|\n| Invalid token | 401 | N/A | Token validation failed |\n| Session creation failed | 400 | `NewSessionIsNotAllowed` | Unable to create new session |\n| Missing session ID | 400 | `InvalidRequest` | Session ID is required but not provided |\n\n### Error Code Integration\n\nError codes are sourced from `HttpErrorCodes.Codes` and returned in the `ErrorCode` field of error responses. For comprehensive error code documentation, see [HTTP Error Codes](#6.1).\n\nSources: [Controllers/EditInWordController.cs:41](), [Controllers/EditInWordController.cs:44]()\n\n## Integration with Core Services\n\nThe `EditInWordController` orchestrates multiple core services:\n\n### ConversionService Integration\n\n- Delegates HTML to DOCX conversion logic\n- Handles file creation and session management\n- Returns Word launch URLs and session identifiers\n\n### TokenValidationService Integration\n\n- Validates authentication tokens before processing\n- Ensures secure access to Word integration features\n\n### SessionStorageService Integration\n\n- Manages session lifecycle for Word editing workflows\n- Stores session data for real-time collaboration features\n\nFor detailed information about these services, see [Core Services](#4).\n\nSources: [Controllers/EditInWordController.cs:13-15](), [Controllers/EditInWordController.cs:38]()"])</script><script>self.__next_f.push([1,"1d:T2af6,"])</script><script>self.__next_f.push([1,"# Core Services\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Services/ConversionService.cs](Services/ConversionService.cs)\n- [Services/SessionStorageService.cs](Services/SessionStorageService.cs)\n- [Services/TokenValidationService.cs](Services/TokenValidationService.cs)\n\n\u003c/details\u003e\n\n\n\nCore Services represent the business logic layer of the IstgHtmlDocxConvertService, providing the fundamental operations for document conversion, session management, and authentication. These services are injected into controllers and WebSocket handlers to enable both HTTP API endpoints and real-time communication features.\n\nThis page covers the three primary service classes that form the backbone of the system. For information about HTTP API endpoints that use these services, see [HTTP API Reference](#3). For details about WebSocket communication that relies on these services, see [Real-time Communication](#5).\n\n## Service Architecture Overview\n\nThe core services work together to provide a complete document collaboration platform. The following diagram shows the relationships between services and their primary responsibilities:\n\n**Core Services Architecture**\n```mermaid\ngraph TB\n    subgraph \"Core Services Layer\"\n        ConversionService[\"ConversionService\u003cbr/\u003eDocument Processing\"]\n        SessionStorageService[\"SessionStorageService\u003cbr/\u003eSession Management\"]  \n        TokenValidationService[\"TokenValidationService\u003cbr/\u003eUser Authentication\"]\n        HtmlService[\"HtmlService\u003cbr/\u003eHTML Processing\"]\n    end\n    \n    subgraph \"External Dependencies\"\n        AsposeWords[\"Aspose.Words\u003cbr/\u003eDocument Engine\"]\n        SqlDatabase[\"SQL Database\u003cbr/\u003etbrPersonnel\"]\n        FileSystem[\"File System\u003cbr/\u003eTemporary Storage\"]\n        WindowsRegistry[\"Windows Registry\u003cbr/\u003eConnection Strings\"]\n    end\n    \n    subgraph \"Consuming Layers\"\n        Controllers[\"HTTP Controllers\"]\n        WebSocketHandler[\"WebSocketHandler\"]\n    end\n    \n    Controllers --\u003e ConversionService\n    Controllers --\u003e TokenValidationService\n    WebSocketHandler --\u003e ConversionService\n    WebSocketHandler --\u003e SessionStorageService\n    WebSocketHandler --\u003e TokenValidationService\n    \n    ConversionService --\u003e HtmlService\n    ConversionService --\u003e SessionStorageService\n    ConversionService --\u003e AsposeWords\n    ConversionService --\u003e FileSystem\n    \n    SessionStorageService --\u003e FileSystem\n    TokenValidationService --\u003e SqlDatabase\n    TokenValidationService --\u003e WindowsRegistry\n```\n\nSources: [Services/ConversionService.cs:1-230](), [Services/SessionStorageService.cs:1-241](), [Services/TokenValidationService.cs:1-46]()\n\n## Service Dependencies and Injection\n\nAll core services are configured through dependency injection and rely on common infrastructure components. The following diagram maps the dependency injection relationships to actual code entities:\n\n**Dependency Injection Mapping**\n```mermaid\ngraph LR\n    subgraph \"Configuration Sources\"\n        IConfiguration[\"IConfiguration\"]\n        Registry[\"ConnectionStringManager\"]\n    end\n    \n    subgraph \"Logging Infrastructure\"\n        SystemEventLogger[\"SystemEventLogger\"]\n    end\n    \n    subgraph \"Service Constructors\"\n        ConversionServiceCtor[\"ConversionService\u003cbr/\u003eConstructor\"]\n        SessionStorageServiceCtor[\"SessionStorageService\u003cbr/\u003eConstructor\"] \n        TokenValidationServiceCtor[\"TokenValidationService\u003cbr/\u003eConstructor\"]\n    end\n    \n    subgraph \"Injected Dependencies\"\n        HtmlServiceDep[\"HtmlService\"]\n        SessionStorageDep[\"SessionStorageService\"]\n        TokenValidationDep[\"TokenValidationService\"]\n    end\n    \n    IConfiguration --\u003e ConversionServiceCtor\n    IConfiguration --\u003e SessionStorageServiceCtor\n    IConfiguration --\u003e TokenValidationServiceCtor\n    \n    SystemEventLogger --\u003e ConversionServiceCtor\n    SystemEventLogger --\u003e SessionStorageServiceCtor\n    SystemEventLogger --\u003e TokenValidationServiceCtor\n    \n    HtmlServiceDep --\u003e ConversionServiceCtor\n    SessionStorageDep --\u003e ConversionServiceCtor\n    TokenValidationDep --\u003e ConversionServiceCtor\n    \n    Registry --\u003e TokenValidationServiceCtor\n```\n\nSources: [Services/ConversionService.cs:24-36](), [Services/SessionStorageService.cs:18-26](), [Services/TokenValidationService.cs:11-16]()\n\n## ConversionService\n\nThe `ConversionService` class handles all document format conversions using the Aspose.Words library. It provides methods for converting between HTML and DOCX formats, generating Word launch links, and processing OOXML content from Word applications.\n\n### Key Methods\n\n| Method | Purpose | Return Type |\n|--------|---------|-------------|\n| `ConvertHtmlToDocx` | Converts HTML content to downloadable DOCX file | `IActionResult` |\n| `ConvertDocxToHtml` | Converts uploaded DOCX file to HTML content | `IActionResult` |\n| `GenerateWordLaunchLink` | Creates DOCX file with embedded session data and returns `ms-word://` URL | `(string?, string?, string?)` |\n| `ConvertOoxmlToHtml` | Processes OOXML from Word and converts to HTML | `(string?, string?)` |\n\n### Configuration Dependencies\n\nThe service requires several configuration values that are injected during construction:\n\n- `TempFilesFolderPath`: Directory for storing temporary DOCX files\n- `PublicHostingFolderUrl`: Base URL for publicly accessible files used in Word launch links\n\nSources: [Services/ConversionService.cs:31-32]()\n\n### Document Processing Flow\n\n**ConversionService Method Flow**\n```mermaid\nflowchart TD\n    HTMLInput[\"HTML Content Input\"]\n    DOCXInput[\"DOCX File Input\"] \n    OOXMLInput[\"OOXML Content Input\"]\n    \n    ConvertHtmlToDocx[\"ConvertHtmlToDocx()\"]\n    ConvertDocxToHtml[\"ConvertDocxToHtml()\"]\n    ConvertOoxmlToHtml[\"ConvertOoxmlToHtml()\"]\n    GenerateWordLaunchLink[\"GenerateWordLaunchLink()\"]\n    \n    AsposeDocument[\"new Document()\"]\n    AsposeLoadOptions[\"LoadOptions\"]\n    AsposeSaveOptions[\"HtmlSaveOptions\"]\n    \n    HTMLInput --\u003e ConvertHtmlToDocx\n    HTMLInput --\u003e GenerateWordLaunchLink\n    DOCXInput --\u003e ConvertDocxToHtml\n    OOXMLInput --\u003e ConvertOoxmlToHtml\n    \n    ConvertHtmlToDocx --\u003e AsposeLoadOptions\n    ConvertDocxToHtml --\u003e AsposeDocument\n    ConvertOoxmlToHtml --\u003e AsposeLoadOptions\n    GenerateWordLaunchLink --\u003e AsposeLoadOptions\n    \n    AsposeLoadOptions --\u003e AsposeDocument\n    AsposeDocument --\u003e AsposeSaveOptions\n    \n    ConvertHtmlToDocx --\u003e FileContentResult[\"FileContentResult\u003cbr/\u003eDOCX Download\"]\n    ConvertDocxToHtml --\u003e DocxHtmlResponse[\"DocxHtmlResponse\u003cbr/\u003eHTML + Language\"]\n    ConvertOoxmlToHtml --\u003e HTMLOutput[\"HTML String\"]\n    GenerateWordLaunchLink --\u003e WordURL[\"ms-word:// URL\"]\n```\n\nSources: [Services/ConversionService.cs:41-74](), [Services/ConversionService.cs:79-132](), [Services/ConversionService.cs:138-181](), [Services/ConversionService.cs:183-222]()\n\n## SessionStorageService\n\nThe `SessionStorageService` manages user sessions using a thread-safe `ConcurrentDictionary\u003cstring, HtmlSession\u003e` for in-memory storage. Each session tracks HTML content, WebSocket connections, file paths, and timing information.\n\n### Session Data Structure\n\nThe service stores `HtmlSession` objects containing:\n\n| Property | Type | Purpose |\n|----------|------|---------|\n| `UserId` | `string` | User identifier from token |\n| `SessionId` | `string` | Unique session identifier |\n| `Html` | `string` | Current HTML content |\n| `ClientSocket` | `WebSocket` | Browser WebSocket connection |\n| `WordSocket` | `WebSocket` | Word application WebSocket connection |\n| `WordFilePath` | `string` | Path to temporary DOCX file |\n| `CreatedAt` | `DateTime` | Session creation timestamp |\n| `LastUpdated` | `DateTime` | Last content update timestamp |\n| `LastUserInteraction` | `DateTime` | Last user activity timestamp |\n\n### Configuration Parameters\n\n| Setting | Default | Purpose |\n|---------|---------|---------|\n| `SessionTTLMinutes` | 30 | Session timeout for inactivity |\n| `MaxSessionLifetimeMinutes` | 120 | Absolute session lifetime limit |\n| `MaxSessions` | 2 | Maximum sessions per user |\n\nSources: [Services/SessionStorageService.cs:22-25]()\n\n### Session Lifecycle Management\n\n**Session Storage Operations**\n```mermaid\nstateDiagram-v2\n    [*] --\u003e Creating\n    Creating --\u003e Active : CreateSession()\n    Active --\u003e Active : SaveOrUpdate()\n    Active --\u003e SocketRegistered : TryRegisterSocket()\n    SocketRegistered --\u003e SocketRegistered : TryRegisterSocket()\n    SocketRegistered --\u003e Active : UnregisterSocket()\n    Active --\u003e Expired : Timeout/MaxLifetime\n    SocketRegistered --\u003e Expired : Timeout/MaxLifetime\n    Expired --\u003e [*] : RemoveSession()\n    Active --\u003e [*] : RemoveSession()\n    SocketRegistered --\u003e [*] : RemoveSession()\n    \n    Creating : sessionId = Guid.NewGuid()\n    Active : Html content stored\n    SocketRegistered : WebSocket connections tracked\n    Expired : CleanupExpiredSessions()\n```\n\nSources: [Services/SessionStorageService.cs:27-45](), [Services/SessionStorageService.cs:89-110](), [Services/SessionStorageService.cs:181-208]()\n\n## TokenValidationService\n\nThe `TokenValidationService` provides user authentication by validating tokens against the personnel database. It integrates with the Windows Registry for database connection management.\n\n### Authentication Process\n\nThe service follows this validation flow:\n\n1. **Token Decryption**: `DecryptToken()` processes the encrypted token [Services/TokenValidationService.cs:42-45]()\n2. **Database Query**: Checks `tbrPersonnel` table for user existence [Services/TokenValidationService.cs:27-28]()\n3. **Connection Management**: Uses `ConnectionStringManager` with registry-based configuration [Services/TokenValidationService.cs:14]()\n\n### Database Integration\n\n**Token Validation Flow**\n```mermaid\nsequenceDiagram\n    participant Client\n    participant TokenValidationService\n    participant ConnectionStringManager\n    participant WindowsRegistry\n    participant SqlConnection\n    participant tbrPersonnel\n    \n    Client-\u003e\u003eTokenValidationService: IsTokenValid(token)\n    TokenValidationService-\u003e\u003eTokenValidationService: DecryptToken(token)\n    TokenValidationService-\u003e\u003eConnectionStringManager: GetConnection(IstgRef)\n    ConnectionStringManager-\u003e\u003eWindowsRegistry: Read connection string\n    WindowsRegistry--\u003e\u003eConnectionStringManager: Connection string\n    ConnectionStringManager--\u003e\u003eTokenValidationService: Connection string\n    TokenValidationService-\u003e\u003eSqlConnection: new SqlConnection()\n    TokenValidationService-\u003e\u003etbrPersonnel: SELECT COUNT(*) WHERE prsId = @prsId\n    tbrPersonnel--\u003e\u003eTokenValidationService: Row count\n    TokenValidationService--\u003e\u003eClient: Boolean result\n```\n\nSources: [Services/TokenValidationService.cs:18-39]()\n\n### Error Handling and Logging\n\nThe service implements comprehensive error handling with event logging for authentication failures. All exceptions during token validation are caught and logged through the `SystemEventLogger`, returning `false` for invalid authentication attempts.\n\nSources: [Services/TokenValidationService.cs:34-38]()"])</script><script>self.__next_f.push([1,"1e:T2737,"])</script><script>self.__next_f.push([1,"# Document Conversion Services\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Services/ConversionService.cs](Services/ConversionService.cs)\n- [Services/HtmlService.cs](Services/HtmlService.cs)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nThis document describes the core document conversion services that power the bidirectional conversion between HTML and DOCX formats. The services covered include the `ConversionService` class for document format conversion and the `HtmlService` class for HTML content processing.\n\nFor information about session management during conversions, see [Session Management](#4.2). For details about authentication during conversion requests, see [Authentication Service](#4.3). For WebSocket-based real-time document synchronization, see [Real-time Communication](#5).\n\n## ConversionService Overview\n\nThe `ConversionService` class serves as the primary engine for document format conversion, utilizing the Aspose.Words library to transform documents between HTML and DOCX formats. This service supports three main conversion workflows:\n\n| Conversion Type | Input Format | Output Format | Use Case |\n|---|---|---|---|\n| HTML to DOCX | HTML string | DOCX file download | Document export |\n| DOCX to HTML | DOCX file bytes | HTML string | Document import |\n| HTML to Word Launch | HTML string | ms-word:// URL + session | Live editing workflow |\n\n**Core Dependencies:**\n- `HtmlService` for HTML content processing\n- `SessionStorageService` for session management\n- `TokenValidationService` for authentication\n- `SystemEventLogger` for logging operations\n- Aspose.Words library for document engine functionality\n\nSources: [Services/ConversionService.cs:1-36]()\n\n## Document Conversion Architecture\n\n```mermaid\ngraph TB\n    subgraph \"ConversionService Methods\"\n        ConvertHtmlToDocx[\"ConvertHtmlToDocx()\"]\n        ConvertDocxToHtml[\"ConvertDocxToHtml()\"] \n        GenerateWordLaunchLink[\"GenerateWordLaunchLink()\"]\n        ConvertOoxmlToHtml[\"ConvertOoxmlToHtml()\"]\n    end\n    \n    subgraph \"Aspose.Words Engine\"\n        Document[\"Document\"]\n        LoadOptions[\"LoadOptions\"]\n        HtmlSaveOptions[\"HtmlSaveOptions\"]\n        SaveFormat[\"SaveFormat\"]\n    end\n    \n    subgraph \"Supporting Services\"\n        HtmlService[\"HtmlService.ExtractBodyInnerHtml()\"]\n        SessionStorageService[\"SessionStorageService.CreateSession()\"]\n        TokenValidationService[\"TokenValidationService.DecryptToken()\"]\n        SystemEventLogger[\"SystemEventLogger\"]\n    end\n    \n    subgraph \"External Systems\"\n        TempFilesFolderPath[\"TempFilesFolderPath\"]\n        PublicHostingFolderUrl[\"PublicHostingFolderUrl\"]\n        MSWordApp[\"ms-word:// Protocol\"]\n    end\n    \n    ConvertHtmlToDocx --\u003e Document\n    ConvertDocxToHtml --\u003e Document\n    ConvertDocxToHtml --\u003e HtmlSaveOptions\n    ConvertDocxToHtml --\u003e HtmlService\n    \n    GenerateWordLaunchLink --\u003e Document\n    GenerateWordLaunchLink --\u003e SessionStorageService\n    GenerateWordLaunchLink --\u003e TokenValidationService\n    GenerateWordLaunchLink --\u003e TempFilesFolderPath\n    GenerateWordLaunchLink --\u003e PublicHostingFolderUrl\n    GenerateWordLaunchLink --\u003e MSWordApp\n    \n    ConvertOoxmlToHtml --\u003e Document\n    ConvertOoxmlToHtml --\u003e LoadOptions\n    ConvertOoxmlToHtml --\u003e HtmlSaveOptions\n    ConvertOoxmlToHtml --\u003e HtmlService\n    \n    Document --\u003e SaveFormat\n    \n    ConvertHtmlToDocx --\u003e SystemEventLogger\n    ConvertDocxToHtml --\u003e SystemEventLogger\n    GenerateWordLaunchLink --\u003e SystemEventLogger\n    ConvertOoxmlToHtml --\u003e SystemEventLogger\n```\n\nSources: [Services/ConversionService.cs:41-229]()\n\n## HTML to DOCX Conversion\n\nThe `ConvertHtmlToDocx` method transforms HTML content into a downloadable DOCX file using the following process:\n\n1. **Input Validation**: Validates that HTML content is not null or empty\n2. **Document Loading**: Creates Aspose `Document` with `LoadOptions` configured for HTML format and UTF-8 encoding\n3. **Memory Processing**: Converts HTML string to `MemoryStream` for processing\n4. **DOCX Generation**: Saves document using `SaveFormat.Docx` to output stream\n5. **File Response**: Returns `FileContentResult` with MIME type `application/vnd.openxmlformats-officedocument.wordprocessingml.document`\n\n**Key Configuration:**\n- Default filename: `Document.docx`\n- Encoding: UTF-8 with `CodePagesEncodingProvider.Instance` registration\n- Asynchronous processing using `Task.Run()`\n\nSources: [Services/ConversionService.cs:41-74]()\n\n## DOCX to HTML Conversion\n\nThe `ConvertDocxToHtml` method processes uploaded DOCX files and returns structured HTML content:\n\n1. **File Validation**: Ensures DOCX byte array is valid and non-empty\n2. **Document Loading**: Creates Aspose `Document` from DOCX stream\n3. **HTML Options Configuration**: Uses `HtmlSaveOptions` with:\n   - `ExportImagesAsBase64 = true` for embedded images\n   - `ExportHeadersFootersMode = PerSection` for complete document structure\n   - `PrettyFormat = true` for readable output\n4. **Content Processing**: Extracts body content using `HtmlService.ExtractBodyInnerHtml()`\n5. **Response Format**: Returns `DocxHtmlResponse` with HTML content and language metadata\n\n**Response Structure:**\n```csharp\n{\n    \"html\": \"extracted_body_content\",\n    \"document_language\": \"fa-IR\"\n}\n```\n\nSources: [Services/ConversionService.cs:79-132]()\n\n## Word Launch Link Generation\n\nThe `GenerateWordLaunchLink` method creates a complete workflow for editing HTML content in Microsoft Word:\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant ConversionService\n    participant TokenValidationService\n    participant SessionStorageService\n    participant AsposeDocument\n    participant FileSystem\n    \n    Client-\u003e\u003eConversionService: \"GenerateWordLaunchLink(token, htmlContent)\"\n    ConversionService-\u003e\u003eTokenValidationService: \"DecryptToken(token)\"\n    TokenValidationService--\u003e\u003eConversionService: \"userId\"\n    ConversionService-\u003e\u003eSessionStorageService: \"CreateSession(userId, htmlContent)\"\n    SessionStorageService--\u003e\u003eConversionService: \"sessionId\"\n    \n    ConversionService-\u003e\u003eAsposeDocument: \"Load HTML with LoadOptions\"\n    ConversionService-\u003e\u003eAsposeDocument: \"Add CustomDocumentProperties(sessionId, token)\"\n    ConversionService-\u003e\u003eFileSystem: \"Save to TempFilesFolderPath\"\n    ConversionService-\u003e\u003eSessionStorageService: \"SetWordFilePath(sessionId, filePath)\"\n    \n    ConversionService--\u003e\u003eClient: \"ms-word:ofe|u|{publicUrl}, sessionId\"\n```\n\n**Process Steps:**\n1. **Authentication**: Decrypts token to extract user ID\n2. **Session Creation**: Generates new session with HTML content\n3. **Document Preparation**: Embeds `sessionId` and `token` as custom document properties\n4. **File Storage**: Saves DOCX to configured `TempFilesFolderPath` with GUID filename\n5. **URL Construction**: Creates `ms-word:ofe|u|{publicUrl}` launch link\n\n**Configuration Dependencies:**\n- `TempFilesFolderPath`: Local storage path for temporary DOCX files\n- `PublicHostingFolderUrl`: Base URL for publicly accessible files\n\nSources: [Services/ConversionService.cs:138-181]()\n\n## OOXML to HTML Conversion\n\nThe `ConvertOoxmlToHtml` method handles real-time document updates from Microsoft Word by processing OOXML (Office Open XML) content:\n\n**Processing Configuration:**\n- **Load Format**: `LoadFormat.FlatOpc` for OOXML content\n- **HTML Options**: Optimized for real-time updates with:\n  - `MemoryOptimization = true`\n  - `ImageResolution = 300`\n  - `ExportImagesAsBase64 = true`\n  - `UseAntiAliasing = true`\n\n**Usage Context**: This method is primarily used by WebSocket handlers to convert Word document changes into HTML for browser synchronization.\n\nSources: [Services/ConversionService.cs:183-222]()\n\n## HtmlService\n\nThe `HtmlService` class provides specialized HTML content processing functionality, focusing on extracting meaningful content from full HTML documents.\n\n### ExtractBodyInnerHtml Method\n\nThe core method `ExtractBodyInnerHtml` performs surgical extraction of content from the HTML `\u003cbody\u003e` element:\n\n```mermaid\nflowchart TD\n    Input[\"HTML Content\"] --\u003e CheckEmpty{\"Is content empty?\"}\n    CheckEmpty --\u003e|Yes| ReturnEmpty[\"Return empty string\"]\n    CheckEmpty --\u003e|No| FindBody[\"Find '\u003cbody' tag\"]\n    \n    FindBody --\u003e BodyExists{\"Body tag found?\"}\n    BodyExists --\u003e|No| ReturnFull[\"Return full content\"]\n    BodyExists --\u003e|Yes| FindBodyEnd[\"Find '\u003e' after body tag\"]\n    \n    FindBodyEnd --\u003e FindBodyClose[\"Find '\u003c/body\u003e' tag\"]\n    FindBodyClose --\u003e ValidStructure{\"Valid body structure?\"}\n    ValidStructure --\u003e|No| ReturnFull\n    ValidStructure --\u003e|Yes| ExtractInner[\"Extract inner content\"]\n    \n    ExtractInner --\u003e TrimContent[\"Trim whitespace\"]\n    TrimContent --\u003e ReturnInner[\"Return body inner HTML\"]\n```\n\n**Algorithm Details:**\n1. **Case-Insensitive Search**: Converts to lowercase for tag detection\n2. **Boundary Detection**: Locates opening `\u003e` and closing `\u003c/body\u003e` positions\n3. **Content Extraction**: Uses `Substring()` to extract content between boundaries\n4. **Whitespace Trimming**: Removes leading/trailing whitespace from result\n\n**Error Handling**: Returns original content if body structure is incomplete or malformed.\n\nSources: [Services/HtmlService.cs:1-34]()\n\n## Integration Points\n\nThe document conversion services integrate with several other system components:\n\n| Service Integration | Purpose | Method Usage |\n|---|---|---|\n| Session Management | Track conversion sessions | `CreateSession()`, `SetWordFilePath()` |\n| Authentication | Validate user tokens | `DecryptToken()` |\n| WebSocket Communication | Real-time document sync | `ConvertOoxmlToHtml()` |\n| Error Handling | Log conversion events | `SystemEventLogger` methods |\n| File System | Temporary file storage | Configuration-based paths |\n\n**Configuration Requirements:**\n- `TempFilesFolderPath`: Directory for temporary DOCX files\n- `PublicHostingFolderUrl`: Base URL for file access\n- Aspose.Words licensing and encoding providers\n\nSources: [Services/ConversionService.cs:24-36](), [Services/HtmlService.cs:1-34]()"])</script><script>self.__next_f.push([1,"1f:T2ba5,"])</script><script>self.__next_f.push([1,"# Session Management\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Models/HtmlSession.cs](Models/HtmlSession.cs)\n- [Services/SessionCleanupService.cs](Services/SessionCleanupService.cs)\n- [Services/SessionStorageService.cs](Services/SessionStorageService.cs)\n\n\u003c/details\u003e\n\n\n\nThis section covers the session management system that tracks user sessions, stores HTML content, manages WebSocket connections, and handles session lifecycle including automatic cleanup. The session management system enables real-time collaboration between web clients and Microsoft Word applications by maintaining session state and managing associated resources.\n\nFor authentication and token validation that controls access to sessions, see [Authentication Service](#4.3). For WebSocket communication that uses these sessions, see [Real-time Communication](#5).\n\n## Session Data Model\n\nThe session system is built around the `HtmlSession` model, which represents a single user session and its associated resources:\n\n```mermaid\ngraph TB\n    subgraph \"HtmlSession Data Structure\"\n        HtmlSession[\"HtmlSession\"]\n        HtmlSession --\u003e UserId[\"UserId: string\"]\n        HtmlSession --\u003e SessionId[\"SessionId: string\"]\n        HtmlSession --\u003e Html[\"Html: string\"]\n        HtmlSession --\u003e LastUpdated[\"LastUpdated: DateTime\"]\n        HtmlSession --\u003e CreatedAt[\"CreatedAt: DateTime\"]\n        HtmlSession --\u003e LastUserInteraction[\"LastUserInteraction: DateTime\"]\n        HtmlSession --\u003e ClientSocket[\"ClientSocket: WebSocket?\"]\n        HtmlSession --\u003e WordSocket[\"WordSocket: WebSocket?\"]\n        HtmlSession --\u003e WordFilePath[\"WordFilePath: string?\"]\n    end\n    \n    subgraph \"Session Identification\"\n        UserId --\u003e UserSessions[\"Multiple Sessions per User\"]\n        SessionId --\u003e UniqueSession[\"GUID-based Unique Identifier\"]\n    end\n    \n    subgraph \"Content Management\"\n        Html --\u003e DocumentContent[\"Current HTML Content\"]\n        WordFilePath --\u003e TempFiles[\"Temporary DOCX Files\"]\n    end\n    \n    subgraph \"Connection Management\"\n        ClientSocket --\u003e WebBrowser[\"Web Client Connection\"]\n        WordSocket --\u003e MSWord[\"Microsoft Word Connection\"]\n    end\n    \n    subgraph \"Lifecycle Tracking\"\n        CreatedAt --\u003e SessionAge[\"Session Age Calculation\"]\n        LastUpdated --\u003e ContentChanges[\"Content Modification Tracking\"]\n        LastUserInteraction --\u003e ActivityTimeout[\"Inactivity Detection\"]\n    end\n```\n\n**Sources:** [Models/HtmlSession.cs:1-17]()\n\n## Session Storage Architecture\n\nThe `SessionStorageService` provides thread-safe session management using in-memory storage with configurable limits and timeouts:\n\n```mermaid\ngraph TB\n    subgraph \"SessionStorageService Core\"\n        Storage[\"ConcurrentDictionary\u0026lt;string, HtmlSession\u0026gt;\"]\n        Storage --\u003e SessionOperations[\"Session Operations\"]\n    end\n    \n    subgraph \"Session Operations\"\n        CreateSession[\"CreateSession(userId, initialHtml)\"]\n        Get[\"Get(sessionId)\"]\n        SaveOrUpdate[\"SaveOrUpdate(sessionId, html)\"]\n        RemoveSession[\"RemoveSession(sessionId)\"]\n        Exists[\"Exists(sessionId)\"]\n    end\n    \n    subgraph \"WebSocket Management\"\n        TryRegisterSocket[\"TryRegisterSocket(sessionId, socket, origin)\"]\n        UnregisterSocket[\"UnregisterSocket(sessionId, socket)\"]\n        IsSocketAuthenticated[\"IsSocketAuthenticated(sessionId, socket)\"]\n        GetActiveSockets[\"GetActiveSockets(sessionId)\"]\n    end\n    \n    subgraph \"Session Limits \u0026 Validation\"\n        GetSessionsByUserId[\"GetSessionsByUserId(userId)\"]\n        MaxSessionsCheck[\"Max Sessions Per User Check\"]\n        SessionLifetimeCheck[\"Session Lifetime Validation\"]\n        InactivityCheck[\"User Inactivity Detection\"]\n    end\n    \n    subgraph \"Configuration Parameters\"\n        SessionTTLMinutes[\"SessionTTLMinutes: 30 min default\"]\n        MaxSessionLifetimeMinutes[\"MaxSessionLifetimeMinutes: 120 min default\"]\n        MaxSessions[\"MaxSessions: 2 per user default\"]\n    end\n    \n    CreateSession --\u003e MaxSessionsCheck\n    Get --\u003e SessionLifetimeCheck\n    Get --\u003e InactivityCheck\n    TryRegisterSocket --\u003e Origins[\"Origins.Client / Origins.Word\"]\n    \n    SessionOperations --\u003e Storage\n    WebSocketManagement --\u003e Storage\n    SessionLimits --\u003e Storage\n```\n\n**Sources:** [Services/SessionStorageService.cs:10-241]()\n\n## Session Lifecycle Management\n\nThe session lifecycle includes creation, active use, expiration detection, and cleanup:\n\n```mermaid\ngraph LR\n    subgraph \"Session Creation\"\n        CreateRequest[\"Create Session Request\"]\n        UserThrottle[\"Check Max Sessions per User\"]\n        GenerateGUID[\"Generate GUID SessionId\"]\n        InitializeSession[\"Initialize HtmlSession Object\"]\n        StoreSession[\"Store in ConcurrentDictionary\"]\n    end\n    \n    subgraph \"Active Session Usage\"\n        RegisterSockets[\"Register Client/Word WebSockets\"]\n        UpdateContent[\"Update HTML Content\"]\n        TrackInteraction[\"Update LastUserInteraction\"]\n        FileOperations[\"Manage WordFilePath\"]\n    end\n    \n    subgraph \"Expiration Detection\"\n        InactivityExpiry[\"LastUserInteraction + SessionTTLMinutes\"]\n        AbsoluteExpiry[\"CreatedAt + MaxSessionLifetimeMinutes\"]\n        ExpiryCondition[\"isInactive || isTooOld\"]\n    end\n    \n    subgraph \"Session Cleanup\"\n        CloseWebSockets[\"Close Active WebSockets\"]\n        DeleteTempFiles[\"Delete WordFilePath Files\"]\n        RemoveFromStorage[\"Remove from ConcurrentDictionary\"]\n    end\n    \n    CreateRequest --\u003e UserThrottle\n    UserThrottle --\u003e GenerateGUID\n    GenerateGUID --\u003e InitializeSession\n    InitializeSession --\u003e StoreSession\n    \n    StoreSession --\u003e RegisterSockets\n    RegisterSockets --\u003e UpdateContent\n    UpdateContent --\u003e TrackInteraction\n    TrackInteraction --\u003e FileOperations\n    \n    FileOperations --\u003e InactivityExpiry\n    InactivityExpiry --\u003e ExpiryCondition\n    AbsoluteExpiry --\u003e ExpiryCondition\n    ExpiryCondition --\u003e CloseWebSockets\n    CloseWebSockets --\u003e DeleteTempFiles\n    DeleteTempFiles --\u003e RemoveFromStorage\n```\n\n**Sources:** [Services/SessionStorageService.cs:27-45](), [Services/SessionStorageService.cs:47-59](), [Services/SessionStorageService.cs:181-208]()\n\n## Background Session Cleanup\n\nThe `SessionCleanupService` runs as a background service to automatically clean up expired sessions:\n\n```mermaid\ngraph TB\n    subgraph \"SessionCleanupService Background Process\"\n        BackgroundService[\"SessionCleanupService : BackgroundService\"]\n        ConfigInterval[\"SessionCleanupIntervalMinutes: 20 min default\"]\n        ExecuteAsync[\"ExecuteAsync(CancellationToken)\"]\n    end\n    \n    subgraph \"Cleanup Execution Loop\"\n        CreateScope[\"Create Service Scope\"]\n        GetSessionService[\"Get SessionStorageService\"]\n        GetWebSocketHandler[\"Get WebSocketHandler\"]\n        CleanupExpired[\"CleanupExpiredSessionsAndReturnSocketsToClose()\"]\n        CloseSocketsAsync[\"CloseSocketAsync(socket, reason)\"]\n        DelayInterval[\"Task.Delay(cleanupInterval)\"]\n    end\n    \n    subgraph \"Cleanup Logic in SessionStorageService\"\n        IterateSessions[\"Iterate All Sessions\"]\n        CheckInactivity[\"Check LastUserInteraction \u003e SessionTTLMinutes\"]\n        CheckAbsoluteAge[\"Check CreatedAt \u003e MaxSessionLifetimeMinutes\"]\n        CollectSockets[\"Collect Open WebSockets\"]\n        RemoveSessionCall[\"RemoveSession(sessionId)\"]\n        DeleteAssociatedFiles[\"Delete WordFilePath Files\"]\n    end\n    \n    BackgroundService --\u003e ExecuteAsync\n    ExecuteAsync --\u003e CreateScope\n    CreateScope --\u003e GetSessionService\n    GetSessionService --\u003e GetWebSocketHandler\n    GetWebSocketHandler --\u003e CleanupExpired\n    CleanupExpired --\u003e IterateSessions\n    IterateSessions --\u003e CheckInactivity\n    IterateSessions --\u003e CheckAbsoluteAge\n    CheckInactivity --\u003e CollectSockets\n    CheckAbsoluteAge --\u003e CollectSockets\n    CollectSockets --\u003e RemoveSessionCall\n    RemoveSessionCall --\u003e DeleteAssociatedFiles\n    CleanupExpired --\u003e CloseSocketsAsync\n    CloseSocketsAsync --\u003e DelayInterval\n    DelayInterval --\u003e CreateScope\n```\n\n**Sources:** [Services/SessionCleanupService.cs:1-35](), [Services/SessionStorageService.cs:181-208]()\n\n## Configuration Options\n\nThe session management system supports several configuration parameters that can be set in application configuration:\n\n| Configuration Key | Default Value | Description | Usage Location |\n|------------------|---------------|-------------|----------------|\n| `SessionTTLMinutes` | 30 | Session timeout after user inactivity | [Services/SessionStorageService.cs:22]() |\n| `MaxSessionLifetimeMinutes` | 120 | Maximum absolute session lifetime | [Services/SessionStorageService.cs:23]() |\n| `MaxSessions` | 2 | Maximum sessions per user | [Services/SessionStorageService.cs:24]() |\n| `SessionCleanupIntervalMinutes` | 20 | Background cleanup frequency | [Services/SessionCleanupService.cs:13]() |\n\n## WebSocket Integration\n\nSessions maintain references to WebSocket connections for real-time communication:\n\n```mermaid\ngraph LR\n    subgraph \"Socket Registration Process\"\n        SocketConnect[\"WebSocket Connection\"]\n        ValidateSession[\"Validate SessionId\"]\n        CheckOrigin[\"Determine Origin: Client/Word\"]\n        RegisterSocket[\"TryRegisterSocket(sessionId, socket, origin)\"]\n        ValidateExisting[\"Check for Existing Socket\"]\n        StoreReference[\"Store Socket Reference in HtmlSession\"]\n    end\n    \n    subgraph \"Socket Origins\"\n        ClientOrigin[\"Origins.Client\"]\n        WordOrigin[\"Origins.Word\"]\n        ClientSocket[\"HtmlSession.ClientSocket\"]\n        WordSocket[\"HtmlSession.WordSocket\"]\n    end\n    \n    subgraph \"Socket Lifecycle\"\n        ActiveSocket[\"Active WebSocket Communication\"]\n        SocketClosed[\"Socket Closed/Disconnected\"]\n        UnregisterSocket[\"UnregisterSocket(sessionId, socket)\"]\n        ClearReference[\"Clear Socket Reference\"]\n    end\n    \n    SocketConnect --\u003e ValidateSession\n    ValidateSession --\u003e CheckOrigin\n    CheckOrigin --\u003e RegisterSocket\n    RegisterSocket --\u003e ValidateExisting\n    ValidateExisting --\u003e StoreReference\n    \n    ClientOrigin --\u003e ClientSocket\n    WordOrigin --\u003e WordSocket\n    StoreReference --\u003e ClientSocket\n    StoreReference --\u003e WordSocket\n    \n    ClientSocket --\u003e ActiveSocket\n    WordSocket --\u003e ActiveSocket\n    ActiveSocket --\u003e SocketClosed\n    SocketClosed --\u003e UnregisterSocket\n    UnregisterSocket --\u003e ClearReference\n```\n\n**Sources:** [Services/SessionStorageService.cs:117-146](), [Services/SessionStorageService.cs:148-170](), [WebSockets/Origins.cs]()\n\n## File Management\n\nSessions can maintain references to temporary Word document files that are automatically cleaned up:\n\n- **File Association**: The `SetWordFilePath` method links a temporary DOCX file to a session [Services/SessionStorageService.cs:172-178]()\n- **Automatic Cleanup**: When sessions are removed, associated files are deleted from the file system [Services/SessionStorageService.cs:93-104]()\n- **Error Handling**: File deletion failures are logged but do not prevent session removal [Services/SessionStorageService.cs:99-103]()\n\n**Sources:** [Services/SessionStorageService.cs:89-110](), [Services/SessionStorageService.cs:172-178]()"])</script><script>self.__next_f.push([1,"20:T1e8d,"])</script><script>self.__next_f.push([1,"# Authentication Service\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Services/TokenValidationService.cs](Services/TokenValidationService.cs)\n\n\u003c/details\u003e\n\n\n\nThe Authentication Service provides token-based user authentication for the IstgHtmlDocxConvertService. It validates user tokens against a SQL Server database and integrates with the Windows Registry for connection string management. This service is used by both HTTP endpoints and WebSocket handlers to authenticate users before allowing access to document conversion and collaboration features.\n\nFor session management after authentication, see [Session Management](#4.2). For WebSocket authentication flows, see [WebSocket Protocol](#5.2).\n\n## Architecture Overview\n\nThe authentication system is built around the `TokenValidationService` class, which handles token decryption and database validation. The service integrates with external dependencies including Windows Registry for configuration and SQL Server for user data.\n\n### Authentication Service Dependencies\n\n```mermaid\ngraph TB\n    subgraph \"Configuration Layer\"\n        IConfiguration[\"IConfiguration\"]\n        RegistryName[\"RegistryName\"]\n        ConnectionStringManager[\"ConnectionStringManager\"]\n        WindowsRegistry[\"Windows Registry\"]\n    end\n    \n    subgraph \"Core Authentication\"\n        TokenValidationService[\"TokenValidationService\"]\n        DecryptToken[\"DecryptToken()\"]\n        IsTokenValid[\"IsTokenValid()\"]\n    end\n    \n    subgraph \"Data Layer\"\n        SqlConnection[\"SqlConnection\"]\n        tbrPersonnel[\"tbrPersonnel Table\"]\n        SqlDatabase[\"SQL Server Database\"]\n    end\n    \n    subgraph \"Logging\"\n        SystemEventLogger[\"SystemEventLogger\"]\n        WindowsEventLog[\"Windows Event Log\"]\n    end\n    \n    IConfiguration --\u003e TokenValidationService\n    IConfiguration --\u003e RegistryName\n    RegistryName --\u003e ConnectionStringManager\n    ConnectionStringManager --\u003e WindowsRegistry\n    ConnectionStringManager --\u003e TokenValidationService\n    \n    TokenValidationService --\u003e DecryptToken\n    TokenValidationService --\u003e IsTokenValid\n    TokenValidationService --\u003e SystemEventLogger\n    \n    IsTokenValid --\u003e SqlConnection\n    SqlConnection --\u003e tbrPersonnel\n    tbrPersonnel --\u003e SqlDatabase\n    \n    SystemEventLogger --\u003e WindowsEventLog\n```\n\nSources: [Services/TokenValidationService.cs:1-46]()\n\n## Token Validation Process\n\nThe authentication flow follows a multi-step process involving token decryption, database lookup, and error handling. The service validates tokens by extracting user identifiers and verifying them against the personnel database.\n\n### Token Validation Flow\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant TokenValidationService\n    participant DecryptToken\n    participant SqlConnection\n    participant tbrPersonnel\n    participant SystemEventLogger\n    \n    Client-\u003e\u003eTokenValidationService: \"IsTokenValid(token)\"\n    TokenValidationService-\u003e\u003eDecryptToken: \"DecryptToken(encryptedToken)\"\n    DecryptToken--\u003e\u003eTokenValidationService: \"prsId\"\n    \n    TokenValidationService-\u003e\u003eSqlConnection: \"new SqlConnection(_connectionString)\"\n    SqlConnection-\u003e\u003eSqlConnection: \"Open()\"\n    \n    TokenValidationService-\u003e\u003etbrPersonnel: \"SELECT COUNT(*) WHERE prsId = @prsId\"\n    tbrPersonnel--\u003e\u003eTokenValidationService: \"count\"\n    \n    alt count \u003e 0\n        TokenValidationService--\u003e\u003eClient: \"true (valid)\"\n    else count = 0\n        TokenValidationService--\u003e\u003eClient: \"false (invalid)\"\n    end\n    \n    Note over TokenValidationService: \"On Exception\"\n    TokenValidationService-\u003e\u003eSystemEventLogger: \"Error(message)\"\n    TokenValidationService--\u003e\u003eClient: \"false (error)\"\n```\n\nSources: [Services/TokenValidationService.cs:18-39]()\n\n### Token Validation Implementation\n\nThe `IsTokenValid` method implements the core authentication logic:\n\n| Step | Action | Code Reference |\n|------|--------|----------------|\n| 1 | Decrypt token to extract `prsId` | [Services/TokenValidationService.cs:22]() |\n| 2 | Open SQL connection using connection string | [Services/TokenValidationService.cs:24-25]() |\n| 3 | Execute parameterized query against `tbrPersonnel` | [Services/TokenValidationService.cs:27-28]() |\n| 4 | Return validation result based on record count | [Services/TokenValidationService.cs:30-32]() |\n| 5 | Log errors and return false on exceptions | [Services/TokenValidationService.cs:34-38]() |\n\nThe validation query specifically targets the `tbrPersonnel` table:\n```sql\nSELECT COUNT(*) FROM ..[dbo].[tbrPersonnel] WHERE prsId = @prsId\n```\n\nSources: [Services/TokenValidationService.cs:27]()\n\n## Database Integration\n\nThe authentication service connects to SQL Server through a connection string retrieved from the Windows Registry. This approach provides secure, centralized configuration management for database connectivity.\n\n### Connection String Management\n\nThe service uses the `ConnectionStringManager` from the `istgOfficeAutomationBrl.RegManager` namespace to retrieve database connection strings:\n\n| Component | Purpose | Implementation |\n|-----------|---------|----------------|\n| `RegistryName` | Registry key identifier from appsettings | [Services/TokenValidationService.cs:13]() |\n| `ConnectionStringManager` | Retrieves connection strings from Registry | [Services/TokenValidationService.cs:14]() |\n| `IstgDataBase.IstgRef` | Database reference identifier | [Services/TokenValidationService.cs:14]() |\n| `_connectionString` | Cached connection string for SQL operations | [Services/TokenValidationService.cs:9,14]() |\n\n### Personnel Database Schema\n\nThe authentication validates against the `tbrPersonnel` table with the following structure:\n\n| Field | Type | Purpose |\n|-------|------|---------|\n| `prsId` | Primary Key | Personnel identifier extracted from decrypted token |\n\nSources: [Services/TokenValidationService.cs:11-16](), [Services/TokenValidationService.cs:27]()\n\n## Token Decryption\n\nThe service includes a placeholder implementation for token decryption that currently returns the token unchanged. This suggests the actual decryption logic is intended to be implemented based on specific security requirements.\n\n```csharp\npublic string DecryptToken(string encryptedToken)\n{\n    return encryptedToken;\n}\n```\n\nIn a production environment, this method should implement proper token decryption to extract the `prsId` from encrypted tokens.\n\nSources: [Services/TokenValidationService.cs:42-45]()\n\n## Error Handling and Logging\n\nThe authentication service implements comprehensive error handling with logging to the Windows Event Log through the `SystemEventLogger`.\n\n### Error Handling Strategy\n\n| Error Scenario | Response | Logging |\n|----------------|----------|---------|\n| Token decryption failure | Return `false` | Error logged with exception details |\n| Database connection failure | Return `false` | Error logged with exception details |\n| SQL query execution failure | Return `false` | Error logged with exception details |\n| Invalid user (count = 0) | Return `false` | No error logged (valid scenario) |\n\nThe error logging format includes contextual information:\n```\n\"Something went wrong in Token validation: {ex.Message}\"\n```\n\nSources: [Services/TokenValidationService.cs:34-38]()\n\n## Dependency Injection Configuration\n\nThe `TokenValidationService` is configured through the dependency injection container with the following dependencies:\n\n| Dependency | Type | Purpose |\n|------------|------|---------|\n| `IConfiguration` | Interface | Access to application configuration |\n| `SystemEventLogger` | Service | Error and event logging |\n\nThe constructor initializes the connection string during service instantiation, ensuring database connectivity is established at startup.\n\nSources: [Services/TokenValidationService.cs:11-16]()"])</script><script>self.__next_f.push([1,"21:T2212,"])</script><script>self.__next_f.push([1,"# Real-time Communication\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [WebSockets/Constants.cs](WebSockets/Constants.cs)\n- [WebSockets/WebSocketHandler.cs](WebSockets/WebSocketHandler.cs)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nThis document explains the real-time communication system that enables live collaboration between web clients and Microsoft Word applications. The WebSocket-based architecture allows for bidirectional, low-latency communication to synchronize document changes in real-time.\n\nFor detailed implementation of the WebSocket message handler, see [WebSocket Handler](#5.1). For the specific message format and protocol specification, see [WebSocket Protocol](#5.2).\n\n## Architecture Overview\n\nThe real-time communication system is built around WebSocket connections that connect multiple clients to shared document sessions. The system supports two primary client types: web browsers and Microsoft Word applications, both communicating through the `WebSocketHandler` class.\n\n### Core Communication Flow\n\n```mermaid\ngraph TB\n    WebClient[\"Web Client Browser\"]\n    WordApp[\"Microsoft Word Application\"]\n    WebSocketHandler[\"WebSocketHandler\"]\n    SessionStorageService[\"SessionStorageService\"]\n    ConversionService[\"ConversionService\"]\n    \n    WebClient --\u003e|\"WebSocket Connection\"| WebSocketHandler\n    WordApp --\u003e|\"WebSocket Connection\"| WebSocketHandler\n    WebSocketHandler --\u003e|\"Session Management\"| SessionStorageService\n    WebSocketHandler --\u003e|\"Document Conversion\"| ConversionService\n    \n    WebSocketHandler --\u003e|\"Broadcast Updates\"| WebClient\n    WebSocketHandler --\u003e|\"Broadcast Updates\"| WordApp\n```\n\nSources: [WebSockets/WebSocketHandler.cs:12-33]()\n\nThe `WebSocketHandler` serves as the central hub for all real-time communication, managing connections from both web clients and Word applications while coordinating with session storage and document conversion services.\n\n## WebSocket Connection Lifecycle\n\n### Connection Establishment and Authentication\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant WebSocketHandler\n    participant TokenValidationService\n    participant SessionStorageService\n    \n    Client-\u003e\u003eWebSocketHandler: \"Connect + SocketMessageRequest\"\n    WebSocketHandler-\u003e\u003eWebSocketHandler: \"ReceiveMessageAsync()\"\n    WebSocketHandler-\u003e\u003eSessionStorageService: \"Get(message.SessionId)\"\n    WebSocketHandler-\u003e\u003eTokenValidationService: \"IsTokenValid(message.Token)\"\n    TokenValidationService--\u003e\u003eWebSocketHandler: \"Token Valid\"\n    WebSocketHandler-\u003e\u003eSessionStorageService: \"TryRegisterSocket(sessionId, socket, origin)\"\n    WebSocketHandler--\u003e\u003eClient: \"Connection Authenticated\"\n```\n\nSources: [WebSockets/WebSocketHandler.cs:54-90]()\n\nEvery WebSocket connection must provide a valid authentication token and session ID in the initial message. The `TokenValidationService` validates the token before the socket is registered with the `SessionStorageService` using the `TryRegisterSocket` method.\n\n### Message Processing Loop\n\nThe `WebSocketHandler` maintains an active message processing loop for each connected socket:\n\n```mermaid\ngraph TB\n    ReceiveMessage[\"ReceiveMessageAsync()\"]\n    ValidateSession[\"Check Session Exists\"]\n    AuthenticateSocket[\"IsSocketAuthenticated()\"]\n    RouteMessage[\"Route to Handler\"]\n    \n    UpdateHandler[\"HandleUpdate()\"]\n    GetHandler[\"HandleGet()\"]\n    EndHandler[\"HandleEnd()\"]\n    \n    ReceiveMessage --\u003e ValidateSession\n    ValidateSession --\u003e AuthenticateSocket\n    AuthenticateSocket --\u003e RouteMessage\n    \n    RouteMessage --\u003e UpdateHandler\n    RouteMessage --\u003e GetHandler\n    RouteMessage --\u003e EndHandler\n```\n\nSources: [WebSockets/WebSocketHandler.cs:92-133](), [WebSockets/WebSocketHandler.cs:27-32]()\n\n## WebSocket Actions and Message Types\n\nThe system defines specific action types in the `WebSocketActions` class that determine how messages are processed:\n\n| Action | Constant | Handler Method | Purpose |\n|--------|----------|----------------|---------|\n| Update OOXML | `UpdateOoxml` | `HandleUpdate()` | Process document changes from Word |\n| Get HTML | `GetHtml` | `HandleGet()` | Retrieve current HTML content |\n| End Session | `EndSession` | `HandleEnd()` | Terminate session and cleanup |\n| Session Closed | `SessionClosed` | N/A | Server notification of closure |\n| Initialize | `Init` | N/A | Initial connection setup |\n\nSources: [WebSockets/Constants.cs:3-11](), [WebSockets/WebSocketHandler.cs:154-241]()\n\n### Origin-based Message Routing\n\nMessages are tagged with origin identifiers from the `Origins` class to track their source:\n\n- **`Origins.Word`**: Messages from Microsoft Word applications\n- **`Origins.Client`**: Messages from web browser clients  \n- **`Origins.Server`**: Server-generated responses and notifications\n\nSources: [WebSockets/Constants.cs:19-24]()\n\n## Document Synchronization Patterns\n\n### Word-to-Browser Updates\n\n```mermaid\nsequenceDiagram\n    participant WordApp\n    participant WebSocketHandler\n    participant ConversionService\n    participant SessionStorageService\n    participant WebClients\n    \n    WordApp-\u003e\u003eWebSocketHandler: \"UpdateOoxml Action + OOXML Content\"\n    WebSocketHandler-\u003e\u003eConversionService: \"ConvertOoxmlToHtml(ooxml)\"\n    ConversionService--\u003e\u003eWebSocketHandler: \"HTML Content\"\n    WebSocketHandler-\u003e\u003eSessionStorageService: \"SaveOrUpdate(sessionId, html)\"\n    WebSocketHandler-\u003e\u003eWebClients: \"Broadcast SocketMessageResponse\"\n```\n\nSources: [WebSockets/WebSocketHandler.cs:154-192]()\n\nWhen Word sends OOXML updates through the `UpdateOoxml` action, the system converts the content to HTML using `ConversionService.ConvertOoxmlToHtml()` and broadcasts the result to all connected clients in the session.\n\n### Client HTML Requests\n\n```mermaid\nsequenceDiagram\n    participant WebClient\n    participant WebSocketHandler\n    participant SessionStorageService\n    \n    WebClient-\u003e\u003eWebSocketHandler: \"GetHtml Action\"\n    WebSocketHandler-\u003e\u003eSessionStorageService: \"Get(sessionId)\"\n    SessionStorageService--\u003e\u003eWebSocketHandler: \"HtmlSession Object\"\n    WebSocketHandler--\u003e\u003eWebClient: \"SocketMessageResponse with HTML\"\n```\n\nSources: [WebSockets/WebSocketHandler.cs:194-218]()\n\nWeb clients can request the current HTML content using the `GetHtml` action, which retrieves the stored HTML from the session and returns it in a `SocketMessageResponse`.\n\n## Session Management Integration\n\nThe real-time communication system integrates tightly with session management through the `SessionStorageService`:\n\n### Socket Registration by Origin\n\n```mermaid\ngraph LR\n    SessionStorageService[\"SessionStorageService\"]\n    HtmlSession[\"HtmlSession Object\"]\n    ClientSocket[\"Client WebSocket\"]\n    WordSocket[\"Word WebSocket\"]\n    \n    SessionStorageService --\u003e HtmlSession\n    HtmlSession --\u003e ClientSocket\n    HtmlSession --\u003e WordSocket\n```\n\nSources: [WebSockets/WebSocketHandler.cs:89](), [WebSockets/WebSocketHandler.cs:144]()\n\nEach session can maintain separate WebSocket connections for web clients and Word applications. The `TryRegisterSocket` method associates sockets with sessions based on their origin, and `UnregisterSocket` cleans up connections when they close.\n\n## Error Handling and Resilience\n\n### WebSocket Error Response System\n\nThe system uses structured error responses through `SocketMessageError` objects when problems occur:\n\n```mermaid\ngraph TB\n    ErrorCondition[\"Error Condition\"]\n    SendError[\"SendError()\"]\n    SocketMessageError[\"SocketMessageError\"]\n    WebSocketErrorCodes[\"WebSocketErrorCodes\"]\n    CloseSocket[\"CloseSocketAsync()\"]\n    \n    ErrorCondition --\u003e SendError\n    SendError --\u003e SocketMessageError\n    SendError --\u003e WebSocketErrorCodes\n    SendError --\u003e CloseSocket\n```\n\nSources: [WebSockets/WebSocketHandler.cs:258-270](), [WebSockets/WebSocketHandler.cs:273-291]()\n\nCommon error scenarios include:\n- **Session Not Found**: When a session ID is invalid or expired\n- **Invalid Token**: When authentication fails\n- **Socket Not Authenticated**: When an unauthenticated socket attempts actions\n- **Conversion Error**: When OOXML to HTML conversion fails\n- **Message Processing Error**: When unexpected exceptions occur\n\n### Connection Cleanup\n\nThe `WebSocketHandler` ensures proper cleanup in the `finally` block of the main handling loop:\n\n1. Unregister the socket from the session using `UnregisterSocket()`\n2. Send a `SessionClosed` notification if the socket is still open\n3. Close the WebSocket connection gracefully with `CloseSocketAsync()`\n\nSources: [WebSockets/WebSocketHandler.cs:141-151]()\n\nThis cleanup process ensures that sessions don't accumulate stale socket references and that clients are properly notified when connections terminate."])</script><script>self.__next_f.push([1,"22:T2c8d,"])</script><script>self.__next_f.push([1,"# WebSocket Handler\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Interfaces/ISocketMessage.cs](Interfaces/ISocketMessage.cs)\n- [Models/SocketMessageRequest.cs](Models/SocketMessageRequest.cs)\n- [WebSockets/WebSocketHandler.cs](WebSockets/WebSocketHandler.cs)\n\n\u003c/details\u003e\n\n\n\n## Purpose and Scope\n\nThe WebSocket Handler is the core component responsible for managing real-time WebSocket connections between clients and the document conversion service. It facilitates live collaboration by handling bidirectional communication for document updates, HTML retrieval, and session management.\n\nThis document covers the `WebSocketHandler` class implementation, connection lifecycle, message processing patterns, and integration with session storage and conversion services. For WebSocket message format and protocol specifications, see [WebSocket Protocol](#5.2). For session management details, see [Session Management](#4.2).\n\n## Class Overview and Dependencies\n\nThe `WebSocketHandler` class serves as the central orchestrator for WebSocket communication, managing authentication, message routing, and real-time document synchronization.\n\n### Core Dependencies\n\n| Dependency | Purpose | Integration Point |\n|------------|---------|-------------------|\n| `SessionStorageService` | Session state management | Socket registration and HTML storage |\n| `ConversionService` | Document format conversion | OOXML to HTML conversion |\n| `TokenValidationService` | Authentication validation | Initial connection authentication |\n| `SystemEventLogger` | Event logging | Connection events and error tracking |\n\n### Message Handlers\n\nThe WebSocket handler uses a dictionary-based action routing system to process different message types:\n\n```mermaid\ngraph TB\n    subgraph \"WebSocketHandler Class\"\n        Constructor[\"WebSocketHandler()\"]\n        HandleAsync[\"HandleAsync()\"]\n        ReceiveMessageAsync[\"ReceiveMessageAsync()\"]\n        \n        subgraph \"Action Handlers\"\n            HandleUpdate[\"HandleUpdate()\"]\n            HandleGet[\"HandleGet()\"]\n            HandleEnd[\"HandleEnd()\"]\n        end\n        \n        subgraph \"Utility Methods\"\n            SendMessage[\"SendMessage()\"]\n            SendError[\"SendError()\"]\n            CloseSocketAsync[\"CloseSocketAsync()\"]\n        end\n    end\n    \n    subgraph \"Handler Dictionary\"\n        UpdateOoxml[\"WebSocketActions.UpdateOoxml\"]\n        GetHtml[\"WebSocketActions.GetHtml\"] \n        EndSession[\"WebSocketActions.EndSession\"]\n    end\n    \n    Constructor --\u003e HandleAsync\n    HandleAsync --\u003e ReceiveMessageAsync\n    HandleAsync --\u003e HandleUpdate\n    HandleAsync --\u003e HandleGet\n    HandleAsync --\u003e HandleEnd\n    \n    UpdateOoxml --\u003e HandleUpdate\n    GetHtml --\u003e HandleGet\n    EndSession --\u003e HandleEnd\n    \n    HandleUpdate --\u003e SendMessage\n    HandleGet --\u003e SendMessage\n    HandleEnd --\u003e SendMessage\n    SendError --\u003e SendMessage\n```\n\nSources: [WebSockets/WebSocketHandler.cs:12-33]()\n\n## Connection Lifecycle\n\n### Initial Connection and Authentication\n\nThe WebSocket connection follows a strict authentication and registration flow:\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant WebSocketHandler\n    participant SessionStorageService\n    participant TokenValidationService\n    \n    Client-\u003e\u003eWebSocketHandler: \"Connect with Token + SessionId\"\n    WebSocketHandler-\u003e\u003eSessionStorageService: \"Get(sessionId)\"\n    \n    alt Session Exists\n        WebSocketHandler-\u003e\u003eTokenValidationService: \"IsTokenValid(token)\"\n        alt Valid Token\n            WebSocketHandler-\u003e\u003eSessionStorageService: \"TryRegisterSocket(sessionId, socket, origin)\"\n            WebSocketHandler--\u003e\u003eClient: \"Connection Authenticated\"\n            \n            loop While Connected\n                Client-\u003e\u003eWebSocketHandler: \"Send Message\"\n                WebSocketHandler-\u003e\u003eWebSocketHandler: \"Process Action\"\n                WebSocketHandler--\u003e\u003eClient: \"Send Response\"\n            end\n        else Invalid Token\n            WebSocketHandler--\u003e\u003eClient: \"SendError(InvalidToken)\"\n            WebSocketHandler-\u003e\u003eWebSocketHandler: \"CloseSocketAsync()\"\n        end\n    else Session Not Found\n        WebSocketHandler--\u003e\u003eClient: \"SendError(SessionNotFound)\"\n        WebSocketHandler-\u003e\u003eWebSocketHandler: \"CloseSocketAsync()\"\n    end\n```\n\nThe authentication process validates both session existence and token validity before registering the socket:\n\n- **Session Validation**: Checks if the session exists in `SessionStorageService` [WebSockets/WebSocketHandler.cs:63-70]()\n- **Token Authentication**: Validates the provided token using `TokenValidationService` [WebSockets/WebSocketHandler.cs:73-86]()  \n- **Socket Registration**: Registers the authenticated socket with the session based on origin [WebSockets/WebSocketHandler.cs:89]()\n\nSources: [WebSockets/WebSocketHandler.cs:54-91]()\n\n## Message Processing Architecture\n\n### Message Reception and Validation\n\nThe handler implements a buffered message reception system that supports variable-length WebSocket messages:\n\n```mermaid\ngraph TB\n    subgraph \"Message Processing Flow\"\n        Receive[\"ReceiveMessageAsync()\"]\n        Buffer[\"4KB Buffer Array\"]\n        MemoryStream[\"MemoryStream Accumulator\"]\n        Deserialize[\"JsonSerializer.Deserialize()\"]\n        \n        Receive --\u003e Buffer\n        Buffer --\u003e MemoryStream\n        MemoryStream --\u003e Deserialize\n        Deserialize --\u003e SocketMessageRequest[\"SocketMessageRequest\"]\n    end\n    \n    subgraph \"Validation Checks\"\n        SessionExists[\"Session Exists\"]\n        SocketAuth[\"Socket Authenticated\"]\n        ActionValid[\"Valid Action\"]\n    end\n    \n    SocketMessageRequest --\u003e SessionExists\n    SessionExists --\u003e SocketAuth\n    SocketAuth --\u003e ActionValid\n    ActionValid --\u003e ActionHandler[\"Execute Action Handler\"]\n```\n\nThe message processing loop continues until the WebSocket connection closes, with each message undergoing validation:\n\n- **Session Existence**: Verifies the session hasn't expired [WebSockets/WebSocketHandler.cs:100-106]()\n- **Socket Authentication**: Ensures the socket is properly authenticated [WebSockets/WebSocketHandler.cs:109-115]()\n- **Action Routing**: Maps actions to handler methods using the handlers dictionary [WebSockets/WebSocketHandler.cs:118-126]()\n\nSources: [WebSockets/WebSocketHandler.cs:35-52](), [WebSockets/WebSocketHandler.cs:92-133]()\n\n## Action Handlers\n\n### UpdateOoxml Handler\n\nThe `HandleUpdate` method processes OOXML content from Microsoft Word and broadcasts HTML updates to all connected clients:\n\n```mermaid\ngraph LR\n    subgraph \"UpdateOoxml Flow\"\n        OoxmlInput[\"OOXML Content\"]\n        ConversionService[\"ConversionService.ConvertOoxmlToHtml()\"]\n        SessionStorage[\"SessionStorageService.SaveOrUpdate()\"]\n        Broadcast[\"Broadcast to All Sockets\"]\n    end\n    \n    OoxmlInput --\u003e ConversionService\n    ConversionService --\u003e SessionStorage\n    SessionStorage --\u003e Broadcast\n    \n    subgraph \"Error Handling\"\n        ConversionError[\"Conversion Error\"]\n        SessionNotFound[\"Session Not Found\"]\n    end\n    \n    ConversionService -.-\u003e ConversionError\n    SessionStorage -.-\u003e SessionNotFound\n```\n\nKey operations:\n- Converts OOXML to HTML using `ConversionService` [WebSockets/WebSocketHandler.cs:166]()\n- Updates session storage with new HTML content [WebSockets/WebSocketHandler.cs:174]()\n- Broadcasts HTML to all active sockets in the session [WebSockets/WebSocketHandler.cs:188-191]()\n\n### GetHtml Handler\n\nThe `HandleGet` method retrieves current HTML content for a specific client:\n\n- Validates session existence [WebSockets/WebSocketHandler.cs:198-203]()\n- Returns stored HTML content to requesting socket [WebSockets/WebSocketHandler.cs:207-217]()\n\n### EndSession Handler\n\nThe `HandleEnd` method terminates a session and notifies all connected clients:\n\n- Broadcasts session closure to all active sockets [WebSockets/WebSocketHandler.cs:234-237]()\n- Removes session from storage [WebSockets/WebSocketHandler.cs:239]()\n- Logs session cleanup [WebSockets/WebSocketHandler.cs:240]()\n\nSources: [WebSockets/WebSocketHandler.cs:154-241]()\n\n## Error Handling and Response System\n\n### Error Code Integration\n\nThe WebSocket handler integrates with the centralized error code system for consistent error responses:\n\n```mermaid\ngraph TB\n    subgraph \"Error Types\"\n        SessionNotFound[\"WebSocketErrorCodes.SessionNotFound\"]\n        InvalidToken[\"WebSocketErrorCodes.InvalidToken\"]\n        ConversionError[\"WebSocketErrorCodes.ConversionError\"]\n        InvalidAction[\"WebSocketErrorCodes.InvalidAction\"]\n        ProcessingError[\"WebSocketErrorCodes.MessageProcessingError\"]\n    end\n    \n    subgraph \"Error Response Flow\"\n        SendError[\"SendError()\"]\n        SocketMessageError[\"SocketMessageError\"]\n        GetMessage[\"WebSocketErrorCodes.GetMessage()\"]\n        SendMessage[\"SendMessage()\"]\n    end\n    \n    SessionNotFound --\u003e SendError\n    InvalidToken --\u003e SendError\n    ConversionError --\u003e SendError\n    InvalidAction --\u003e SendError\n    ProcessingError --\u003e SendError\n    \n    SendError --\u003e SocketMessageError\n    SocketMessageError --\u003e GetMessage\n    GetMessage --\u003e SendMessage\n```\n\n### Connection Closure Handling\n\nThe handler implements graceful connection closure with proper cleanup:\n\n- Sends closure notification to client [WebSockets/WebSocketHandler.cs:284-285]()\n- Closes WebSocket with normal status [WebSockets/WebSocketHandler.cs:286]()\n- Unregisters socket from session storage [WebSockets/WebSocketHandler.cs:144]()\n- Logs closure event [WebSockets/WebSocketHandler.cs:288]()\n\nSources: [WebSockets/WebSocketHandler.cs:258-270](), [WebSockets/WebSocketHandler.cs:273-291]()\n\n## Service Integration Points\n\n### SessionStorageService Integration\n\nThe WebSocket handler heavily integrates with session storage for state management:\n\n| Method | Purpose | Usage in Handler |\n|--------|---------|------------------|\n| `Get(sessionId)` | Retrieve session data | Initial validation and HTML retrieval |\n| `Exists(sessionId)` | Check session existence | Message processing validation |\n| `TryRegisterSocket()` | Register authenticated socket | Connection establishment |\n| `IsSocketAuthenticated()` | Verify socket authentication | Message processing security |\n| `GetActiveSockets()` | Get all session sockets | Broadcasting updates |\n| `SaveOrUpdate()` | Store HTML content | After OOXML conversion |\n| `RemoveSession()` | Clean up session | Session termination |\n\n### ConversionService Integration\n\nDocument conversion is handled through the `ConversionService`:\n\n- **OOXML to HTML**: Converts Word document changes to HTML format [WebSockets/WebSocketHandler.cs:166]()\n- **Error Handling**: Processes conversion errors and sends appropriate error responses [WebSockets/WebSocketHandler.cs:167-172]()\n\n### TokenValidationService Integration\n\nAuthentication is managed through token validation:\n\n- **Initial Authentication**: Validates tokens during connection establishment [WebSockets/WebSocketHandler.cs:80]()\n- **Security Enforcement**: Ensures only valid tokens can establish connections\n\nSources: [WebSockets/WebSocketHandler.cs:14-25](), [WebSockets/WebSocketHandler.cs:63](), [WebSockets/WebSocketHandler.cs:89](), [WebSockets/WebSocketHandler.cs:109](), [WebSockets/WebSocketHandler.cs:166](), [WebSockets/WebSocketHandler.cs:174](), [WebSockets/WebSocketHandler.cs:188](), [WebSockets/WebSocketHandler.cs:239]()"])</script><script>self.__next_f.push([1,"23:T2597,"])</script><script>self.__next_f.push([1,"# WebSocket Protocol\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Interfaces/ISocketMessage.cs](Interfaces/ISocketMessage.cs)\n- [Models/SocketMessageRequest.cs](Models/SocketMessageRequest.cs)\n- [WebSockets/Constants.cs](WebSockets/Constants.cs)\n\n\u003c/details\u003e\n\n\n\nThis document defines the WebSocket message format, actions, and communication patterns used for real-time document collaboration between web clients, Microsoft Word applications, and the server. The protocol enables live synchronization of document changes and session management across multiple connected clients.\n\nFor implementation details of how these messages are processed, see [WebSocket Handler](#5.1). For error handling specific to WebSocket communications, see [WebSocket Error Codes](#6.2).\n\n## Message Structure\n\nThe WebSocket protocol uses a standardized message format based on the `ISocketMessage` interface. All messages exchanged between clients and the server follow this structure, with specific implementations for requests, responses, and errors.\n\n### Core Message Interface\n\n```mermaid\nclassDiagram\n    class ISocketMessage {\n        \u003c\u003cinterface\u003e\u003e\n        +string Origin\n        +string SessionId\n        +string Action\n        +string Content\n        +bool? Success\n    }\n    \n    class SocketMessageRequest {\n        +string Origin\n        +string Token\n        +string SessionId\n        +string PayloadType\n        +string Action\n        +string Content\n        +bool? Success\n    }\n    \n    class SocketMessageResponse {\n        +string Origin\n        +string SessionId\n        +string PayloadType\n        +string Action\n        +string Content\n        +bool? Success\n    }\n    \n    class SocketMessageError {\n        +string Origin\n        +string SessionId\n        +string Action\n        +string Content\n        +bool? Success\n        +string ErrorCode\n    }\n    \n    ISocketMessage \u003c|-- SocketMessageRequest\n    ISocketMessage \u003c|-- SocketMessageResponse\n    ISocketMessage \u003c|-- SocketMessageError\n```\n\n**Sources:** [Interfaces/ISocketMessage.cs:1-11](), [Models/SocketMessageRequest.cs:1-37]()\n\n### Message Properties\n\n| Property | Type | Description |\n|----------|------|-------------|\n| `Origin` | string | Identifies the sender: \"word\", \"client\", or \"server\" |\n| `SessionId` | string | Unique identifier linking the message to a specific session |\n| `Action` | string | The operation being requested or performed |\n| `Content` | string | The message payload (HTML, OOXML, etc.) |\n| `Success` | bool? | Indicates operation success/failure |\n| `Token` | string | Authentication token (requests only) |\n| `PayloadType` | string | Content type: \"html\" or \"docx\" |\n| `ErrorCode` | string | Specific error identifier (errors only) |\n\n**Sources:** [Interfaces/ISocketMessage.cs:4-9](), [Models/SocketMessageRequest.cs:7-13](), [Models/SocketMessageRequest.cs:17-24](), [Models/SocketMessageRequest.cs:29-35]()\n\n## Actions and Constants\n\nThe protocol defines specific actions and constants that control the behavior of WebSocket communications. These are centralized in the `WebSocketActions`, `WebSocketPayloadTypes`, and `Origins` classes.\n\n### Available Actions\n\n```mermaid\ngraph TB\n    subgraph WebSocketActions[\"WebSocketActions Constants\"]\n        UpdateOoxml[\"UpdateOoxml = 'update-ooxml'\"]\n        GetHtml[\"GetHtml = 'get-html'\"]\n        EndSession[\"EndSession = 'end-session'\"]\n        SessionClosed[\"SessionClosed = 'session-closed'\"]\n        Init[\"Init = 'init'\"]\n        Unknown[\"Unknown = 'Unknown'\"]\n    end\n    \n    subgraph WebSocketPayloadTypes[\"WebSocketPayloadTypes Constants\"]\n        Html[\"Html = 'html'\"]\n        Docx[\"Docx = 'docx'\"]\n    end\n    \n    subgraph Origins[\"Origins Constants\"]\n        Word[\"Word = 'word'\"]\n        Client[\"Client = 'client'\"]\n        Server[\"Server = 'server'\"]\n    end\n```\n\n**Sources:** [WebSockets/Constants.cs:3-25]()\n\n### Action Descriptions\n\n| Action | Origin | Purpose | Payload Type |\n|--------|--------|---------|--------------|\n| `update-ooxml` | Word | Send document changes from Word to server | docx |\n| `get-html` | Client | Request current HTML content from server | html |\n| `end-session` | Client/Word | Terminate the current session | N/A |\n| `session-closed` | Server | Notify clients that session has ended | N/A |\n| `init` | Client/Word | Initialize WebSocket connection | N/A |\n\n**Sources:** [WebSockets/Constants.cs:5-10]()\n\n## Communication Patterns\n\nThe WebSocket protocol supports bidirectional communication between multiple client types and the server, enabling real-time document synchronization.\n\n### Session Initialization Flow\n\n```mermaid\nsequenceDiagram\n    participant WebClient as \"Web Client\"\n    participant Server as \"WebSocket Handler\"\n    participant WordApp as \"Microsoft Word\"\n    participant SessionStore as \"Session Storage\"\n    \n    Note over WebClient,SessionStore: Connection Establishment\n    WebClient-\u003e\u003eServer: \"SocketMessageRequest\"\u003cbr/\u003eAction: \"init\"\u003cbr/\u003eOrigin: \"client\"\u003cbr/\u003eToken: \"[auth-token]\"\n    Server-\u003e\u003eSessionStore: \"Register client socket\"\n    Server--\u003e\u003eWebClient: \"SocketMessageResponse\"\u003cbr/\u003eSuccess: true\n    \n    WordApp-\u003e\u003eServer: \"SocketMessageRequest\"\u003cbr/\u003eAction: \"init\"\u003cbr/\u003eOrigin: \"word\"\u003cbr/\u003eSessionId: \"[session-id]\"\n    Server-\u003e\u003eSessionStore: \"Register Word socket\"\n    Server--\u003e\u003eWordApp: \"SocketMessageResponse\"\u003cbr/\u003eSuccess: true\n```\n\n**Sources:** [WebSockets/Constants.cs:9](), [Models/SocketMessageRequest.cs:5-14](), [Models/SocketMessageRequest.cs:16-24]()\n\n### Document Update Flow\n\n```mermaid\nsequenceDiagram\n    participant WordApp as \"Microsoft Word\"\n    participant Server as \"WebSocket Handler\"\n    participant WebClient as \"Web Client\"\n    participant ConversionService as \"Conversion Service\"\n    \n    Note over WordApp,ConversionService: Real-time Document Synchronization\n    WordApp-\u003e\u003eServer: \"SocketMessageRequest\"\u003cbr/\u003eAction: \"update-ooxml\"\u003cbr/\u003eOrigin: \"word\"\u003cbr/\u003ePayloadType: \"docx\"\u003cbr/\u003eContent: \"[ooxml-data]\"\n    \n    Server-\u003e\u003eConversionService: \"Convert OOXML to HTML\"\n    ConversionService--\u003e\u003eServer: \"HTML content\"\n    \n    Server-\u003e\u003eWebClient: \"SocketMessageResponse\"\u003cbr/\u003eAction: \"update-ooxml\"\u003cbr/\u003eOrigin: \"server\"\u003cbr/\u003ePayloadType: \"html\"\u003cbr/\u003eContent: \"[html-content]\"\u003cbr/\u003eSuccess: true\n```\n\n**Sources:** [WebSockets/Constants.cs:5](), [WebSockets/Constants.cs:15-16](), [Models/SocketMessageRequest.cs:5-14]()\n\n### HTML Request Flow\n\n```mermaid\nsequenceDiagram\n    participant WebClient as \"Web Client\"\n    participant Server as \"WebSocket Handler\"\n    participant SessionStore as \"Session Storage\"\n    \n    WebClient-\u003e\u003eServer: \"SocketMessageRequest\"\u003cbr/\u003eAction: \"get-html\"\u003cbr/\u003eOrigin: \"client\"\u003cbr/\u003eSessionId: \"[session-id]\"\n    \n    Server-\u003e\u003eSessionStore: \"Retrieve HTML content\"\n    SessionStore--\u003e\u003eServer: \"Current HTML state\"\n    \n    Server--\u003e\u003eWebClient: \"SocketMessageResponse\"\u003cbr/\u003eAction: \"get-html\"\u003cbr/\u003eOrigin: \"server\"\u003cbr/\u003ePayloadType: \"html\"\u003cbr/\u003eContent: \"[html-content]\"\u003cbr/\u003eSuccess: true\n```\n\n**Sources:** [WebSockets/Constants.cs:6](), [WebSockets/Constants.cs:15](), [Models/SocketMessageRequest.cs:5-14]()\n\n### Session Termination Flow\n\n```mermaid\nsequenceDiagram\n    participant WebClient as \"Web Client\"\n    participant Server as \"WebSocket Handler\"\n    participant WordApp as \"Microsoft Word\"\n    participant SessionStore as \"Session Storage\"\n    \n    WebClient-\u003e\u003eServer: \"SocketMessageRequest\"\u003cbr/\u003eAction: \"end-session\"\u003cbr/\u003eOrigin: \"client\"\n    \n    Server-\u003e\u003eSessionStore: \"Remove session data\"\n    Server-\u003e\u003eWordApp: \"SocketMessageResponse\"\u003cbr/\u003eAction: \"session-closed\"\u003cbr/\u003eOrigin: \"server\"\n    Server--\u003e\u003eWebClient: \"SocketMessageResponse\"\u003cbr/\u003eAction: \"session-closed\"\u003cbr/\u003eOrigin: \"server\"\n```\n\n**Sources:** [WebSockets/Constants.cs:7-8](), [Models/SocketMessageRequest.cs:5-14]()\n\n## Error Handling\n\nWhen errors occur during WebSocket communication, the server responds with `SocketMessageError` objects that include specific error codes for debugging and localization.\n\n### Error Message Structure\n\n```mermaid\nclassDiagram\n    class SocketMessageError {\n        +string Origin = \"server\"\n        +string SessionId\n        +string Action\n        +string Content = \"[error-message]\"\n        +bool? Success = false\n        +string ErrorCode = \"[error-code]\"\n    }\n    \n    class ISocketMessage {\n        \u003c\u003cinterface\u003e\u003e\n    }\n    \n    ISocketMessage \u003c|-- SocketMessageError\n```\n\n**Sources:** [Models/SocketMessageRequest.cs:27-35]()\n\n### Error Response Pattern\n\n```mermaid\nsequenceDiagram\n    participant Client as \"Any Client\"\n    participant Server as \"WebSocket Handler\"\n    \n    Client-\u003e\u003eServer: \"Invalid SocketMessageRequest\"\n    Server--\u003e\u003eClient: \"SocketMessageError\"\u003cbr/\u003eOrigin: \"server\"\u003cbr/\u003eSuccess: false\u003cbr/\u003eErrorCode: \"[specific-error]\"\u003cbr/\u003eContent: \"[error-description]\"\n```\n\n**Sources:** [Models/SocketMessageRequest.cs:27-35]()\n\n## Message Examples\n\n### Successful HTML Update from Word\n\n```json\n{\n  \"Origin\": \"word\",\n  \"SessionId\": \"session-123\",\n  \"PayloadType\": \"docx\",\n  \"Action\": \"update-ooxml\",\n  \"Content\": \"[base64-encoded-ooxml]\",\n  \"Success\": true\n}\n```\n\n### HTML Content Request\n\n```json\n{\n  \"Origin\": \"client\",\n  \"Token\": \"auth-token-xyz\",\n  \"SessionId\": \"session-123\",\n  \"Action\": \"get-html\",\n  \"Content\": \"\",\n  \"Success\": null\n}\n```\n\n### Error Response\n\n```json\n{\n  \"Origin\": \"server\",\n  \"SessionId\": \"session-123\",\n  \"Action\": \"get-html\",\n  \"Content\": \"Session not found\",\n  \"Success\": false,\n  \"ErrorCode\": \"E1001\"\n}\n```\n\n**Sources:** [Models/SocketMessageRequest.cs:5-14](), [Models/SocketMessageRequest.cs:16-24](), [Models/SocketMessageRequest.cs:27-35]()"])</script><script>self.__next_f.push([1,"24:T26c1,"])</script><script>self.__next_f.push([1,"# Error Handling\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Exceptions/HttpErrorCodes.cs](Exceptions/HttpErrorCodes.cs)\n- [Exceptions/WebSocketErrorCodes.cs](Exceptions/WebSocketErrorCodes.cs)\n\n\u003c/details\u003e\n\n\n\nThis document provides a comprehensive overview of the error handling system in IstgHtmlDocxConvertService. It covers the standardized error code system, response patterns, and localization support used throughout the service for both HTTP API operations and WebSocket communication.\n\nFor detailed information about specific error codes, see [HTTP Error Codes](#6.1) and [WebSocket Error Codes](#6.2). For information about the logging system that captures these errors, see [Logging System](#7.2).\n\n## Error Code Architecture\n\nThe service implements a structured error handling system with two primary error code categories: HTTP errors for REST API operations and WebSocket errors for real-time communication. Both systems follow consistent patterns and provide bilingual error messaging.\n\n### Error Code Taxonomy\n\n```mermaid\ngraph TB\n    subgraph \"Error Code System\"\n        ErrorCodes[\"Error Code Categories\"]\n        \n        subgraph \"HTTP Error Codes (H-prefix)\"\n            H1xxx[\"H1xxx: Client Errors\"]\n            H2xxx[\"H2xxx: Server Errors\"]\n            \n            H1001[\"H1001: InvalidRequest\"]\n            H1002[\"H1002: Unauthorized\"]\n            H1003[\"H1003: Forbidden\"]\n            H1004[\"H1004: NotFound\"]\n            H1005[\"H1005: InvalidModelState\"]\n            H1006[\"H1006: NewSessionIsNotAllowed\"]\n            H1007[\"H1007: FailedToGenerateWordLink\"]\n            \n            H2001[\"H2001: InternalServerError\"]\n            H2002[\"H2002: ServiceUnavailable\"]\n        end\n        \n        subgraph \"WebSocket Error Codes (E-prefix)\"\n            E1xxx[\"E1xxx: Client Errors\"]\n            E2xxx[\"E2xxx: Server Errors\"]\n            \n            E1001[\"E1001: SessionNotFound\"]\n            E1002[\"E1002: MissingToken\"]\n            E1003[\"E1003: InvalidToken\"]\n            E1004[\"E1004: InvalidAction\"]\n            E1005[\"E1005: SessionExpired\"]\n            E1006[\"E1006: SessionExpiredOrRemoved\"]\n            E1007[\"E1007: SocketNotAuthenticated\"]\n            \n            E2001[\"E2001: MessageProcessingError\"]\n            E2002[\"E2002: ConversionError\"]\n            E2003[\"E2003: SendError\"]\n        end\n    end\n    \n    ErrorCodes --\u003e H1xxx\n    ErrorCodes --\u003e H2xxx\n    ErrorCodes --\u003e E1xxx\n    ErrorCodes --\u003e E2xxx\n    \n    H1xxx --\u003e H1001\n    H1xxx --\u003e H1002\n    H1xxx --\u003e H1003\n    H1xxx --\u003e H1004\n    H1xxx --\u003e H1005\n    H1xxx --\u003e H1006\n    H1xxx --\u003e H1007\n    \n    H2xxx --\u003e H2001\n    H2xxx --\u003e H2002\n    \n    E1xxx --\u003e E1001\n    E1xxx --\u003e E1002\n    E1xxx --\u003e E1003\n    E1xxx --\u003e E1004\n    E1xxx --\u003e E1005\n    E1xxx --\u003e E1006\n    E1xxx --\u003e E1007\n    \n    E2xxx --\u003e E2001\n    E2xxx --\u003e E2002\n    E2xxx --\u003e E2003\n```\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:5-17](), [Exceptions/WebSocketErrorCodes.cs:5-14]()\n\n## Error Code Structure\n\nBoth error code systems follow a consistent structure with categorized numeric codes and bilingual messaging support.\n\n| System | Prefix | Client Errors | Server Errors | Language Support |\n|--------|--------|---------------|---------------|------------------|\n| HTTP API | H | H1xxx | H2xxx | Farsi, English |\n| WebSocket | E | E1xxx | E2xxx | Farsi, English |\n\n### HTTP Error Categories\n\n| Error Code | Category | Description |\n|------------|----------|-------------|\n| H1001 | Client | Invalid request format or parameters |\n| H1002 | Client | Missing or invalid authentication |\n| H1003 | Client | Insufficient permissions |\n| H1004 | Client | Requested resource not found |\n| H1005 | Client | Model validation failed |\n| H1006 | Client | Session creation not permitted |\n| H1007 | Client | Word link generation failed |\n| H2001 | Server | Internal processing error |\n| H2002 | Server | Service temporarily unavailable |\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:7-16]()\n\n### WebSocket Error Categories\n\n| Error Code | Category | Description |\n|------------|----------|-------------|\n| E1001 | Client | Session not found in storage |\n| E1002 | Client | Authentication token missing |\n| E1003 | Client | Authentication token invalid |\n| E1004 | Client | Unknown or invalid action |\n| E1005 | Client | Session has expired |\n| E1006 | Client | Session expired or manually removed |\n| E1007 | Client | WebSocket connection not authenticated |\n| E2001 | Server | Error processing WebSocket message |\n| E2002 | Server | Document conversion failed |\n| E2003 | Server | Error sending WebSocket message |\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:5-14]()\n\n## Localization System\n\nThe error handling system provides comprehensive bilingual support for both Farsi and English languages through structured message dictionaries.\n\n### Message Resolution Flow\n\n```mermaid\ngraph LR\n    subgraph \"Error Message Resolution\"\n        ErrorCode[\"Error Code\"]\n        GetMessage[\"GetMessage()\"]\n        LanguageParam[\"Language Parameter\"]\n        MessageDict[\"Messages Dictionary\"]\n        LocalizedMsg[\"Localized Message\"]\n        FallbackMsg[\"Unknown Error Fallback\"]\n        \n        ErrorCode --\u003e GetMessage\n        LanguageParam --\u003e GetMessage\n        GetMessage --\u003e MessageDict\n        MessageDict --\u003e LocalizedMsg\n        MessageDict --\u003e FallbackMsg\n        \n        subgraph \"Language Options\"\n            EnglishLang[\"'en' (default)\"]\n            FarsiLang[\"'fa'\"]\n        end\n        \n        LanguageParam --\u003e EnglishLang\n        LanguageParam --\u003e FarsiLang\n    end\n```\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:32-38](), [Exceptions/WebSocketErrorCodes.cs:30-36]()\n\n### Error Message Implementation\n\nBoth `HttpErrorCodes` and `WebSocketErrorCodes` classes implement identical message resolution patterns:\n\n```csharp\n// Method signature pattern used in both classes\npublic static string GetMessage(string code, string lang = \"en\")\n```\n\nThe message resolution follows this logic:\n1. Check if error code exists in message dictionary\n2. Return appropriate language message (Farsi or English)\n3. Fall back to \"Unknown error\" message if code not found\n4. Default language is English when not specified\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:32-38](), [Exceptions/WebSocketErrorCodes.cs:30-36]()\n\n## Error Response Integration\n\nThe error code system integrates with the service's response patterns and logging infrastructure to provide consistent error handling across all communication channels.\n\n### Error Handling Flow\n\n```mermaid\ngraph TB\n    subgraph \"Error Generation Sources\"\n        ConversionService[\"ConversionService\"]\n        TokenValidationService[\"TokenValidationService\"]\n        SessionStorageService[\"SessionStorageService\"]\n        WebSocketHandler[\"WebSocketHandler\"]\n        Controllers[\"HTTP Controllers\"]\n    end\n    \n    subgraph \"Error Code Systems\"\n        HttpErrorCodes[\"HttpErrorCodes\"]\n        WebSocketErrorCodes[\"WebSocketErrorCodes\"]\n    end\n    \n    subgraph \"Error Response Types\"\n        ConversionResponse[\"ConversionResponse\"]\n        EditInWordError[\"EditInWordConversionError\"]\n        SocketMessageError[\"SocketMessageError\"]\n    end\n    \n    subgraph \"Error Delivery\"\n        HttpResponse[\"HTTP Response\"]\n        WebSocketMessage[\"WebSocket Message\"]\n        SystemEventLogger[\"SystemEventLogger\"]\n    end\n    \n    ConversionService --\u003e HttpErrorCodes\n    TokenValidationService --\u003e HttpErrorCodes\n    Controllers --\u003e HttpErrorCodes\n    \n    SessionStorageService --\u003e WebSocketErrorCodes\n    WebSocketHandler --\u003e WebSocketErrorCodes\n    \n    HttpErrorCodes --\u003e ConversionResponse\n    HttpErrorCodes --\u003e EditInWordError\n    WebSocketErrorCodes --\u003e SocketMessageError\n    \n    ConversionResponse --\u003e HttpResponse\n    EditInWordError --\u003e HttpResponse\n    SocketMessageError --\u003e WebSocketMessage\n    \n    HttpErrorCodes --\u003e SystemEventLogger\n    WebSocketErrorCodes --\u003e SystemEventLogger\n```\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:1-40](), [Exceptions/WebSocketErrorCodes.cs:1-38]()\n\n## Error Code Usage Patterns\n\n### HTTP API Error Handling\n\nHTTP errors are primarily used in controller responses and service validation:\n\n- **Authentication Errors**: `H1002` (Unauthorized), `H1003` (Forbidden)\n- **Validation Errors**: `H1001` (InvalidRequest), `H1005` (InvalidModelState)\n- **Resource Errors**: `H1004` (NotFound)\n- **Business Logic Errors**: `H1006` (NewSessionIsNotAllowed), `H1007` (FailedToGenerateWordLink)\n- **System Errors**: `H2001` (InternalServerError), `H2002` (ServiceUnavailable)\n\n### WebSocket Error Handling\n\nWebSocket errors handle real-time communication failures and session management:\n\n- **Session Errors**: `E1001` (SessionNotFound), `E1005` (SessionExpired), `E1006` (SessionExpiredOrRemoved)\n- **Authentication Errors**: `E1002` (MissingToken), `E1003` (InvalidToken), `E1007` (SocketNotAuthenticated)\n- **Protocol Errors**: `E1004` (InvalidAction)\n- **Processing Errors**: `E2001` (MessageProcessingError), `E2002` (ConversionError), `E2003` (SendError)\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:19-30](), [Exceptions/WebSocketErrorCodes.cs:16-28]()\n\n## Error Code Constants\n\nBoth error code classes use static constants for type-safe error code references throughout the codebase:\n\n### HTTP Error Code Constants\n- Defined in `HttpErrorCodes.Codes` nested class\n- Pattern: String constants with descriptive names\n- Example: `public const string InvalidRequest = \"H1001\"`\n\n### WebSocket Error Code Constants  \n- Defined directly in `WebSocketErrorCodes` class\n- Pattern: String constants with descriptive names\n- Example: `public const string SessionNotFound = \"E1001\"`\n\nThis approach ensures compile-time checking of error codes and prevents typos in error code usage throughout the service.\n\n**Sources:** [Exceptions/HttpErrorCodes.cs:5-17](), [Exceptions/WebSocketErrorCodes.cs:5-14]()"])</script><script>self.__next_f.push([1,"25:T1b41,"])</script><script>self.__next_f.push([1,"# HTTP Error Codes\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Exceptions/HttpErrorCodes.cs](Exceptions/HttpErrorCodes.cs)\n\n\u003c/details\u003e\n\n\n\nThis document describes the HTTP error code system used by the IstgHtmlDocxConvertService for standardized error reporting across REST API endpoints. The system provides structured error codes with localized messages in both English and Farsi.\n\nFor WebSocket-specific error handling, see [WebSocket Error Codes](#6.2). For general error handling patterns and response structures, see [Error Handling](#6).\n\n## Error Code Architecture\n\nThe HTTP error code system is implemented as a centralized static class that defines structured error codes with multilingual support.\n\n```mermaid\ngraph TB\n    subgraph HttpErrorCodes[\"HttpErrorCodes Class\"]\n        CodesNested[\"Codes (Nested Class)\"]\n        MessagesDict[\"Messages Dictionary\"]\n        GetMessageMethod[\"GetMessage() Method\"]\n    end\n    \n    subgraph ErrorCategories[\"Error Categories\"]\n        H1xxx[\"H1xxx: Client Errors\"]\n        H2xxx[\"H2xxx: Server Errors\"]\n    end\n    \n    subgraph LocalizationSupport[\"Localization Support\"]\n        FarsiMessages[\"Farsi Messages\"]\n        EnglishMessages[\"English Messages\"]\n        LanguageParam[\"Language Parameter\"]\n    end\n    \n    CodesNested --\u003e H1xxx\n    CodesNested --\u003e H2xxx\n    MessagesDict --\u003e FarsiMessages\n    MessagesDict --\u003e EnglishMessages\n    GetMessageMethod --\u003e LanguageParam\n    GetMessageMethod --\u003e MessagesDict\n    \n    H1xxx --\u003e InvalidRequest[\"H1001: InvalidRequest\"]\n    H1xxx --\u003e Unauthorized[\"H1002: Unauthorized\"]\n    H1xxx --\u003e Forbidden[\"H1003: Forbidden\"]\n    H1xxx --\u003e NotFound[\"H1004: NotFound\"]\n    H1xxx --\u003e InvalidModelState[\"H1005: InvalidModelState\"]\n    H1xxx --\u003e NewSessionIsNotAllowed[\"H1006: NewSessionIsNotAllowed\"]\n    H1xxx --\u003e FailedToGenerateWordLink[\"H1007: FailedToGenerateWordLink\"]\n    \n    H2xxx --\u003e InternalServerError[\"H2001: InternalServerError\"]\n    H2xxx --\u003e ServiceUnavailable[\"H2002: ServiceUnavailable\"]\n```\n\nSources: [Exceptions/HttpErrorCodes.cs:1-40]()\n\n## Error Code Structure\n\nThe HTTP error codes follow a hierarchical numbering system that categorizes errors by responsibility:\n\n- **H1xxx**: Client-side errors (4xx HTTP status codes)\n- **H2xxx**: Server-side errors (5xx HTTP status codes)\n\n```mermaid\ngraph LR\n    subgraph ClientErrors[\"Client Errors (H1xxx)\"]\n        H1001[\"H1001\u003cbr/\u003eInvalidRequest\"]\n        H1002[\"H1002\u003cbr/\u003eUnauthorized\"]\n        H1003[\"H1003\u003cbr/\u003eForbidden\"]\n        H1004[\"H1004\u003cbr/\u003eNotFound\"]\n        H1005[\"H1005\u003cbr/\u003eInvalidModelState\"]\n        H1006[\"H1006\u003cbr/\u003eNewSessionIsNotAllowed\"]\n        H1007[\"H1007\u003cbr/\u003eFailedToGenerateWordLink\"]\n    end\n    \n    subgraph ServerErrors[\"Server Errors (H2xxx)\"]\n        H2001[\"H2001\u003cbr/\u003eInternalServerError\"]\n        H2002[\"H2002\u003cbr/\u003eServiceUnavailable\"]\n    end\n```\n\nSources: [Exceptions/HttpErrorCodes.cs:7-16]()\n\n## Localization System\n\nThe error code system provides bilingual support with messages in both Farsi and English, implemented through a dictionary structure and retrieval method.\n\n```mermaid\ngraph TB\n    subgraph MessageRetrieval[\"Message Retrieval Flow\"]\n        ErrorCode[\"Error Code (e.g., H1001)\"]\n        GetMessageCall[\"GetMessage(code, lang)\"]\n        MessagesLookup[\"Messages Dictionary Lookup\"]\n        LanguageCheck[\"Language Parameter Check\"]\n        FinalMessage[\"Localized Error Message\"]\n    end\n    \n    subgraph MessageStorage[\"Message Storage Structure\"]\n        MessagesDict[\"Messages Dictionary\u003cbr/\u003eDictionary\u0026lt;string, (string Fa, string En)\u0026gt;\"]\n        TupleStructure[\"Tuple Structure\u003cbr/\u003e(Fa: Farsi, En: English)\"]\n    end\n    \n    ErrorCode --\u003e GetMessageCall\n    GetMessageCall --\u003e MessagesLookup\n    MessagesLookup --\u003e MessagesDict\n    MessagesDict --\u003e TupleStructure\n    GetMessageCall --\u003e LanguageCheck\n    LanguageCheck --\u003e FinalMessage\n    \n    MessagesLookup --\u003e FallbackCheck[\"Code Exists Check\"]\n    FallbackCheck --\u003e DefaultMessage[\"Default: 'Unknown error' / 'خطای ناشناخته'\"]\n    DefaultMessage --\u003e FinalMessage\n```\n\nSources: [Exceptions/HttpErrorCodes.cs:19-38]()\n\n## Error Code Reference\n\n| Error Code | Constant Name | English Message | Farsi Message | Typical Usage |\n|------------|---------------|-----------------|---------------|---------------|\n| H1001 | `InvalidRequest` | Invalid request | درخواست نامعتبر | Malformed request data |\n| H1002 | `Unauthorized` | Unauthorized access | دسترسی غیرمجاز | Authentication failure |\n| H1003 | `Forbidden` | Forbidden | دسترسی غیرمجاز | Authorization failure |\n| H1004 | `NotFound` | Not found | یافت نشد | Resource not found |\n| H1005 | `InvalidModelState` | Invalid input data | داده‌های ورودی نامعتبر است | Model validation errors |\n| H1006 | `NewSessionIsNotAllowed` | Generating new session is not allowed | ایجاد نشست جدید مجاز نمی باشد | Session creation restrictions |\n| H1007 | `FailedToGenerateWordLink` | Failed to generate word link | تولید لینک فایل وورد با خطا مواجه شد | Word integration failures |\n| H2001 | `InternalServerError` | Internal server error | خطای داخلی سرور | Unhandled server exceptions |\n| H2002 | `ServiceUnavailable` | Service unavailable | سرویس در دسترس نیست | Service outages |\n\nSources: [Exceptions/HttpErrorCodes.cs:7-16](), [Exceptions/HttpErrorCodes.cs:21-29]()\n\n## Implementation Details\n\nThe `HttpErrorCodes` class is implemented as a static utility class with the following key components:\n\n### Constants Definition\nError codes are defined as string constants in the nested `Codes` class, ensuring type safety and preventing magic strings throughout the codebase.\n\n### Message Dictionary\nThe `Messages` dictionary maps error codes to tuples containing both Farsi and English translations, enabling runtime language selection.\n\n### Message Retrieval\nThe `GetMessage` method provides safe access to localized error messages with fallback handling for unknown error codes.\n\n```csharp\n// Example usage pattern\nstring errorCode = HttpErrorCodes.Codes.InvalidRequest;\nstring message = HttpErrorCodes.GetMessage(errorCode, \"en\");\n```\n\nSources: [Exceptions/HttpErrorCodes.cs:32-38]()\n\n## Error Code Usage Pattern\n\nThe error codes are designed to be used consistently across all HTTP API responses in the service, providing:\n\n1. **Structured Error Identification**: Each error has a unique alphanumeric code\n2. **Client-Server Error Distinction**: H1xxx vs H2xxx categorization\n3. **Internationalization**: Built-in support for multiple languages\n4. **Fallback Handling**: Graceful degradation for unknown error codes\n\nThis system enables clients to programmatically handle specific error conditions while providing human-readable messages in the user's preferred language.\n\nSources: [Exceptions/HttpErrorCodes.cs:1-40]()"])</script><script>self.__next_f.push([1,"26:T1dbc,"])</script><script>self.__next_f.push([1,"# WebSocket Error Codes\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Exceptions/WebSocketErrorCodes.cs](Exceptions/WebSocketErrorCodes.cs)\n\n\u003c/details\u003e\n\n\n\nThis document covers the WebSocket error code system used for real-time communication errors in the IstgHtmlDocxConvertService. These error codes are specifically designed for WebSocket connections and differ from the HTTP error codes used for REST API endpoints. For HTTP error codes, see [HTTP Error Codes](#6.1). For general WebSocket communication patterns, see [WebSocket Protocol](#5.2).\n\n## Error Code Structure\n\nThe WebSocket error code system uses a structured approach with alphanumeric codes that categorize different types of errors. All WebSocket error codes follow the pattern `E{category}{number}` where:\n\n- `E` indicates a WebSocket error (distinct from HTTP codes)\n- Category `1xxx` represents authentication and session-related errors\n- Category `2xxx` represents processing and operational errors\n\n```mermaid\ngraph TB\n    WebSocketErrors[\"WebSocketErrorCodes Class\"]\n    \n    subgraph \"E1xxx - Authentication \u0026 Session\"\n        E1001[\"E1001: SessionNotFound\"]\n        E1002[\"E1002: MissingToken\"]\n        E1003[\"E1003: InvalidToken\"]\n        E1004[\"E1004: InvalidAction\"]\n        E1005[\"E1005: SessionExpired\"]\n        E1006[\"E1006: SessionExpiredOrRemoved\"]\n        E1007[\"E1007: SocketNotAuthenticated\"]\n    end\n    \n    subgraph \"E2xxx - Processing \u0026 Operations\"\n        E2001[\"E2001: MessageProcessingError\"]\n        E2002[\"E2002: ConversionError\"]\n        E2003[\"E2003: SendError\"]\n    end\n    \n    WebSocketErrors --\u003e E1001\n    WebSocketErrors --\u003e E1002\n    WebSocketErrors --\u003e E1003\n    WebSocketErrors --\u003e E1004\n    WebSocketErrors --\u003e E1005\n    WebSocketErrors --\u003e E1006\n    WebSocketErrors --\u003e E1007\n    WebSocketErrors --\u003e E2001\n    WebSocketErrors --\u003e E2002\n    WebSocketErrors --\u003e E2003\n```\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:1-38]()\n\n## Authentication and Session Errors (E1xxx)\n\nThese error codes handle issues related to user authentication, session management, and WebSocket connection validation.\n\n| Error Code | Constant Name | English Message | Farsi Message |\n|------------|---------------|-----------------|---------------|\n| E1001 | `SessionNotFound` | Session not found | نشست یافت نشد |\n| E1002 | `MissingToken` | Missing authentication token | توکن احراز هویت موجود نیست |\n| E1003 | `InvalidToken` | Invalid token | توکن نامعتبر است |\n| E1004 | `InvalidAction` | Invalid action | عملیات نامعتبر است |\n| E1005 | `SessionExpired` | Session expired | نشست منقضی شده است |\n| E1006 | `SessionExpiredOrRemoved` | Session expired or removed | نشست منقضی یا پاک شده است |\n| E1007 | `SocketNotAuthenticated` | Socket not authenticated | سوکت احراز هویت نشده است |\n\n### Error Scenarios\n\n- **E1001 (SessionNotFound)**: Occurs when a WebSocket client attempts to connect or perform actions with a session ID that doesn't exist in the session storage\n- **E1002 (MissingToken)**: Triggered when a WebSocket connection attempt lacks the required authentication token\n- **E1003 (InvalidToken)**: Returned when the provided authentication token fails validation\n- **E1004 (InvalidAction)**: Sent when a WebSocket message contains an unrecognized or invalid action type\n- **E1005 (SessionExpired)**: Used when a session has exceeded its timeout period\n- **E1006 (SessionExpiredOrRemoved)**: Indicates a session was either expired or manually removed from storage\n- **E1007 (SocketNotAuthenticated)**: Occurs when an unauthenticated WebSocket attempts to perform authenticated actions\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:5-11](), [Exceptions/WebSocketErrorCodes.cs:18-24]()\n\n## Processing and Operational Errors (E2xxx)\n\nThese error codes handle issues during message processing, document conversion, and WebSocket communication operations.\n\n| Error Code | Constant Name | English Message | Farsi Message |\n|------------|---------------|-----------------|---------------|\n| E2001 | `MessageProcessingError` | Error processing message | خطا در پردازش پیام |\n| E2002 | `ConversionError` | Conversion error | خطا در تبدیل محتوا |\n| E2003 | `SendError` | Error sending message | خطا در ارسال پیام |\n\n### Error Scenarios\n\n- **E2001 (MessageProcessingError)**: General error during WebSocket message parsing or handling\n- **E2002 (ConversionError)**: Specific error during document conversion operations triggered via WebSocket\n- **E2003 (SendError)**: Error when attempting to send a WebSocket message to a client\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:12-14](), [Exceptions/WebSocketErrorCodes.cs:25-27]()\n\n## Localization System\n\nThe WebSocket error code system supports bilingual error messages in English and Farsi (Persian). The localization is implemented using a static dictionary that maps error codes to message tuples.\n\n```mermaid\ngraph LR\n    ErrorCode[\"Error Code (e.g., E1001)\"]\n    GetMessage[\"GetMessage(code, lang)\"]\n    MessageDict[\"Messages Dictionary\"]\n    \n    subgraph \"Message Tuple\"\n        FarsiMsg[\"Farsi Message\"]\n        EnglishMsg[\"English Message\"]\n    end\n    \n    DefaultMsg[\"Default Message\"]\n    \n    ErrorCode --\u003e GetMessage\n    GetMessage --\u003e MessageDict\n    MessageDict --\u003e FarsiMsg\n    MessageDict --\u003e EnglishMsg\n    GetMessage --\u003e DefaultMsg\n    \n    GetMessage -.-\u003e|\"lang='fa'\"| FarsiMsg\n    GetMessage -.-\u003e|\"lang='en'\"| EnglishMsg\n    GetMessage -.-\u003e|\"unknown code\"| DefaultMsg\n```\n\n### Message Retrieval\n\nThe `GetMessage` method provides localized error messages with the following behavior:\n\n- **Default Language**: English (`\"en\"`)\n- **Supported Languages**: English (`\"en\"`) and Farsi (`\"fa\"`)\n- **Fallback Behavior**: Returns \"Unknown error\" (English) or \"خطای ناشناخته\" (Farsi) for unrecognized error codes\n\n```csharp\n// Usage example\nstring errorMsg = WebSocketErrorCodes.GetMessage(\"E1001\", \"en\");\n// Returns: \"Session not found\"\n\nstring farsiErrorMsg = WebSocketErrorCodes.GetMessage(\"E1001\", \"fa\");  \n// Returns: \"نشست یافت نشد\"\n```\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:16-28](), [Exceptions/WebSocketErrorCodes.cs:30-37]()\n\n## Integration with WebSocket System\n\nThe WebSocket error codes integrate with the broader WebSocket communication system to provide consistent error reporting across all real-time operations.\n\n```mermaid\nsequenceDiagram\n    participant Client\n    participant WebSocketHandler\n    participant WebSocketErrorCodes\n    participant SessionStorage\n    \n    Client-\u003e\u003eWebSocketHandler: \"Connect with invalid token\"\n    WebSocketHandler-\u003e\u003eWebSocketErrorCodes: \"GetMessage(E1003, 'en')\"\n    WebSocketErrorCodes--\u003e\u003eWebSocketHandler: \"Invalid token\"\n    WebSocketHandler--\u003e\u003eClient: \"SocketMessageError with E1003\"\n    \n    Client-\u003e\u003eWebSocketHandler: \"Action on expired session\"\n    WebSocketHandler-\u003e\u003eSessionStorage: \"Check session\"\n    SessionStorage--\u003e\u003eWebSocketHandler: \"Session not found\"\n    WebSocketHandler-\u003e\u003eWebSocketErrorCodes: \"GetMessage(E1005, 'en')\"\n    WebSocketErrorCodes--\u003e\u003eWebSocketHandler: \"Session expired\"\n    WebSocketHandler--\u003e\u003eClient: \"SocketMessageError with E1005\"\n```\n\n### Error Response Format\n\nWebSocket error responses typically use the `SocketMessageError` structure which incorporates these error codes to provide standardized error information to connected clients.\n\n**Sources:** [Exceptions/WebSocketErrorCodes.cs:1-38]()"])</script><script>self.__next_f.push([1,"27:T2594,"])</script><script>self.__next_f.push([1,"# Configuration and Deployment\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Logging/SystemEventLogger.cs](Logging/SystemEventLogger.cs)\n- [Program.cs](Program.cs)\n- [Properties/PublishProfiles/FolderProfile.pubxml](Properties/PublishProfiles/FolderProfile.pubxml)\n\n\u003c/details\u003e\n\n\n\nThis document covers the configuration, setup, and deployment procedures for the IstgHtmlDocxConvertService. It explains application startup configuration, dependency injection setup, logging system integration, and deployment processes. For information about the overall system architecture, see [System Architecture](#2). For development environment setup, see [Development Setup](#8).\n\n## Application Configuration Overview\n\nThe service uses ASP.NET Core's standard configuration system with dependency injection for service management. The main application bootstrap occurs in `Program.cs`, which configures services, middleware pipeline, and external dependencies.\n\n### Service Registration and Dependency Injection\n\n```mermaid\ngraph TB\n    subgraph \"Application Bootstrap\"\n        WebApplicationBuilder[\"WebApplication.CreateBuilder(args)\"]\n        IConfiguration[\"IConfiguration\"]\n        ServiceCollection[\"builder.Services\"]\n    end\n    \n    subgraph \"Service Registration\"\n        Controllers[\"AddControllers()\"]\n        Swagger[\"AddSwaggerGen()\"]\n        CORS[\"AddCors()\"]\n    end\n    \n    subgraph \"Custom Services\"\n        SystemEventLogger[\"AddSingleton\u003cSystemEventLogger\u003e()\"]\n        SessionStorageService[\"AddSingleton\u003cSessionStorageService\u003e()\"]\n        SessionCleanupService[\"AddHostedService\u003cSessionCleanupService\u003e()\"]\n        ConversionService[\"AddScoped\u003cConversionService\u003e()\"]\n        HtmlService[\"AddTransient\u003cHtmlService\u003e()\"]\n        WebSocketHandler[\"AddScoped\u003cWebSocketHandler\u003e()\"]\n        TokenValidationService[\"AddScoped\u003cTokenValidationService\u003e()\"]\n    end\n    \n    subgraph \"Middleware Pipeline\"\n        UseSwagger[\"UseSwagger()\"]\n        UseSwaggerUI[\"UseSwaggerUI()\"]\n        UseHttpsRedirection[\"UseHttpsRedirection()\"]\n        UseCors[\"UseCors('CorsPolicy')\"]\n        UseWebSockets[\"UseWebSockets()\"]\n        WebSocketMiddleware[\"WebSocket Custom Middleware\"]\n        MapControllers[\"MapControllers()\"]\n    end\n    \n    WebApplicationBuilder --\u003e IConfiguration\n    WebApplicationBuilder --\u003e ServiceCollection\n    \n    ServiceCollection --\u003e Controllers\n    ServiceCollection --\u003e Swagger\n    ServiceCollection --\u003e CORS\n    ServiceCollection --\u003e SystemEventLogger\n    ServiceCollection --\u003e SessionStorageService\n    ServiceCollection --\u003e SessionCleanupService\n    ServiceCollection --\u003e ConversionService\n    ServiceCollection --\u003e HtmlService\n    ServiceCollection --\u003e WebSocketHandler\n    ServiceCollection --\u003e TokenValidationService\n    \n    ServiceCollection --\u003e UseSwagger\n    UseSwagger --\u003e UseSwaggerUI\n    UseSwaggerUI --\u003e UseHttpsRedirection\n    UseHttpsRedirection --\u003e UseCors\n    UseCors --\u003e UseWebSockets\n    UseWebSockets --\u003e WebSocketMiddleware\n    WebSocketMiddleware --\u003e MapControllers\n```\n\n**Sources:** [Program.cs:5-25](), [Program.cs:42-74]()\n\n### Service Lifecycle Configuration\n\nThe application registers services with different lifecycles based on their usage patterns:\n\n| Service | Lifecycle | Purpose |\n|---------|-----------|---------|\n| `SystemEventLogger` | Singleton | Windows Event Log integration, shared across application |\n| `SessionStorageService` | Singleton | Thread-safe session storage using `ConcurrentDictionary` |\n| `SessionCleanupService` | Hosted Service | Background service for automatic session cleanup |\n| `ConversionService` | Scoped | Document conversion operations, per-request lifecycle |\n| `HtmlService` | Transient | HTML processing utilities, lightweight stateless operations |\n| `WebSocketHandler` | Scoped | WebSocket connection management, per-connection lifecycle |\n| `TokenValidationService` | Scoped | Authentication validation, per-request lifecycle |\n\n**Sources:** [Program.cs:19-25]()\n\n## Configuration Settings Structure\n\n### CORS Configuration\n\nThe application reads allowed origins from configuration and sets up CORS policy:\n\n```mermaid\ngraph LR\n    AppSettings[\"appsettings.json\"]\n    AllowedOrigins[\"AllowedOrigins[]\"]\n    CorsPolicy[\"CorsPolicy\"]\n    WithOrigins[\"WithOrigins()\"]\n    AllowAnyHeader[\"AllowAnyHeader()\"]\n    AllowAnyMethod[\"AllowAnyMethod()\"]\n    \n    AppSettings --\u003e AllowedOrigins\n    AllowedOrigins --\u003e CorsPolicy\n    CorsPolicy --\u003e WithOrigins\n    CorsPolicy --\u003e AllowAnyHeader\n    CorsPolicy --\u003e AllowAnyMethod\n```\n\n**Sources:** [Program.cs:27-40]()\n\n### Aspose License Configuration\n\nThe service requires Aspose.Words licensing configuration:\n\n```mermaid\ngraph TB\n    Configuration[\"IConfiguration\"]\n    LicensePath[\"Aspose:LicensePath\"]\n    FileExists[\"File.Exists()\"]\n    AsposeWordsLicense[\"new Aspose.Words.License()\"]\n    SetLicense[\"SetLicense(licensePath)\"]\n    ConsoleWarning[\"Console.WriteLine()\"]\n    \n    Configuration --\u003e LicensePath\n    LicensePath --\u003e FileExists\n    FileExists --\u003e|exists| AsposeWordsLicense\n    FileExists --\u003e|missing| ConsoleWarning\n    AsposeWordsLicense --\u003e SetLicense\n```\n\n**Sources:** [Program.cs:76-88]()\n\n## Logging System Configuration\n\n### SystemEventLogger Setup\n\nThe `SystemEventLogger` integrates with Windows Event Log system:\n\n```mermaid\ngraph TB\n    IConfiguration[\"IConfiguration\"]\n    LoggingSection[\"Logging:Name\"]\n    LogName[\"logName parameter\"]\n    EventLogSourceExists[\"EventLog.SourceExists()\"]\n    CreateEventSource[\"EventLog.CreateEventSource()\"]\n    SystemEventLogger[\"SystemEventLogger instance\"]\n    \n    subgraph \"Log Methods\"\n        Info[\"Info(message)\"]\n        Warn[\"Warn(message)\"]\n        Error[\"Error(message)\"]\n        WriteEntry[\"WriteEntry(message, type)\"]\n        EventLogWriteEntry[\"EventLog.WriteEntry()\"]\n    end\n    \n    IConfiguration --\u003e LoggingSection\n    LogName --\u003e SystemEventLogger\n    LoggingSection --\u003e SystemEventLogger\n    EventLogSourceExists --\u003e|false| CreateEventSource\n    CreateEventSource --\u003e SystemEventLogger\n    \n    SystemEventLogger --\u003e Info\n    SystemEventLogger --\u003e Warn\n    SystemEventLogger --\u003e Error\n    Info --\u003e WriteEntry\n    Warn --\u003e WriteEntry\n    Error --\u003e WriteEntry\n    WriteEntry --\u003e EventLogWriteEntry\n```\n\n**Sources:** [Logging/SystemEventLogger.cs:10-40]()\n\n### Event Log Entry Types\n\nThe logger supports three standard Windows Event Log entry types:\n\n| Method | Event Type | Usage |\n|--------|------------|-------|\n| `Info(string message)` | `EventLogEntryType.Information` | General information messages |\n| `Warn(string message)` | `EventLogEntryType.Warning` | Warning conditions |\n| `Error(string message)` | `EventLogEntryType.Error` | Error conditions and exceptions |\n\n**Sources:** [Logging/SystemEventLogger.cs:26-39]()\n\n## WebSocket Middleware Configuration\n\nThe application implements custom WebSocket middleware for real-time communication:\n\n```mermaid\ngraph TB\n    HTTPContext[\"HttpContext\"]\n    IsWebSocketRequest[\"context.WebSockets.IsWebSocketRequest\"]\n    CreateScope[\"app.Services.CreateScope()\"]\n    GetRequiredService[\"GetRequiredService\u003cWebSocketHandler\u003e()\"]\n    AcceptWebSocketAsync[\"context.WebSockets.AcceptWebSocketAsync()\"]\n    HandleAsync[\"handler.HandleAsync(webSocket)\"]\n    NextMiddleware[\"await next()\"]\n    \n    HTTPContext --\u003e IsWebSocketRequest\n    IsWebSocketRequest --\u003e|true| CreateScope\n    IsWebSocketRequest --\u003e|false| NextMiddleware\n    CreateScope --\u003e GetRequiredService\n    GetRequiredService --\u003e AcceptWebSocketAsync\n    AcceptWebSocketAsync --\u003e HandleAsync\n```\n\n**Sources:** [Program.cs:55-69]()\n\n## Deployment Configuration\n\n### Publish Profile Settings\n\nThe application includes a folder-based publish profile for deployment:\n\n```mermaid\ngraph LR\n    FolderProfile[\"FolderProfile.pubxml\"]\n    PropertyGroup[\"PropertyGroup\"]\n    \n    subgraph \"Deployment Settings\"\n        DeleteExistingFiles[\"DeleteExistingFiles: false\"]\n        ExcludeAppData[\"ExcludeApp_Data: false\"]\n        LaunchSiteAfterPublish[\"LaunchSiteAfterPublish: true\"]\n        BuildConfiguration[\"LastUsedBuildConfiguration: Release\"]\n        Platform[\"LastUsedPlatform: Any CPU\"]\n        PublishProvider[\"PublishProvider: FileSystem\"]\n        PublishUrl[\"PublishUrl: D:\\\\Release-Management\\\\IstgHtmlDocxConvertService\"]\n        WebPublishMethod[\"WebPublishMethod: FileSystem\"]\n        TargetId[\"_TargetId: Folder\"]\n    end\n    \n    FolderProfile --\u003e PropertyGroup\n    PropertyGroup --\u003e DeleteExistingFiles\n    PropertyGroup --\u003e ExcludeAppData\n    PropertyGroup --\u003e LaunchSiteAfterPublish\n    PropertyGroup --\u003e BuildConfiguration\n    PropertyGroup --\u003e Platform\n    PropertyGroup --\u003e PublishProvider\n    PropertyGroup --\u003e PublishUrl\n    PropertyGroup --\u003e WebPublishMethod\n    PropertyGroup --\u003e TargetId\n```\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:6-16]()\n\n### Deployment Settings Explained\n\n| Setting | Value | Purpose |\n|---------|-------|---------|\n| `DeleteExistingFiles` | `false` | Preserves existing files during deployment |\n| `ExcludeApp_Data` | `false` | Includes App_Data folder in deployment |\n| `LaunchSiteAfterPublish` | `true` | Automatically launches site after publishing |\n| `LastUsedBuildConfiguration` | `Release` | Uses Release build configuration |\n| `PublishProvider` | `FileSystem` | Publishes to file system (not cloud) |\n| `PublishUrl` | `D:\\Release-Management\\IstgHtmlDocxConvertService` | Target deployment directory |\n| `WebPublishMethod` | `FileSystem` | File system-based publishing method |\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:7-15]()"])</script><script>self.__next_f.push([1,"28:T21dc,"])</script><script>self.__next_f.push([1,"# Application Configuration\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [IstgHtmlDocxConvertService.csproj](IstgHtmlDocxConvertService.csproj)\n- [Program.cs](Program.cs)\n- [Properties/launchSettings.json](Properties/launchSettings.json)\n\n\u003c/details\u003e\n\n\n\nThis page covers the application startup process, dependency injection configuration, and configuration settings for the IstgHtmlDocxConvertService. It focuses on how the application initializes services, configures middleware, and loads configuration values during startup.\n\nFor information about logging configuration, see [Logging System](#7.2). For deployment and publishing configuration, see [Deployment and Publishing](#7.3).\n\n## Application Startup Process\n\nThe application follows the standard ASP.NET Core startup pattern using the `WebApplication.CreateBuilder` approach. The startup process is defined in the main entry point and handles service registration, configuration loading, and middleware pipeline setup.\n\n### Startup Flow\n\n```mermaid\nflowchart TD\n    A[\"WebApplication.CreateBuilder(args)\"] --\u003e B[\"Service Registration\"]\n    B --\u003e C[\"Configuration Loading\"]\n    C --\u003e D[\"WebApplication.Build()\"]\n    D --\u003e E[\"Middleware Pipeline Setup\"]\n    E --\u003e F[\"Aspose License Configuration\"]\n    F --\u003e G[\"app.Run()\"]\n    \n    B --\u003e B1[\"AddControllers()\"]\n    B --\u003e B2[\"AddSwaggerGen()\"]\n    B --\u003e B3[\"Service Dependencies\"]\n    B --\u003e B4[\"AddCors()\"]\n    \n    B3 --\u003e B31[\"SystemEventLogger (Singleton)\"]\n    B3 --\u003e B32[\"SessionStorageService (Singleton)\"]\n    B3 --\u003e B33[\"SessionCleanupService (HostedService)\"]\n    B3 --\u003e B34[\"ConversionService (Scoped)\"]\n    B3 --\u003e B35[\"HtmlService (Transient)\"]\n    B3 --\u003e B36[\"WebSocketHandler (Scoped)\"]\n    B3 --\u003e B37[\"TokenValidationService (Scoped)\"]\n    \n    E --\u003e E1[\"UseSwagger()\"]\n    E --\u003e E2[\"UseSwaggerUI()\"]\n    E --\u003e E3[\"UseHttpsRedirection()\"]\n    E --\u003e E4[\"UseCors()\"]\n    E --\u003e E5[\"UseWebSockets()\"]\n    E --\u003e E6[\"Custom WebSocket Middleware\"]\n    E --\u003e E7[\"UseAuthorization()\"]\n    E --\u003e E8[\"MapControllers()\"]\n```\n\nSources: [Program.cs:5-90]()\n\n## Dependency Injection Container\n\nThe application uses the built-in ASP.NET Core dependency injection container to register services with appropriate lifetimes based on their usage patterns and thread safety requirements.\n\n### Service Registration Configuration\n\n| Service | Lifetime | Purpose |\n|---------|----------|---------|\n| `SystemEventLogger` | Singleton | Windows Event Log integration |\n| `SessionStorageService` | Singleton | Thread-safe session storage |\n| `SessionCleanupService` | HostedService | Background session cleanup |\n| `ConversionService` | Scoped | Document conversion operations |\n| `HtmlService` | Transient | HTML processing utilities |\n| `WebSocketHandler` | Scoped | WebSocket connection management |\n| `TokenValidationService` | Scoped | Authentication token validation |\n\n### Service Dependencies Diagram\n\n```mermaid\ngraph TB\n    subgraph \"Singleton Services\"\n        SystemEventLogger[\"SystemEventLogger\"]\n        SessionStorageService[\"SessionStorageService\"]\n    end\n    \n    subgraph \"Background Services\"\n        SessionCleanupService[\"SessionCleanupService\"]\n    end\n    \n    subgraph \"Scoped Services\"\n        ConversionService[\"ConversionService\"]\n        WebSocketHandler[\"WebSocketHandler\"]\n        TokenValidationService[\"TokenValidationService\"]\n    end\n    \n    subgraph \"Transient Services\"\n        HtmlService[\"HtmlService\"]\n    end\n    \n    subgraph \"Framework Services\"\n        Controllers[\"Controllers\"]\n        SwaggerGen[\"SwaggerGen\"]\n        EndpointsApiExplorer[\"EndpointsApiExplorer\"]\n    end\n    \n    SessionCleanupService --\u003e SessionStorageService\n    ConversionService --\u003e HtmlService\n    WebSocketHandler --\u003e SessionStorageService\n    WebSocketHandler --\u003e ConversionService\n    WebSocketHandler --\u003e TokenValidationService\n    Controllers --\u003e ConversionService\n    Controllers --\u003e TokenValidationService\n```\n\nSources: [Program.cs:19-25](), [Program.cs:11-17]()\n\n## Configuration Sources\n\nThe application loads configuration from multiple sources following the standard ASP.NET Core configuration hierarchy. Configuration values are accessed through the `IConfiguration` interface.\n\n### Configuration Structure\n\n```mermaid\ngraph LR\n    subgraph \"Configuration Sources\"\n        A[\"appsettings.json\"]\n        B[\"appsettings.{Environment}.json\"]\n        C[\"Environment Variables\"]\n        D[\"Command Line Arguments\"]\n    end\n    \n    subgraph \"Configuration Sections\"\n        E[\"AllowedOrigins[]\"]\n        F[\"Aspose:LicensePath\"]\n        G[\"ConnectionStrings\"]\n        H[\"Logging\"]\n    end\n    \n    A --\u003e E\n    A --\u003e F\n    B --\u003e G\n    C --\u003e H\n    D --\u003e G\n    \n    subgraph \"Usage in Code\"\n        I[\"CORS Policy\"]\n        J[\"Aspose.Words.License\"]\n        K[\"TokenValidationService\"]\n        L[\"SystemEventLogger\"]\n    end\n    \n    E --\u003e I\n    F --\u003e J\n    G --\u003e K\n    H --\u003e L\n```\n\n### Key Configuration Sections\n\n| Section | Type | Usage |\n|---------|------|-------|\n| `AllowedOrigins` | `string[]` | CORS policy configuration |\n| `Aspose:LicensePath` | `string` | Aspose.Words license file path |\n| `ConnectionStrings` | `object` | Database connection configuration |\n| `Logging` | `object` | Logging level and provider settings |\n\nSources: [Program.cs:28](), [Program.cs:77]()\n\n## Middleware Pipeline Configuration\n\nThe middleware pipeline is configured in a specific order to ensure proper request processing flow. Each middleware component serves a distinct purpose in the request/response cycle.\n\n### Middleware Pipeline Order\n\n```mermaid\nflowchart TD\n    A[\"Incoming Request\"] --\u003e B[\"UseSwagger()\"]\n    B --\u003e C[\"UseSwaggerUI()\"]\n    C --\u003e D[\"UseHttpsRedirection()\"]\n    D --\u003e E[\"UseCors(CorsPolicy)\"]\n    E --\u003e F[\"UseWebSockets()\"]\n    F --\u003e G[\"Custom WebSocket Middleware\"]\n    G --\u003e H[\"UseAuthorization()\"]\n    H --\u003e I[\"MapControllers()\"]\n    I --\u003e J[\"Response\"]\n    \n    G --\u003e G1{\"WebSocket Request?\"}\n    G1 --\u003e|Yes| G2[\"WebSocketHandler.HandleAsync()\"]\n    G1 --\u003e|No| H\n    G2 --\u003e G3[\"WebSocket Response\"]\n```\n\n### WebSocket Middleware Implementation\n\nThe custom WebSocket middleware handles WebSocket connection requests by creating a scoped service provider and delegating to the `WebSocketHandler` service.\n\nSources: [Program.cs:46-74](), [Program.cs:55-69]()\n\n## CORS Configuration\n\nCross-Origin Resource Sharing (CORS) is configured to allow specific origins to access the API endpoints. The allowed origins are loaded from configuration to support different environments.\n\n### CORS Policy Setup\n\n```mermaid\ngraph TB\n    A[\"Configuration Section: AllowedOrigins\"] --\u003e B[\"Get\u003cstring[]\u003e()\"]\n    B --\u003e C[\"CORS Policy Builder\"]\n    C --\u003e D[\"WithOrigins(allowedOrigins)\"]\n    C --\u003e E[\"AllowAnyHeader()\"]\n    C --\u003e F[\"AllowAnyMethod()\"]\n    \n    D --\u003e G[\"CorsPolicy\"]\n    E --\u003e G\n    F --\u003e G\n    \n    G --\u003e H[\"app.UseCors(CorsPolicy)\"]\n```\n\nThe CORS policy is named `\"CorsPolicy\"` and allows:\n- Origins specified in the `AllowedOrigins` configuration array\n- Any HTTP headers\n- Any HTTP methods\n\nSources: [Program.cs:28](), [Program.cs:31-40](), [Program.cs:51]()\n\n## Aspose License Configuration\n\nThe Aspose.Words library requires a valid license file for production use. The license path is configured through the application settings and loaded during startup.\n\n### License Loading Process\n\n```mermaid\nflowchart TD\n    A[\"Read Aspose:LicensePath from Configuration\"] --\u003e B{\"File.Exists(licensePath)?\"}\n    B --\u003e|Yes| C[\"new Aspose.Words.License()\"]\n    B --\u003e|No| D[\"Console.WriteLine: License path missing\"]\n    C --\u003e E[\"SetLicense(licensePath)\"]\n    E --\u003e F[\"Aspose.Words Initialized\"]\n    D --\u003e G[\"Aspose.Words in Trial Mode\"]\n```\n\nThe license configuration:\n- Reads the `Aspose:LicensePath` setting from configuration\n- Validates the file exists before attempting to load\n- Initializes the Aspose.Words license if the file is found\n- Logs an error message if the license file is missing\n\nSources: [Program.cs:77-88]()\n\n## Development Environment Configuration\n\nThe application supports multiple launch profiles for different development scenarios, configured through the launch settings.\n\n### Launch Profiles\n\n| Profile | Command | URL | Purpose |\n|---------|---------|-----|---------|\n| `HtmlDocxConvertService` | Project | https://localhost:7125 | Direct project execution |\n| `IIS Express` | IISExpress | http://localhost:39065 | IIS Express hosting |\n\nBoth profiles:\n- Set `ASPNETCORE_ENVIRONMENT` to `\"Development\"`\n- Launch the browser to the Swagger UI\n- Enable .NET run messages for debugging\n\nSources: [Properties/launchSettings.json:12-29]()"])</script><script>self.__next_f.push([1,"29:T17ef,"])</script><script>self.__next_f.push([1,"# Logging System\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [Logging/SystemEventLogger.cs](Logging/SystemEventLogger.cs)\n\n\u003c/details\u003e\n\n\n\nThis document covers the Windows Event Log integration system used by the IstgHtmlDocxConvertService for centralized system event logging and monitoring. The logging system provides structured event recording for application diagnostics, error tracking, and operational monitoring.\n\nFor error handling and error codes, see [HTTP Error Codes](#6.1) and [WebSocket Error Codes](#6.2). For application configuration settings, see [Application Configuration](#7.1).\n\n## System Overview\n\nThe logging system is built around the `SystemEventLogger` class, which provides a simplified interface to the Windows Event Log. This enables enterprise-grade logging with built-in Windows system integration for monitoring and alerting.\n\n### Logging Architecture\n\n```mermaid\ngraph TB\n    subgraph \"Application Components\"\n        Controllers[\"Controllers\u003cbr/\u003e(ConversionController, EditInWordController)\"]\n        Services[\"Services\u003cbr/\u003e(ConversionService, SessionStorageService)\"]\n        WebSocketHandler[\"WebSocketHandler\"]\n        SessionCleanup[\"SessionCleanupService\"]\n    end\n    \n    subgraph \"Logging Layer\"\n        SystemEventLogger[\"SystemEventLogger\"]\n        Configuration[\"IConfiguration\u003cbr/\u003eLogging:Name\"]\n    end\n    \n    subgraph \"Windows System\"\n        EventLogAPI[\"System.Diagnostics.EventLog\"]\n        WindowsEventLog[\"Windows Event Log\u003cbr/\u003eApplication Log\"]\n        EventViewer[\"Event Viewer\"]\n    end\n    \n    Controllers --\u003e SystemEventLogger\n    Services --\u003e SystemEventLogger\n    WebSocketHandler --\u003e SystemEventLogger\n    SessionCleanup --\u003e SystemEventLogger\n    \n    Configuration --\u003e SystemEventLogger\n    SystemEventLogger --\u003e EventLogAPI\n    EventLogAPI --\u003e WindowsEventLog\n    WindowsEventLog --\u003e EventViewer\n```\n\nSources: [Logging/SystemEventLogger.cs:1-41]()\n\n## SystemEventLogger Implementation\n\nThe `SystemEventLogger` class provides three logging levels with automatic event source management:\n\n| Method | Event Type | Windows Event Level | Purpose |\n|--------|------------|-------------------|---------|\n| `Info()` | EventLogEntryType.Information | Information | Operational messages, successful operations |\n| `Warn()` | EventLogEntryType.Warning | Warning | Non-critical issues, deprecated usage |\n| `Error()` | EventLogEntryType.Error | Error | Critical errors, exceptions, failures |\n\n### Configuration Integration\n\nThe logger reads its event source name from the application configuration:\n\n```mermaid\ngraph LR\n    IConfiguration --\u003e LoggingSection[\"Logging Section\"]\n    LoggingSection --\u003e NameProperty[\"Name Property\"]\n    NameProperty --\u003e SystemEventLogger\n    SystemEventLogger --\u003e EventSourceCreation[\"Event Source Creation\u003cbr/\u003eEventLog.CreateEventSource()\"]\n    EventSourceCreation --\u003e WindowsRegistry[\"Windows Registry\u003cbr/\u003eEvent Source Registration\"]\n```\n\nThe configuration path is `Logging:Name` and is accessed via [Logging/SystemEventLogger.cs:12](). If the event source doesn't exist, it's automatically created using [Logging/SystemEventLogger.cs:15-18]().\n\nSources: [Logging/SystemEventLogger.cs:10-19]()\n\n## Event Source Management\n\nThe logger includes automatic event source lifecycle management:\n\n### Event Source Registration Process\n\n```mermaid\nsequenceDiagram\n    participant App as \"Application Startup\"\n    participant Logger as \"SystemEventLogger\"\n    participant EventLog as \"EventLog.SourceExists()\"\n    participant Registry as \"Windows Registry\"\n    \n    App-\u003e\u003eLogger: \"new SystemEventLogger(config)\"\n    Logger-\u003e\u003eEventLog: \"SourceExists(_source)\"\n    \n    alt Source Does Not Exist\n        EventLog--\u003e\u003eLogger: \"false\"\n        Logger-\u003e\u003eRegistry: \"CreateEventSource(_source, _logName)\"\n        Registry--\u003e\u003eLogger: \"Source Created\"\n    else Source Exists\n        EventLog--\u003e\u003eLogger: \"true\"\n        Logger--\u003e\u003eApp: \"Logger Ready\"\n    end\n    \n    App-\u003e\u003eLogger: \"Info/Warn/Error(message)\"\n    Logger-\u003e\u003eEventLog: \"WriteEntry(_source, message, type)\"\n```\n\nThe default log name is \"Application\" [Logging/SystemEventLogger.cs:10](), but can be customized during construction. Event source creation requires administrative privileges on first run.\n\nSources: [Logging/SystemEventLogger.cs:15-18]()\n\n## Usage Patterns\n\n### Log Level Implementation\n\nEach logging method follows the same internal pattern via the private `WriteEntry` method:\n\n```mermaid\ngraph TD\n    PublicMethods[\"Info(message)\u003cbr/\u003eWarn(message)\u003cbr/\u003eError(message)\"]\n    WriteEntry[\"WriteEntry(message, type)\"]\n    EventLogAPI[\"EventLog.WriteEntry(_source, message, type)\"]\n    \n    PublicMethods --\u003e WriteEntry\n    WriteEntry --\u003e EventLogAPI\n    \n    subgraph \"Event Types\"\n        InfoType[\"EventLogEntryType.Information\"]\n        WarnType[\"EventLogEntryType.Warning\"]\n        ErrorType[\"EventLogEntryType.Error\"]\n    end\n    \n    InfoType -.-\u003e WriteEntry\n    WarnType -.-\u003e WriteEntry\n    ErrorType -.-\u003e WriteEntry\n```\n\nThe implementation ensures consistent formatting and source attribution across all log levels through the centralized `WriteEntry` method [Logging/SystemEventLogger.cs:21-24]().\n\nSources: [Logging/SystemEventLogger.cs:21-39]()\n\n## Integration with Application Components\n\nThe logging system integrates with the broader application architecture to provide comprehensive event tracking:\n\n| Component Type | Typical Log Events | Log Level |\n|---------------|-------------------|-----------|\n| Controllers | API request validation failures | Error |\n| ConversionService | Document processing errors | Error |\n| ConversionService | Successful conversions | Info |\n| SessionStorageService | Session creation/cleanup | Info |\n| WebSocketHandler | Connection errors | Error |\n| WebSocketHandler | Message processing failures | Warn |\n| Authentication | Token validation failures | Error |\n\nThe logger is typically injected as a dependency and used throughout the application for consistent event recording to the Windows Event Log system.\n\nSources: [Logging/SystemEventLogger.cs:1-41]()"])</script><script>self.__next_f.push([1,"2a:T1bbc,"])</script><script>self.__next_f.push([1,"# Deployment and Publishing\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [IstgHtmlDocxConvertService.csproj.user](IstgHtmlDocxConvertService.csproj.user)\n- [Properties/PublishProfiles/FolderProfile.pubxml](Properties/PublishProfiles/FolderProfile.pubxml)\n- [Properties/PublishProfiles/FolderProfile.pubxml.user](Properties/PublishProfiles/FolderProfile.pubxml.user)\n\n\u003c/details\u003e\n\n\n\nThis document covers the deployment and publishing configuration for the IstgHtmlDocxConvertService. It details the Visual Studio publish profiles, file system deployment settings, and build configurations used to deploy the service to production environments.\n\nFor information about application configuration and startup, see [Application Configuration](#7.1). For logging system setup during deployment, see [Logging System](#7.2).\n\n## Publishing Configuration Overview\n\nThe service uses Visual Studio publish profiles to manage deployment configurations. The primary deployment method is file system publishing to a designated release management directory.\n\n### Publish Profile Structure\n\n```mermaid\ngraph TB\n    subgraph \"Visual Studio Project\"\n        ProjectFile[\"IstgHtmlDocxConvertService.csproj.user\"]\n        ProfilesDir[\"Properties/PublishProfiles/\"]\n    end\n    \n    subgraph \"Publish Profiles\"\n        FolderProfile[\"FolderProfile.pubxml\"]\n        FolderProfileUser[\"FolderProfile.pubxml.user\"]\n    end\n    \n    subgraph \"Target Environment\"\n        ReleaseDir[\"D:\\Release-Management\\IstgHtmlDocxConvertService\"]\n        PublishedFiles[\"Published Application Files\"]\n    end\n    \n    ProjectFile --\u003e FolderProfile\n    ProfilesDir --\u003e FolderProfile\n    ProfilesDir --\u003e FolderProfileUser\n    FolderProfile --\u003e ReleaseDir\n    FolderProfileUser --\u003e PublishedFiles\n```\n\n**Sources:** [IstgHtmlDocxConvertService.csproj.user:1-6](), [Properties/PublishProfiles/FolderProfile.pubxml:1-17](), [Properties/PublishProfiles/FolderProfile.pubxml.user:1-11]()\n\n## File System Deployment Configuration\n\nThe `FolderProfile.pubxml` defines the primary deployment configuration for file system publishing:\n\n| Configuration Property | Value | Purpose |\n|------------------------|-------|---------|\n| `PublishProvider` | FileSystem | Specifies file system deployment method |\n| `PublishUrl` | D:\\Release-Management\\IstgHtmlDocxConvertService | Target deployment directory |\n| `WebPublishMethod` | FileSystem | Publishing method for web applications |\n| `LastUsedBuildConfiguration` | Release | Build configuration for deployment |\n| `LastUsedPlatform` | Any CPU | Target platform architecture |\n| `DeleteExistingFiles` | false | Preserves existing files during deployment |\n| `ExcludeApp_Data` | false | Includes App_Data folder in deployment |\n| `LaunchSiteAfterPublish` | true | Automatically launches application after publishing |\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:6-16]()\n\n### Deployment Target Configuration\n\n```mermaid\ngraph LR\n    subgraph \"Source Environment\"\n        SourceCode[\"Source Code\"]\n        BuildArtifacts[\"Build Artifacts\"]\n        Dependencies[\"Dependencies\"]\n    end\n    \n    subgraph \"Publishing Process\"\n        MSBuild[\"MSBuild Process\"]\n        PublishProfile[\"FolderProfile.pubxml\"]\n        FileSystemProvider[\"FileSystem Provider\"]\n    end\n    \n    subgraph \"Target Directory\"\n        TargetPath[\"D:\\Release-Management\\IstgHtmlDocxConvertService\"]\n        AppFiles[\"Application Files\"]\n        ConfigFiles[\"Configuration Files\"]\n        BinFiles[\"Binary Files\"]\n    end\n    \n    SourceCode --\u003e MSBuild\n    BuildArtifacts --\u003e MSBuild\n    Dependencies --\u003e MSBuild\n    MSBuild --\u003e PublishProfile\n    PublishProfile --\u003e FileSystemProvider\n    FileSystemProvider --\u003e TargetPath\n    TargetPath --\u003e AppFiles\n    TargetPath --\u003e ConfigFiles\n    TargetPath --\u003e BinFiles\n```\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:12-14]()\n\n## Build Configuration\n\nThe deployment process uses the Release build configuration optimized for production environments:\n\n### Build Settings\n\n- **Configuration**: Release mode for optimized performance\n- **Platform**: Any CPU for cross-platform compatibility  \n- **Target Framework**: .NET Core/5+ web application\n- **Output**: Self-contained deployment to target directory\n\n### Publishing Workflow\n\n```mermaid\nsequenceDiagram\n    participant Dev as \"Developer\"\n    participant VS as \"Visual Studio\"\n    participant Profile as \"FolderProfile.pubxml\"\n    participant FileSystem as \"File System\"\n    participant Target as \"Target Directory\"\n    \n    Dev-\u003e\u003eVS: \"Initiate Publish\"\n    VS-\u003e\u003eProfile: \"Load Publish Configuration\"\n    Profile-\u003e\u003eVS: \"Return Deployment Settings\"\n    VS-\u003e\u003eFileSystem: \"Build in Release Mode\"\n    FileSystem-\u003e\u003eVS: \"Build Artifacts Ready\"\n    VS-\u003e\u003eTarget: \"Deploy to D:\\Release-Management\\IstgHtmlDocxConvertService\"\n    Target-\u003e\u003eVS: \"Deployment Complete\"\n    VS-\u003e\u003eDev: \"Launch Application (LaunchSiteAfterPublish=true)\"\n```\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:9-11](), [IstgHtmlDocxConvertService.csproj.user:4]()\n\n## Deployment History and Monitoring\n\nThe `FolderProfile.pubxml.user` file maintains a comprehensive deployment history with timestamps and success/failure status:\n\n### Recent Deployment Activity\n\nThe deployment history shows frequent publishing activity with timestamps indicating active development and deployment cycles. Each entry in the history contains:\n\n- **Timestamp**: Deployment execution time\n- **Status**: Success (True) or Failure (False) indicator\n- **Target URL**: Confirmation of deployment destination\n\n### Deployment Frequency Analysis\n\nBased on the deployment history, the service shows:\n- Multiple daily deployments during active development periods\n- Successful deployment rate with occasional failures requiring retry\n- Consistent target directory usage for reliable deployment paths\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml.user:8]()\n\n## Deployment Prerequisites\n\nBefore deploying the IstgHtmlDocxConvertService, ensure:\n\n1. **Target Directory**: `D:\\Release-Management\\IstgHtmlDocxConvertService` exists and has write permissions\n2. **Build Configuration**: Release mode is selected for optimized performance\n3. **Dependencies**: All required .NET runtime components are available on target system\n4. **Service Dependencies**: Database connectivity and Windows Event Log access configured\n5. **File System Permissions**: Appropriate permissions for temporary file creation and session storage\n\n## Post-Deployment Verification\n\nAfter successful deployment:\n\n1. **Application Launch**: Service automatically launches if `LaunchSiteAfterPublish` is enabled\n2. **Configuration Validation**: Verify connection strings and authentication settings\n3. **Service Registration**: Ensure Windows service registration if applicable\n4. **Log Verification**: Check Windows Event Log for startup messages\n5. **Endpoint Testing**: Validate HTTP and WebSocket endpoints are responding\n\n**Sources:** [Properties/PublishProfiles/FolderProfile.pubxml:9]()"])</script><script>self.__next_f.push([1,"2b:T1f57,"])</script><script>self.__next_f.push([1,"# Development Setup\n\n\u003cdetails\u003e\n\u003csummary\u003eRelevant source files\u003c/summary\u003e\n\nThe following files were used as context for generating this wiki page:\n\n- [.gitignore](.gitignore)\n- [IstgHtmlDocxConvertService.csproj](IstgHtmlDocxConvertService.csproj)\n- [Properties/launchSettings.json](Properties/launchSettings.json)\n\n\u003c/details\u003e\n\n\n\nThis document provides developers with the information needed to set up the IstgHtmlDocxConvertService development environment, understand the project structure, and configure the build system. It covers project dependencies, development tools, and local development workflow.\n\nFor information about deployment and production configuration, see [Deployment and Publishing](#7.3). For application-level configuration settings, see [Application Configuration](#7.1).\n\n## Prerequisites and Requirements\n\nThe development environment requires the following components:\n\n| Component | Version | Purpose |\n|-----------|---------|---------|\n| .NET SDK | 6.0+ | Target framework runtime |\n| Visual Studio | 2022+ | IDE with project support |\n| Microsoft Word | 2016+ | Testing Word integration features |\n| SQL Server | Any version | Database authentication testing |\n\n### Development Environment Setup\n\nThe project uses .NET 6.0 as specified in [IstgHtmlDocxConvertService.csproj:11]() with nullable reference types and implicit usings enabled [IstgHtmlDocxConvertService.csproj:12-13]().\n\n**Development Environment Diagram**\n```mermaid\ngraph TB\n    subgraph \"Development Machine\"\n        VisualStudio[\"Visual Studio 2022\"]\n        DotNet6[\"\".NET 6.0 SDK\"\"]\n        MsWord[\"Microsoft Word\"]\n    end\n    \n    subgraph \"External Dependencies\"\n        SqlServer[\"SQL Server Database\"]\n        AsposeLib[\"Aspose.Words Library\"]\n        OfficeAutomation[\"IstgOfficeAutomationBrl Project\"]\n    end\n    \n    subgraph \"Development Workflow\"\n        LocalBuild[\"Local Build Process\"]\n        SwaggerUI[\"Swagger UI Testing\"]\n        DebugSession[\"Debug Session\"]\n    end\n    \n    VisualStudio --\u003e DotNet6\n    VisualStudio --\u003e LocalBuild\n    LocalBuild --\u003e SwaggerUI\n    LocalBuild --\u003e DebugSession\n    \n    DotNet6 --\u003e AsposeLib\n    DotNet6 --\u003e OfficeAutomation\n    DebugSession --\u003e MsWord\n    DebugSession --\u003e SqlServer\n```\n\nSources: [IstgHtmlDocxConvertService.csproj](), [Properties/launchSettings.json]()\n\n## Project Structure and Dependencies\n\n### Core Project Configuration\n\nThe main project file defines the service structure and dependencies. The project targets .NET 6.0 with modern C# features enabled.\n\n**Project Dependencies Diagram**\n```mermaid\ngraph TB\n    subgraph \"Main Project\"\n        MainProj[\"IstgHtmlDocxConvertService.csproj\"]\n    end\n    \n    subgraph \"NuGet Packages\"\n        SkiaSharp[\"SkiaSharp v3.116.1\"]\n        Swashbuckle[\"Swashbuckle.AspNetCore v6.5.0\"]\n        SwaggerAnnotations[\"Swashbuckle.AspNetCore.Annotations v8.1.1\"]\n        SqlClient[\"System.Data.SqlClient v4.9.0\"]\n        TextEncoding[\"System.Text.Encoding.CodePages v9.0.4\"]\n    end\n    \n    subgraph \"Project References\"\n        OfficeAutomation[\"IstgOfficeAutomationBrl.vbproj\"]\n    end\n    \n    subgraph \"Local Libraries\"\n        AsposeWords[\"Aspose.Words.dll\"]\n        LibFiles[\"lib/** files\"]\n    end\n    \n    MainProj --\u003e SkiaSharp\n    MainProj --\u003e Swashbuckle\n    MainProj --\u003e SwaggerAnnotations\n    MainProj --\u003e SqlClient\n    MainProj --\u003e TextEncoding\n    MainProj --\u003e OfficeAutomation\n    MainProj --\u003e AsposeWords\n    MainProj --\u003e LibFiles\n```\n\nSources: [IstgHtmlDocxConvertService.csproj:16-32]()\n\n### Key Dependencies\n\n| Dependency | Version | Purpose |\n|------------|---------|---------|\n| `SkiaSharp` | 3.116.1 | Graphics rendering for document processing |\n| `Swashbuckle.AspNetCore` | 6.5.0 | API documentation and testing interface |\n| `System.Data.SqlClient` | 4.9.0 | Database connectivity for authentication |\n| `System.Text.Encoding.CodePages` | 9.0.4 | Text encoding support for document conversion |\n| `Aspose.Words` | Local DLL | Core document conversion engine |\n| `IstgOfficeAutomationBrl` | Project Reference | Office automation business logic |\n\n## Development Environment Configuration\n\n### Launch Profiles\n\nThe development environment supports two launch configurations defined in [Properties/launchSettings.json]():\n\n**Launch Configuration Diagram**\n```mermaid\ngraph LR\n    subgraph \"Launch Profiles\"\n        ProjectProfile[\"HtmlDocxConvertService Profile\"]\n        IISProfile[\"IIS Express Profile\"]\n    end\n    \n    subgraph \"Development URLs\"\n        HttpsLocal[\"https://localhost:7125\"]\n        HttpLocal[\"http://localhost:5151\"]\n        IISUrl[\"http://localhost:39065\"]\n        IISSSLUrl[\"https://localhost:44374\"]\n    end\n    \n    subgraph \"Development Features\"\n        SwaggerUI[\"Swagger UI Auto-Launch\"]\n        HotReload[\"Hot Reload Support\"]\n        DevEnvironment[\"Development Environment Variables\"]\n    end\n    \n    ProjectProfile --\u003e HttpsLocal\n    ProjectProfile --\u003e HttpLocal\n    ProjectProfile --\u003e SwaggerUI\n    ProjectProfile --\u003e HotReload\n    \n    IISProfile --\u003e IISUrl\n    IISProfile --\u003e IISSSLUrl\n    IISProfile --\u003e SwaggerUI\n    \n    ProjectProfile --\u003e DevEnvironment\n    IISProfile --\u003e DevEnvironment\n```\n\nSources: [Properties/launchSettings.json:12-30]()\n\n### Development Server Configuration\n\nThe default development profile `HtmlDocxConvertService` runs on:\n- HTTPS: `https://localhost:7125`\n- HTTP: `http://localhost:5151`\n- Auto-launches Swagger UI at `/swagger`\n- Sets `ASPNETCORE_ENVIRONMENT=Development`\n\n## Building and Running\n\n### Local Development Build\n\nThe project includes specific build configurations for development:\n\n1. **Library Management**: The `lib` folder contains the Aspose.Words DLL and related files that are copied to the output directory [IstgHtmlDocxConvertService.csproj:34-38]().\n\n2. **Source Control Integration**: The project includes Team Foundation Server source control bindings [IstgHtmlDocxConvertService.csproj:3-8]().\n\n3. **Build Exclusions**: Standard .NET build artifacts are excluded via [.gitignore:10-54]().\n\n### Development Workflow\n\n**Development Build Process Diagram**\n```mermaid\ngraph TD\n    subgraph \"Source Control\"\n        GitRepo[\"Git Repository\"]\n        TFSBindings[\"TFS Source Control Bindings\"]\n    end\n    \n    subgraph \"Build Process\"\n        DotNetBuild[\"dotnet build\"]\n        NuGetRestore[\"NuGet Package Restore\"]\n        LibCopy[\"Copy lib/** to Output\"]\n        ProjectReference[\"Build IstgOfficeAutomationBrl\"]\n    end\n    \n    subgraph \"Output Directory\"\n        MainAssembly[\"IstgHtmlDocxConvertService.dll\"]\n        AsposeLib[\"Aspose.Words.dll\"]\n        Dependencies[\"NuGet Dependencies\"]\n        OfficeAutomationDll[\"IstgOfficeAutomationBrl.dll\"]\n    end\n    \n    subgraph \"Development Testing\"\n        SwaggerUI[\"Swagger UI Testing\"]\n        WebSocketTesting[\"WebSocket Connection Testing\"]\n        WordIntegration[\"Word Integration Testing\"]\n    end\n    \n    GitRepo --\u003e DotNetBuild\n    TFSBindings --\u003e DotNetBuild\n    DotNetBuild --\u003e NuGetRestore\n    DotNetBuild --\u003e LibCopy\n    DotNetBuild --\u003e ProjectReference\n    \n    NuGetRestore --\u003e Dependencies\n    LibCopy --\u003e AsposeLib\n    ProjectReference --\u003e OfficeAutomationDll\n    DotNetBuild --\u003e MainAssembly\n    \n    MainAssembly --\u003e SwaggerUI\n    MainAssembly --\u003e WebSocketTesting\n    MainAssembly --\u003e WordIntegration\n```\n\nSources: [IstgHtmlDocxConvertService.csproj](), [.gitignore](), [Properties/launchSettings.json]()\n\n### Build Commands\n\n| Command | Purpose |\n|---------|---------|\n| `dotnet restore` | Restore NuGet packages and project references |\n| `dotnet build` | Compile the project and dependencies |\n| `dotnet run` | Build and start the development server |\n| `dotnet run --launch-profile \"IIS Express\"` | Run using IIS Express profile |\n\n### Development Environment Variables\n\nThe development configuration sets:\n- `ASPNETCORE_ENVIRONMENT=Development` - Enables development features\n- Development-specific logging and error handling\n- Swagger UI auto-generation and launch\n\nSources: [Properties/launchSettings.json:18-19,27-28]()"])</script><script>self.__next_f.push([1,"16:[\"$\",\"$L17\",null,{\"repoName\":\"markdownpro2/IstgHtmlDocxConvertService\",\"wiki\":{\"metadata\":{\"repo_name\":\"markdownpro2/IstgHtmlDocxConvertService\",\"commit_hash\":\"c4d5f8ff\",\"generated_at\":\"2025-05-27T13:21:18.973597\"},\"pages\":[{\"page_plan\":{\"id\":\"1\",\"title\":\"Overview\"},\"content\":\"$18\"},{\"page_plan\":{\"id\":\"2\",\"title\":\"System Architecture\"},\"content\":\"$19\"},{\"page_plan\":{\"id\":\"3\",\"title\":\"HTTP API Reference\"},\"content\":\"$1a\"},{\"page_plan\":{\"id\":\"3.1\",\"title\":\"Document Conversion API\"},\"content\":\"$1b\"},{\"page_plan\":{\"id\":\"3.2\",\"title\":\"Word Integration API\"},\"content\":\"$1c\"},{\"page_plan\":{\"id\":\"4\",\"title\":\"Core Services\"},\"content\":\"$1d\"},{\"page_plan\":{\"id\":\"4.1\",\"title\":\"Document Conversion Services\"},\"content\":\"$1e\"},{\"page_plan\":{\"id\":\"4.2\",\"title\":\"Session Management\"},\"content\":\"$1f\"},{\"page_plan\":{\"id\":\"4.3\",\"title\":\"Authentication Service\"},\"content\":\"$20\"},{\"page_plan\":{\"id\":\"5\",\"title\":\"Real-time Communication\"},\"content\":\"$21\"},{\"page_plan\":{\"id\":\"5.1\",\"title\":\"WebSocket Handler\"},\"content\":\"$22\"},{\"page_plan\":{\"id\":\"5.2\",\"title\":\"WebSocket Protocol\"},\"content\":\"$23\"},{\"page_plan\":{\"id\":\"6\",\"title\":\"Error Handling\"},\"content\":\"$24\"},{\"page_plan\":{\"id\":\"6.1\",\"title\":\"HTTP Error Codes\"},\"content\":\"$25\"},{\"page_plan\":{\"id\":\"6.2\",\"title\":\"WebSocket Error Codes\"},\"content\":\"$26\"},{\"page_plan\":{\"id\":\"7\",\"title\":\"Configuration and Deployment\"},\"content\":\"$27\"},{\"page_plan\":{\"id\":\"7.1\",\"title\":\"Application Configuration\"},\"content\":\"$28\"},{\"page_plan\":{\"id\":\"7.2\",\"title\":\"Logging System\"},\"content\":\"$29\"},{\"page_plan\":{\"id\":\"7.3\",\"title\":\"Deployment and Publishing\"},\"content\":\"$2a\"},{\"page_plan\":{\"id\":\"8\",\"title\":\"Development Setup\"},\"content\":\"$2b\"}]},\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]\n"])</script><script>self.__next_f.push([1,"c:null\n10:[[\"$\",\"title\",\"0\",{\"children\":\"markdownpro2/IstgHtmlDocxConvertService | DeepWiki\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th\"}],[\"$\",\"meta\",\"2\",{\"property\":\"og:title\",\"content\":\"markdownpro2/IstgHtmlDocxConvertService | DeepWiki\"}],[\"$\",\"meta\",\"3\",{\"property\":\"og:description\",\"content\":\"IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th\"}],[\"$\",\"meta\",\"4\",{\"property\":\"og:url\",\"content\":\"https://deepwiki.com/markdownpro2/IstgHtmlDocxConvertService\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:site_name\",\"content\":\"DeepWiki\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"markdownpro2/IstgHtmlDocxConvertService | DeepWiki\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"IstgHtmlDocxConvertService is a .NET 6.0 web service that provides bidirectional document conversion between HTML and Microsoft Word DOCX formats, with real-time collaborative editing capabilities. Th\"}],[\"$\",\"link\",\"10\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}],[\"$\",\"link\",\"11\",{\"rel\":\"icon\",\"href\":\"/icon.png?66aaf51e0e68c818\",\"type\":\"image/png\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"12\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?a4f658907db0ab87\",\"type\":\"image/png\",\"sizes\":\"180x180\"}]]\n"])</script></body></html>